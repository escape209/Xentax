<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>quickbms XOR and offset issue - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=10157">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="../../Source/assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="../../Source/styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="../../Source/ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="../Navigation/index.html" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="../Navigation/index.html" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="../Source/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="../Users/123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=f03065a94e53d4183cf1d6f8f99502e7" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="../Navigation/index.html" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="13"><a itemprop="item" href="./viewforum.php?f=13"><span itemprop="name">Code Talk</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./10157.html">quickbms XOR and offset issue</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Coders and would-be coders alike, this is the place to talk about programming.<br /></div>


<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=10157" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=13&amp;t=10157&amp;watch=topic&amp;start=0&amp;hash=2774cf16" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=13&amp;t=10157&amp;unwatch=topic&amp;start=0&amp;hash=2774cf16" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=10157&amp;bookmark=1&amp;hash=2774cf16" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=10157" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=10157&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="10157" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			7 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p83182" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile83182">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/34492.html" class="username">finale00</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=34492&amp;sr=posts">2382</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 09, 2011 1:22 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="34492"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/true">170 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="34492"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/false">307 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact finale00">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact finale00</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=83182" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83182">

					<h3 class="first">
						<a href="./viewtopic.php?p=83182#p83182">quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83182/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83182" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83182' href="./viewtopic.php?f=13&amp;p=83182&amp;thanks=83182&amp;to_id=34492&amp;from_id=123876" title="Say Thanks to the author of the post: finale00"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83182#p83182" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/34492.html" class="username">finale00</a></strong> &raquo; </span><time datetime="2013-02-21T16:34:45+00:00">Thu Feb 21, 2013 5:34 pm</time>
			</p>
			
			
			
			<div class="content">The archive I am looking at starts by storing its key in the first 16 bytes of the file.<br>
It then gives you some info about the file table, and then the file entries themselves.<br>
<br>
The file entries are encrypted using the 16-byte key that was read at the top.<br>
Here is my script<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>getdstring key 16
get FILES long
get entrySize long
get nameLen long
print "%key|16h%"
print %FILES%

for i = 0 &lt; 1
    filexor key 
    get OFFSET long
    get SIZE long
    get null long
    get null long
    getdstring NAME 32
    print %NAME%
next i
</code></pre></div>

But it's not xor'ing properly (or...at all)<br>
What am I missing? I think I should have some sort of offset for the filexor command, but I've tried several offsets (like, where the entries begin) but no luck.<br>
<br>
Here's the relevant header containing only one entry.</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=6211">header.zip</a></dt>
						<dd>(230 Bytes) Downloaded 12 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks83182'>
</div>
<div id='div_post_reput83182'>
</div>

							<div id="sig83182" class="signature"><a href="http://wiki.xentax.com/index.php/Model_Import_Plugins" class="postlink">Model Import Plugins/Scripts</a><br>
<br>
<a href="http://www.himeworks.com/noesis-plugins/" class="postlink">Noesis Plugins</a> | <a href="https://www.dropbox.com/s/ekavgz89jgaikzw" class="postlink">Reference files</a><br>
<br>
Reference<br>
<a href="http://wiki.xentax.com/index.php/3D_Model_Guide" class="postlink">Guide to 3D model reversal</a> | <a href="http://wiki.xentax.com/index.php/3D_Model_Glossary" class="postlink">3D glossary</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p83289" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile83289">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/23853.html" class="username">Ekey</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=23853&amp;sr=posts">1823</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 31, 2010 6:54 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="23853"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/true">92 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="23853"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/false">1058 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ekey">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ekey</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=83289" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83289">

					<h3 >
						<a href="./viewtopic.php?p=83289#p83289">Re: quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83289/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83289" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83289' href="./viewtopic.php?f=13&amp;p=83289&amp;thanks=83289&amp;to_id=23853&amp;from_id=123876" title="Say Thanks to the author of the post: Ekey"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83289#p83289" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/23853.html" class="username">Ekey</a></strong> &raquo; </span><time datetime="2013-02-25T15:33:33+00:00">Mon Feb 25, 2013 4:33 pm</time>
			</p>
			
			
			
			<div class="content">Would you give name of game.</div>

			
			
									
						<div id='list_thanks83289'>
</div>
<div id='div_post_reput83289'>
</div>

							<div id="sig83289" class="signature">My <a href="https://github.com/Ekey" class="postlink">Github repo</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p83359" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile83359">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/889.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=889_1454619021.png" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/889.html" class="username">aluigi</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=889&amp;sr=posts">1916</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 08, 2005 12:26 pm</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> <!-- w --><a class="postlink" href="http://www.ZENHAX.com">www.ZENHAX.com</a><!-- w --></dd>
							    <dd class="profile-posts" data-user-give-id="889"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/889/true">4 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="889"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/889/false">664 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact aluigi">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact aluigi</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://zenhax.com" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83359">

					<h3 >
						<a href="./viewtopic.php?p=83359#p83359">Re: quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83359/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83359" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83359' href="./viewtopic.php?f=13&amp;p=83359&amp;thanks=83359&amp;to_id=889&amp;from_id=123876" title="Say Thanks to the author of the post: aluigi"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83359#p83359" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/889.html" class="username">aluigi</a></strong> &raquo; </span><time datetime="2013-02-26T22:07:41+00:00">Tue Feb 26, 2013 11:07 pm</time>
			</p>
			
			
			
			<div class="content">because filexor wants the key as a sequence of numbers ("0x01 0x02 0x03").<br>
<br>
I suggest you to build the key byte-per-byte:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>set KEY string ""
for i = 0 &lt; 16
    get B byte
    string B p= " 0x%02x" B
    string KEY += B
next i
...
filexor KEY 0</code></pre></div>the 0 after KEY means that the offset is 0 and not the current one</div>

			
			
									
						<div id='list_thanks83359'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/889.html" class="username">aluigi</a> for the post: </dt>
			<dd><span title="Thu Feb 28, 2013 2:13 pm"><a href="../Users/34492.html" class="username">finale00</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput83359'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p83435" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile83435">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/34492.html" class="username">finale00</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=34492&amp;sr=posts">2382</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 09, 2011 1:22 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="34492"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/true">170 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="34492"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/false">307 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact finale00">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact finale00</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=83435" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83435">

					<h3 >
						<a href="./viewtopic.php?p=83435#p83435">Re: quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83435/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83435" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83435' href="./viewtopic.php?f=13&amp;p=83435&amp;thanks=83435&amp;to_id=34492&amp;from_id=123876" title="Say Thanks to the author of the post: finale00"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83435#p83435" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/34492.html" class="username">finale00</a></strong> &raquo; </span><time datetime="2013-03-01T17:21:48+00:00">Fri Mar 01, 2013 6:21 pm</time>
			</p>
			
			
			
			<div class="content">Having another issue with filexor and offset with a different game.<br>
Here is the script:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># Touhou Gensoukyo Rensa

string KEY = "\x45\xE9\xE2\x15\xD2\x39\xB1\xB9\x18\x5F\xE4\xFA\xF9\xEF\x00\xC0\xC8\x64\xD0\xDF\x31\x0B\xF6\x8B\x60\x4D\x98\x64\x40\x5A\x24\x4B\x80\x5E\x40\xC0\xA2\x62\x04\x54\x52\xED\x34\x9D\x3E\xBE\x8D\xCD\x0D\x71\x7E\x71\x22\xC5\x18\x24\x48\x87\x29\xBE\x79\xD0\x80\x56\x7E\x14\xFB\x4B\xC8\x50\x00\xAC\xC8\x95\xEC\xF1\xDD\xE4\x9A\x2B\xC6\x1D\xCB\x34\xCD\x58\xE7\x83\x58\x1A\xE7\x2C\x0C\x4D\xA0\xB4\x80\x6D\x20\x06\x67\x89\xC0\xD3\x36\x40\xAF\x31\xDA\x4D\xF4\x62\x46\xA4\xE0\x74\x08\xF6\x3C\xD5\x92\x8D\x27\xFE\x50\xE9\xA4\xFE\xA0\xD6\x2F\x69\x98\xAD\x15\x10\x3C\x24\x2F\x12\x15\x76\xD6\x03\x9F\xAF\x0D\xA3\x64\xD8\x95\x65\xDA\x48\xC7\xE4\x6F\x36\x5D\xA7\x7A\x5A\x8B\x69\xE0\x43\x2C\x95\x47\x5A\x10\x3A\x0A\xB1\x9D\x94\xFB\x1D\xD8\xD3\x31\x71\xE9\x05\x56\x1A\x6F\xB6\x8D\x9A\xED\x86\xB6\x29\x02\xCD\x90\x3E\xDA\x2C\x9A\x7B\x23\x78\x83\x43\xB6\xAD\xC3\x36\xBB\x6C\x69\xF1\xE2\x60\xEF\xA7\x48\xFB\x92\x09\x7B\x20\x76\x3B\xA9\x83\xC3\x0D\x6D\x89\xBC\x27\x55\xA9\xBC\xB1\xAB\x90\x07\xF4\x52\xF8\x88\xB4\xF1\x1A\x74\x7B\x12\xCB\xBA\xDE\xA4\x1F"

idstring "CONTFILE"
get unk short
get FILES long
filexor KEY 14
for i = 0 &lt; FILES
  
  getdstring NAME 16
  get SIZE long
  get OFFSET long
  
  putarray 0 i NAME
  putarray 1 i SIZE
  putarray 2 i OFFSET
next i

for i = 0 &lt; 1
  getarray NAME 0 i
  getarray SIZE 1 i
  getarray OFFSET 2 i
 
  print "%NAME%, %OFFSET%, %SIZE%"
  filexor KEY OFFSET
  log NAME OFFSET SIZE
next i
</code></pre></div>

The file table is read correctly, but the files are not being xor'd properly.<br>
When I manualy copied bytes from the archive out using the size and offset, I ran the xor tool and they all were decrypted correctly, so I would conclude that the key restarts for each file.<br>
<br>
Here is a sample: <a href="http://www.mediafire.com/?c6dwiksgwl2x2yi" class="postlink">http://www.mediafire.com/?c6dwiksgwl2x2yi</a></div>

			
			
									
						<div id='list_thanks83435'>
</div>
<div id='div_post_reput83435'>
</div>

							<div id="sig83435" class="signature"><a href="http://wiki.xentax.com/index.php/Model_Import_Plugins" class="postlink">Model Import Plugins/Scripts</a><br>
<br>
<a href="http://www.himeworks.com/noesis-plugins/" class="postlink">Noesis Plugins</a> | <a href="https://www.dropbox.com/s/ekavgz89jgaikzw" class="postlink">Reference files</a><br>
<br>
Reference<br>
<a href="http://wiki.xentax.com/index.php/3D_Model_Guide" class="postlink">Guide to 3D model reversal</a> | <a href="http://wiki.xentax.com/index.php/3D_Model_Glossary" class="postlink">3D glossary</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p83451" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile83451">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/889.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=889_1454619021.png" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/889.html" class="username">aluigi</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=889&amp;sr=posts">1916</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 08, 2005 12:26 pm</dd>		
		
																<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> <!-- w --><a class="postlink" href="http://www.ZENHAX.com">www.ZENHAX.com</a><!-- w --></dd>
							    <dd class="profile-posts" data-user-give-id="889"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/889/true">4 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="889"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/889/false">664 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact aluigi">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact aluigi</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="http://zenhax.com" title="Website" class="last-cell">
										<span class="contact-icon phpbb_website-icon">Website</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83451">

					<h3 >
						<a href="./viewtopic.php?p=83451#p83451">Re: quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83451/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83451" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83451' href="./viewtopic.php?f=13&amp;p=83451&amp;thanks=83451&amp;to_id=889&amp;from_id=123876" title="Say Thanks to the author of the post: aluigi"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83451#p83451" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/889.html" class="username">aluigi</a></strong> &raquo; </span><time datetime="2013-03-02T09:14:26+00:00">Sat Mar 02, 2013 10:14 am</time>
			</p>
			
			
			
			<div class="content">if you use " 0x" instead of "\x" it works.<br>
<br>
at the moment I don't know why with \x it works the first time but doesn't work for all the other files :) maybe I will investigate<br>
<br>
EDIT: I found the reason, fixing</div>

			
			
									
						<div id='list_thanks83451'>
</div>
<div id='div_post_reput83451'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p83461" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile83461">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/23853.html" class="username">Ekey</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=23853&amp;sr=posts">1823</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 31, 2010 6:54 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="23853"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/true">92 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="23853"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/false">1058 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ekey">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ekey</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=83461" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83461">

					<h3 >
						<a href="./viewtopic.php?p=83461#p83461">Re: quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83461/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83461" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83461' href="./viewtopic.php?f=13&amp;p=83461&amp;thanks=83461&amp;to_id=23853&amp;from_id=123876" title="Say Thanks to the author of the post: Ekey"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83461#p83461" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/23853.html" class="username">Ekey</a></strong> &raquo; </span><time datetime="2013-03-02T18:31:47+00:00">Sat Mar 02, 2013 7:31 pm</time>
			</p>
			
			
			
			<div class="content"><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># Touhou Gensoukyo Rensa

set KEYNEW "0x45 0xE9 0xE2 0x15 0xD2 0x39 0xB1 0xB9 0x18 0x5F 0xE4 0xFA 0xF9 0xEF 0x00 0xC0 0xC8 0x64 0xD0 0xDF 0x31 0x0B 0xF6 0x8B 0x60 0x4D 0x98 0x64 0x40 0x5A 0x24 0x4B 0x80 0x5E 0x40 0xC0 0xA2 0x62 0x04 0x54 0x52 0xED 0x34 0x9D 0x3E 0xBE 0x8D 0xCD 0x0D 0x71 0x7E 0x71 0x22 0xC5 0x18 0x24 0x48 0x87 0x29 0xBE 0x79 0xD0 0x80 0x56 0x7E 0x14 0xFB 0x4B 0xC8 0x50 0x00 0xAC 0xC8 0x95 0xEC 0xF1 0xDD 0xE4 0x9A 0x2B 0xC6 0x1D 0xCB 0x34 0xCD 0x58 0xE7 0x83 0x58 0x1A 0xE7 0x2C 0x0C 0x4D 0xA0 0xB4 0x80 0x6D 0x20 0x06 0x67 0x89 0xC0 0xD3 0x36 0x40 0xAF 0x31 0xDA 0x4D 0xF4 0x62 0x46 0xA4 0xE0 0x74 0x08 0xF6 0x3C 0xD5 0x92 0x8D 0x27 0xFE 0x50 0xE9 0xA4 0xFE 0xA0 0xD6 0x2F 0x69 0x98 0xAD 0x15 0x10 0x3C 0x24 0x2F 0x12 0x15 0x76 0xD6 0x03 0x9F 0xAF 0x0D 0xA3 0x64 0xD8 0x95 0x65 0xDA 0x48 0xC7 0xE4 0x6F 0x36 0x5D 0xA7 0x7A 0x5A 0x8B 0x69 0xE0 0x43 0x2C 0x95 0x47 0x5A 0x10 0x3A 0x0A 0xB1 0x9D 0x94 0xFB 0x1D 0xD8 0xD3 0x31 0x71 0xE9 0x05 0x56 0x1A 0x6F 0xB6 0x8D 0x9A 0xED 0x86 0xB6 0x29 0x02 0xCD 0x90 0x3E 0xDA 0x2C 0x9A 0x7B 0x23 0x78 0x83 0x43 0xB6 0xAD 0xC3 0x36 0xBB 0x6C 0x69 0xF1 0xE2 0x60 0xEF 0xA7 0x48 0xFB 0x92 0x09 0x7B 0x20 0x76 0x3B 0xA9 0x83 0xC3 0x0D 0x6D 0x89 0xBC 0x27 0x55 0xA9 0xBC 0xB1 0xAB 0x90 0x07 0xF4 0x52 0xF8 0x88 0xB4 0xF1 0x1A 0x74 0x7B 0x12 0xCB 0xBA 0xDE 0xA4 0x1F"

idstring "CONTFILE"
get UNKNOWN short
get FILES long

for i = 0 &lt; FILES
  filexor KEYNEW
  getdstring NAME 16
  get SIZE long
  get OFFSET long
  log NAME OFFSET SIZE
next i</code></pre></div>

Edited: aluigi outstripped me <img class="smilies" src="./images/smilies/%5Bcolon%5D%29.gif" width="15" height="15" alt=":)" title="Smile"></div>

			
			
									
						<div id='list_thanks83461'>
</div>
<div id='div_post_reput83461'>
</div>

							<div id="sig83461" class="signature">My <a href="https://github.com/Ekey" class="postlink">Github repo</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p83501" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile83501">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/34492.html" class="username">finale00</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=34492&amp;sr=posts">2382</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 09, 2011 1:22 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="34492"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/true">170 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="34492"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/false">307 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact finale00">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact finale00</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=83501" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content83501">

					<h3 >
						<a href="./viewtopic.php?p=83501#p83501">Re: quickbms XOR and offset issue</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/83501/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=83501" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post83501' href="./viewtopic.php?f=13&amp;p=83501&amp;thanks=83501&amp;to_id=34492&amp;from_id=123876" title="Say Thanks to the author of the post: finale00"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=83501#p83501" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/34492.html" class="username">finale00</a></strong> &raquo; </span><time datetime="2013-03-04T03:22:49+00:00">Mon Mar 04, 2013 4:22 am</time>
			</p>
			
			
			
			<div class="content">This one decrypts the files as required<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># Touhou Gensoukyo Rensa

set KEYNEW "0x45 0xE9 0xE2 0x15 0xD2 0x39 0xB1 0xB9 0x18 0x5F 0xE4 0xFA 0xF9 0xEF 0x00 0xC0 0xC8 0x64 0xD0 0xDF 0x31 0x0B 0xF6 0x8B 0x60 0x4D 0x98 0x64 0x40 0x5A 0x24 0x4B 0x80 0x5E 0x40 0xC0 0xA2 0x62 0x04 0x54 0x52 0xED 0x34 0x9D 0x3E 0xBE 0x8D 0xCD 0x0D 0x71 0x7E 0x71 0x22 0xC5 0x18 0x24 0x48 0x87 0x29 0xBE 0x79 0xD0 0x80 0x56 0x7E 0x14 0xFB 0x4B 0xC8 0x50 0x00 0xAC 0xC8 0x95 0xEC 0xF1 0xDD 0xE4 0x9A 0x2B 0xC6 0x1D 0xCB 0x34 0xCD 0x58 0xE7 0x83 0x58 0x1A 0xE7 0x2C 0x0C 0x4D 0xA0 0xB4 0x80 0x6D 0x20 0x06 0x67 0x89 0xC0 0xD3 0x36 0x40 0xAF 0x31 0xDA 0x4D 0xF4 0x62 0x46 0xA4 0xE0 0x74 0x08 0xF6 0x3C 0xD5 0x92 0x8D 0x27 0xFE 0x50 0xE9 0xA4 0xFE 0xA0 0xD6 0x2F 0x69 0x98 0xAD 0x15 0x10 0x3C 0x24 0x2F 0x12 0x15 0x76 0xD6 0x03 0x9F 0xAF 0x0D 0xA3 0x64 0xD8 0x95 0x65 0xDA 0x48 0xC7 0xE4 0x6F 0x36 0x5D 0xA7 0x7A 0x5A 0x8B 0x69 0xE0 0x43 0x2C 0x95 0x47 0x5A 0x10 0x3A 0x0A 0xB1 0x9D 0x94 0xFB 0x1D 0xD8 0xD3 0x31 0x71 0xE9 0x05 0x56 0x1A 0x6F 0xB6 0x8D 0x9A 0xED 0x86 0xB6 0x29 0x02 0xCD 0x90 0x3E 0xDA 0x2C 0x9A 0x7B 0x23 0x78 0x83 0x43 0xB6 0xAD 0xC3 0x36 0xBB 0x6C 0x69 0xF1 0xE2 0x60 0xEF 0xA7 0x48 0xFB 0x92 0x09 0x7B 0x20 0x76 0x3B 0xA9 0x83 0xC3 0x0D 0x6D 0x89 0xBC 0x27 0x55 0xA9 0xBC 0xB1 0xAB 0x90 0x07 0xF4 0x52 0xF8 0x88 0xB4 0xF1 0x1A 0x74 0x7B 0x12 0xCB 0xBA 0xDE 0xA4 0x1F"

idstring "CONTFILE"
get UNKNOWN short
get FILES long

for i = 0 &lt; FILES
  filexor KEYNEW 14
  getdstring NAME 16
  get SIZE long
  get OFFSET long
  filexor KEYNEW OFFSET
  log NAME OFFSET SIZE
next i</code></pre></div>

Since the XOR is relative to the beginning of each file.</div>

			
			
									
						<div id='list_thanks83501'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/34492.html" class="username">finale00</a> for the post: </dt>
			<dd><span title="Tue Jan 17, 2023 8:33 am"><a href="../Users/115999.html" class="username">AgentCat</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput83501'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

							<div id="sig83501" class="signature"><a href="http://wiki.xentax.com/index.php/Model_Import_Plugins" class="postlink">Model Import Plugins/Scripts</a><br>
<br>
<a href="http://www.himeworks.com/noesis-plugins/" class="postlink">Noesis Plugins</a> | <a href="https://www.dropbox.com/s/ekavgz89jgaikzw" class="postlink">Reference files</a><br>
<br>
Reference<br>
<a href="http://wiki.xentax.com/index.php/3D_Model_Guide" class="postlink">Guide to 3D model reversal</a> | <a href="http://wiki.xentax.com/index.php/3D_Model_Glossary" class="postlink">3D glossary</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=10157" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=13&amp;t=10157&amp;watch=topic&amp;start=0&amp;hash=2774cf16" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=13&amp;t=10157&amp;unwatch=topic&amp;start=0&amp;hash=2774cf16" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=10157&amp;bookmark=1&amp;hash=2774cf16" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=10157" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=10157&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=10157">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			7 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=13" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Code Talk”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <a href="../Users/123876.html" class="username">escape209</a> and 1 guest</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="../Navigation/index.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
