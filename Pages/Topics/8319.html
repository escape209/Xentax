<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>[Tutorial] Exploring model formats: 9 Dragon - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=8319">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="./ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="./index.php" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="./index.php" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="http://forum.xentax.com/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="./memberlist.php?mode=viewprofile&u=123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=f03065a94e53d4183cf1d6f8f99502e7" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="./index.php" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="29"><a itemprop="item" href="./viewforum.php?f=29"><span itemprop="name">Tutorials</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./8319.html">[Tutorial] Exploring model formats: 9 Dragon</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Read or post any tutorial related to file format analysis for modding purposes.<br /></div>


<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=8319" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=29&amp;t=8319&amp;watch=topic&amp;start=0&amp;hash=d9545151" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=29&amp;t=8319&amp;unwatch=topic&amp;start=0&amp;hash=d9545151" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=8319&amp;bookmark=1&amp;hash=d9545151" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=8319" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=8319&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="8319" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			1 post
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p67356" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile67356">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=34492.html" class="username">finale00</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=34492&amp;sr=posts">2382</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sat Apr 09, 2011 1:22 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="34492"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/true">170 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="34492"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/34492/false">307 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact finale00">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact finale00</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=67356" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content67356">

					<h3 class="first">
						<a href="./viewtopic.php?p=67356#p67356">[Tutorial] Exploring model formats: 9 Dragon</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/67356/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=67356" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post67356' href="./viewtopic.php?f=29&amp;p=67356&amp;thanks=67356&amp;to_id=34492&amp;from_id=123876" title="Say Thanks to the author of the post: finale00"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=67356#p67356" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=34492.html" class="username">finale00</a></strong> &raquo; </span><time datetime="2012-02-17T22:04:52+00:00">Fri Feb 17, 2012 11:04 pm</time>
			</p>
			
			
			
			<div class="content">Using this game for reference: <a href="http://forum.xentax.com/viewtopic.php?f=16&amp;t=8317" class="postlink">viewtopic.php?f=16&amp;t=8317</a><br>
<br>
<strong class="text-strong">Intro</strong><br>
<br>
This is not a full tutorial. It doesn't show you step-by-step how each section of the file was discovered.<br>
Most of it was done through simple pattern-searching techniques like looking for specific sequences of bytes that repeated themselves (eg: int, int, float, int, repeat).<br>
<br>
The tutorial essentially goes through some basics to exploring a model format without any special tools other than a hex editor. You get an idea of some techniques used to help verify that your assumptions are correct. It then demonstrates some simple noesis functionality.<br>
<br>
You should not be following the tutorial as a guide to reversing the 9Dragon model format.<br>
You should be focusing on why I decided to look at a particular value, and how I decided that value makes sense.<br>
<br>
<strong class="text-strong">Tools</strong><br>
<br>
*Noesis<br>
*010 editor, or any hex editor that converts values in real-time.<br>
*calculator, windows calc.exe works fine)<br>
*text editor, for writing notes<br>
<br>
Tutorial files attached at the end of the post. Contains the following:<br>
<br>
*target model that we want<br>
*its textures<br>
*a bunch of smaller models for comparison.<br>
*a noesis python import script template<br>
<br>
This is the target model:<br>
<br>
<img src="http://i.imgur.com/nkDPC.jpg" class="postimage" alt="Image"><br>
<br>
Unless I specifically mention another file, all references to "the file" or "the model" is "obj_kjb_fountain.x3d"<br>
You should assume all numbers are in decimal unless I specifically say it is in hex (I use 0x... notation)<br>
I assume you're familiar with some 3D concepts.<br>
This is a pretty basic format but parsing it might take some time to figure out.<br>
<br>
Note that I wrote this after I figured out the format, but the general idea is there.<br>
<br>
<strong class="text-strong">1. Examining the structure</strong><br>
<br>
The first step is to decide whether you want to actually look at the format.<br>
Some things that you should check:<br>
<br>
-It's a model format<br>
-It's not compressed or encrypted<br>
-Whether it's little-endian or big-endian<br>
-There's a vertex buffer<br>
-There's an index buffer<br>
<br>
If you see vertex and index buffers, then your chances are better because now you don't have to worry about how all the data comes together; it's pretty much given to you. <br>
<br>
If the data makes no sense, then it might be compressed or encrypted. If you don't know much about compression or encryption, best thing is to just upload samples and hope someone will figure it out.<br>
<br>
Endian-ness is not too hard to figure out. Usually if you look at integers you'll see the order quickly.<br>
<br>
Here, just at the top you quickly see a section that looks like a bunch of floats. Probably a vertex buffer.<br>
<br>
<img src="http://i.imgur.com/Ap1WO.jpg" class="postimage" alt="Image"><br>
<br>
Similarly, scrolling down some more past all those floats you see a bunch of 2-byte integers. These are likely going to be the face indices.<br>
<br>
<img src="http://i.imgur.com/CW4tG.jpg" class="postimage" alt="Image"><br>
<br>
<strong class="text-strong">2. Drafting an outline</strong><br>
<br>
You should start writing down whatever you've found. This makes it easier to identify patterns, allows you to remember what you were looking at (if you choose to stop and re-visit it later), and...well, you have your reference available to share if someone asks for it. How you do it is really up to you.<br>
<br>
You might start with something like<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Struct File {
	 ???
	 vertexbuffer?
	 indexbuffer?
	 ???
}
</code></pre></div>

Based on your quick skim through the file.<br>
<br>
<strong class="text-strong">Examining the vertex buffer</strong><br>
<br>
The section of floats that we assumed may be a vertex buffer should be something we check first. I mean, if it's not a vertex buffer, then who knows what it could be.<br>
<br>
If you look at the bytes before the section of floats, you should notice an integer (0x20 00 00 00)<br>
Why I think this is an integer? Doesn't matter. You may think that it's just 4 random bytes, but we're not here to argue how bytes should be grouped. It makes more sense to assume that it is an integer and see what you can do with it.<br>
<br>
<img src="http://i.imgur.com/ICdUD.jpg" class="postimage" alt="Image"><br>
<br>
If you examine those 4 bytes, you'll find that it is the number 32.<br>
Ok, so now we can assume that this particular mesh has 32 vertices, and consequently it's followed by 32 vertex structs. So let's update the draft.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct File {
   ???
	 int32 numVerts?
	 vertexBuffer?
	 indexBuffer?
	 ???
}
</code></pre></div>

<strong class="text-strong">Examining the index buffer</strong><br>
<br>
Since we already know that there's an index buffer, then presumably each index will reference one of the vertices associated with this mesh.<br>
<br>
Scrolling past the vertex buffer, you should see the indices again. Now look at where the vertex buffer ends, and you'll find another integer. <br>
<br>
<img src="http://i.imgur.com/Wm8oz.jpg" class="postimage" alt="Image"><br>
<br>
Examining its value, you see that it's 48.<br>
Now, just looking at the indices you should quickly see that they are stored as 2-byte integers.<br>
<br>
Assuming this is the index count, highlight 48 indices, which should be 96 bytes.<br>
<br>
<img src="http://i.imgur.com/KJGLh.jpg" class="postimage" alt="Image"><br>
<br>
<strong class="text-strong">number of vertices?</strong><br>
<br>
When you examine your indices, you should note a couple things<br>
-whether it's 0-based or 1-based<br>
-what the largest value is<br>
<br>
By determining this, you have an idea how many vertices there are, and you can use this to verify your previous assumptions.<br>
<br>
From this index buffer, you can see that 0x1F00 is the largest value, or 31.<br>
You should see that it is 0-based. This would suggest that the largest vertex number is 32, which should sound familiar.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct File {
   ???
	 int32 numVerts
	 vertexBuffer?
	 int32 numIdx
	 int16[numIdx] index
	 ???
}
</code></pre></div>

<strong class="text-strong">Vertex struct?</strong><br>
<br>
Now we know where the numVerts is, the numIdx is, and where the index buffer is.<br>
We also know that there is nothing but floats in between the numVerts and numIdx. Assuming it is indeed the vertex buffer, we can hope to calculate the size of each vertex.<br>
<br>
Select all of the bytes from just after the numVerts up to right before the numIdx.<br>
You should have selected 1280 bytes.<br>
<br>
Logically, each vertex should follow the same pattern, so we can assume each vertex is the same size.<br>
Doing some quick calculations, 1280 / 32 = 40. So our assumption here is that each vertex contains 40 bytes.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Struct Vertex {
   40 bytes
}

struct File {
   ???
	 int32 numVerts
	 numVerts Vertex
	 int32 numIdx
	 int16[numIdx] index
	 ???
}
</code></pre></div>

<strong class="text-strong">Examining the vertex</strong><br>
<br>
Assuming each vertex is 40 bytes, you can now look at what those 40 bytes might represent.<br>
You suspect they are floats, so just look at all of them and verify that they are all floats that make sense.<br>
<br>
Makes sense means that they should be fairly reasonable numbers. Nothing like 2.843e-30. Remember these are vertices, and so you should have some idea what kind of values you are looking for.<br>
<br>
So for example, the first 3 floats have values greater than |1|, so they can't be normals or UV's. This suggests that the first 3 floats are vertex coords. The next 7 floats have values less than |1|, so they could be normals or UV's.<br>
<br>
Either way, at least you have an idea where the coords are.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Struct Vertex {
   float[3] vx, vy, vz
	 float[7] ???
}

struct File {
   ???
	 int32 numVerts
	 numVerts Vertex
	 int32 numIdx
	 int16[numIdx] index
	 ???
}
</code></pre></div>

<strong class="text-strong">Testing your assumptions</strong><br>
<br>
Up until now, everything is theory. You don't know whether what you've wrote down is actually correct or not.<br>
This is when you use noesis or some other 3D tool.<br>
<br>
Noesis makes it convenient because all you have to worry about is parsing the data.<br>
It's also convenient because I've already prepared templates to use, so just copy the template into noesis python plugins folder and edit it in a text editor or some IDE.<br>
<br>
Noesis has a "reload plugins" function under the tools menu that makes it easy to reload the plugin if you make changes.<br>
<br>
Start by filling in the "registerNoesisTypes" function by replacing "game" and ".ext" with the appropriate values ("9 Dragon" and ".x3d")<br>
<br>
Type checking is not too important right now.<br>
<br>
Next you want to fill in the "parse_file" method.<br>
<br>
We've skipped a bunch of data at the very beginning, and our reference only shows that we know where the numVerts is.<br>
We can hardcode values since we're just testing a single model right now, so look at where the numVerts is and go to that offset.<br>
<br>
Now you are pretty much just following the outline you wrote<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>def parse_file(self):
	'''Main parser method'''

	#skip unknown stuff, hardcoded value
	self.inFile.seek(215)
	
	#get numVerts and parse vertex buffer
	numVerts = self.inFile.readUInt()
	self.parse_vertices(numVerts)
</code></pre></div>

Now you write the "parse_vertices" method, knowing that each struct is 40 bytes and there are numVerts of them.<br>
You want to bind the vertBuff, knowing that the coords are the first three floats (so at offset 0 of each vertex struct)<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>def parse_vertices(self, numVerts):
        
	vertBuff = self.inFile.readBytes(numVerts*40)
	
	#bind the buffer
	rapi.rpgBindPositionBufferOfs(vertBuff, noesis.RPGEODATA_FLOAT, 40, 0)
	
	#plot the points
	rapi.rpgCommitTriangles(None, noesis.RPGEODATA_USHORT, numVerts, noesis.RPGEO_POINTS, 1)
</code></pre></div>

And finally, you plot the points to see if it makes any sense.<br>
<br>
<img src="http://i.imgur.com/VDZ1Y.jpg" class="postimage" alt="Image"><br>
<br>
Hard to tell, but at least it doesn't seem too random.<br>
<br>
Maybe we should try getting the faces in.<br>
Following the outline above, you just fill in the indices.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>def parse_file(self):
	'''Main parser method'''

	self.inFile.seek(215)
	numVerts = self.inFile.readUInt()
	self.parse_vertices(numVerts)
	
	#get indices and parse index buffer
	numIdx = self.inFile.readUInt()
	self.parse_faces(numIdx)
</code></pre></div>

And of course, the "parse_faces" function, where you are drawing the faces<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>def parse_faces(self, numIdx):
        
	idxBuff = self.inFile.readBytes(numIdx*2)
	rapi.rpgCommitTriangles(idxBuff, noesis.RPGEODATA_USHORT, numIdx, noesis.RPGEO_TRIANGLE, 1)
</code></pre></div>

And now you should get this:<br>
<br>
<img src="http://i.imgur.com/FHL97.jpg" class="postimage" alt="Image"><br>
<br>
Which sort of looks like part of the model we want.<br>
<br>
<strong class="text-strong">Next steps</strong><br>
<br>
At this point, you've already figured out where the vertex and index buffers are.<br>
All you have to do is figure out how to parse the file to <br>
<br>
1: skip data that you don't know<br>
2: get data that you want<br>
<br>
It may take some time just to figure out the pattern, but once you get the pattern you should be able to write a parser for it.<br>
<br>
Things to look out for:<br>
<br>
-strings. How do you determine the length of a string? maybe there's a number that tells you how long a string is?<br>
<br>
-start and end of sections. Just like how the numIdx appeared right after the end of the vertex buffer, and how the index buffer appeared right after the numIdx, the rest of the file probably has similar patterns. For example, right after the index buffer, you might see another integer that tells you what the next piece of data will be like.<br>
<br>
-patterns. If you do a quick skim through the file, you might find yourself seeing the same types of data again and again. So for this model, you should see vertex buffers and index buffers several times. You can use this to calculate the number of meshes there are, and determine where that number is stored.<br>
<br>
Not only should you look at the file in general, but you should also look at specific sections of data for patterns. It doesn't hurt to cut out a section of the data and paste it into another file to look at it more closely.<br>
<br>
-compare files. It is often useful to compare different files that are similar to determine whether the patterns hold. If they do, then you're probably right. However, note that the extra files I uploaded are in act a slightly different format, but you should be able to apply the same techniques to figure out their format. Or at least, the numVerts, vertex buffer, numIdx, and index buffer.<br>
<br>
You can get more models from the main game thread at the top of the post.<br>
<br>
<strong class="text-strong">Comments</strong><br>
<br>
Obviously, we know nothing about what the data represents initially.<br>
It's not like I disassembled some libraries to examine the algorithm used to parse the file.<br>
<br>
You have to think flexibly and search for any patterns.<br>
Some things should be fairly obvious what they are after awhile, while other things you just have to figure out how to skip, and then re-visit when you've isolated them from the rest of the file.</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=5080">tutorial.7z</a></dt>
						<dd>(229.39 KiB) Downloaded 105 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks67356'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="./memberlist.php?mode=viewprofile&u=34492.html" class="username">finale00</a> for the post (total 7):</dt>
			<dd><span title="Sat Feb 18, 2012 6:35 am"><a href="./memberlist.php?mode=viewprofile&u=4970.html" class="username">Acewell</a></span>, <span title="Mon Feb 20, 2012 3:24 am"><a href="./memberlist.php?mode=viewprofile&u=23042.html" class="username">Z Man</a></span>, <span title="Sun Feb 26, 2012 10:56 am"><a href="./memberlist.php?mode=viewprofile&u=36052.html" class="username">Andrakann</a></span>, <span title="Fri Mar 02, 2012 8:02 am"><a href="./memberlist.php?mode=viewprofile&u=35452.html" class="username">goder2910</a></span>, <span title="Sun Mar 25, 2012 3:12 am"><a href="./memberlist.php?mode=viewprofile&u=28880.html" class="username">jooped</a></span>, <span title="Mon Jun 11, 2012 2:01 am"><a href="./memberlist.php?mode=viewprofile&u=40075.html" class="username">joqqy</a></span>, <span title="Fri Apr 05, 2013 6:58 pm"><a href="./memberlist.php?mode=viewprofile&u=30708.html" class="username">Shadamachaeon</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput67356'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;12.07%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 12.07%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

							<div id="sig67356" class="signature"><a href="http://wiki.xentax.com/index.php/Model_Import_Plugins" class="postlink">Model Import Plugins/Scripts</a><br>
<br>
<a href="http://www.himeworks.com/noesis-plugins/" class="postlink">Noesis Plugins</a> | <a href="https://www.dropbox.com/s/ekavgz89jgaikzw" class="postlink">Reference files</a><br>
<br>
Reference<br>
<a href="http://wiki.xentax.com/index.php/3D_Model_Guide" class="postlink">Guide to 3D model reversal</a> | <a href="http://wiki.xentax.com/index.php/3D_Model_Glossary" class="postlink">3D glossary</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=8319" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=29&amp;t=8319&amp;watch=topic&amp;start=0&amp;hash=d9545151" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=29&amp;t=8319&amp;unwatch=topic&amp;start=0&amp;hash=d9545151" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=8319&amp;bookmark=1&amp;hash=d9545151" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=8319" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=8319&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

	
	
	
			<div class="pagination">
			1 post
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=29" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Tutorials”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <a href="./memberlist.php?mode=viewprofile&u=123876.html" class="username">escape209</a> and 0 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="./index.php" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
