<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Help needed with Hex2Obj/MechWarrior 4 - Page 2 - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=23560&amp;start=15">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="../../Source/assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="../../Source/styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="../../Source/ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="../Navigation/index.html" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="../Navigation/index.html" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="../Source/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="../Users/123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=959ea14a0771cc2de19d1bba114b7679" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="../Navigation/index.html" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="16"><a itemprop="item" href="./viewforum.php?f=16"><span itemprop="name">3D/2D models</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./23560 (1).html">Help needed with Hex2Obj/MechWarrior 4</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Post questions about game models here, or help out others!<br /></div>

	<div class="rules rules-link">
		<div class="inner">

					<a href="http://forum.xentax.com/viewtopic.php?f=28&amp;t=1270">Forum rules</a>
		
		</div>
	</div>

<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=23560" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=16&amp;t=23560&amp;watch=topic&amp;start=15&amp;hash=47965b57" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=16&amp;t=23560&amp;unwatch=topic&amp;start=15&amp;hash=47965b57" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=23560&amp;start=15&amp;bookmark=1&amp;hash=47965b57" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=23560" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=23560&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="23560" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			43 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="./23560.html" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="./23560.html" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="./23560 (2).html" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./23560 (2).html" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




			<div id="p172148" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172148">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/57570.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=57570_1576893318.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/57570.html" class="username">Bigchillghost</a>							</dt>

						<dd class="profile-rank">double-veteran<br /><img src="./images/ranks/vip-1.png" alt="double-veteran" title="double-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=57570&amp;sr=posts">1030</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Jul 05, 2016 9:37 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="57570"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/57570/true">32 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="57570"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/57570/false">1215 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Bigchillghost">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Bigchillghost</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172148" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172148">

					<h3 class="first">
						<a href="./viewtopic.php?p=172148#p172148">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172148/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172148" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172148' href="./viewtopic.php?f=16&amp;p=172148&amp;thanks=172148&amp;to_id=57570&amp;from_id=123876" title="Say Thanks to the author of the post: Bigchillghost"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172148#p172148" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/57570.html" class="username">Bigchillghost</a></strong> &raquo; </span><time datetime="2021-03-11T04:13:12+00:00">Thu Mar 11, 2021 5:13 am</time>
			</p>
			
			
			
			<div class="content">The normals have a vertex count field (as a 4-byte integer) before the buffer, same as positions and uvs. So just search the count in the file and you should be able to locate to it.</div>

			
			
									
						<div id='list_thanks172148'>
</div>
<div id='div_post_reput172148'>
</div>

							<div id="sig172148" class="signature"><span style="color:#0080BF"><span style="font-size:130%;line-height:116%"><strong class="text-strong">May you find peace in this puzzle-solving game.</strong></span></span>
<ul><li><em class="text-italics"><a href="viewtopic.php?f=29&amp;t=17889" class="postlink">An Imitable Workflow for Reverse Engineering a Game Model</a></em></li><li><em class="text-italics"><a href="viewtopic.php?f=16&amp;t=23963" class="postlink">Advanced Mesh Reaper</a></em></li><li><em class="text-italics"><a href="viewtopic.php?f=16&amp;t=18005" class="postlink">Reverse Model Wireframe</a></em></li></ul>

<span style="font-size:130%;line-height:116%"><span style="color:#FF0000"><strong class="text-strong">Say it with action: click the <img src="https://i.ibb.co/9thLJf8/i.png" class="postimage" alt="Image"> when you get helped.<img class="smilies" src="./images/smilies/%5Bcolon%5D%29.gif" width="15" height="15" alt=":)" title="Smile"></strong></span></span></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172155" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172155">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172155" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172155">

					<h3 >
						<a href="./viewtopic.php?p=172155#p172155">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172155/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172155" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172155' href="./viewtopic.php?f=16&amp;p=172155&amp;thanks=172155&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172155#p172155" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-11T12:51:26+00:00">Thu Mar 11, 2021 1:51 pm</time>
			</p>
			
			
			
			<div class="content">I've managed to find the normals for atl_ldleg at 171B.<br>
Should also be able to find the normals for the foot too.<br>
<br>
Something I've noticed, however, is that the positions seem to be the same for the hip and femur parts of the mech.<br>
<br>
This may also apply for the other files.</div>

			
			
									
						<div id='list_thanks172155'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/97263.html" class="username">OPR23b</a> for the post: </dt>
			<dd><span title="Mon Mar 14, 2022 3:30 am"><a href="../Users/92135.html" class="username">divyameen</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput172155'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172167" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172167">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/531.html" class="username">mariokart64n</a>							</dt>

						<dd class="profile-rank">ultra-veteran<br /><img src="./images/ranks/vip-1.png" alt="ultra-veteran" title="ultra-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=531&amp;sr=posts">586</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jun 05, 2005 12:00 pm</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Ontario, Canada</dd>
							    <dd class="profile-posts" data-user-give-id="531"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/true">36 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="531"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/false">243 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact mariokart64n">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact mariokart64n</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172167" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172167">

					<h3 >
						<a href="./viewtopic.php?p=172167#p172167">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172167/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172167" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172167' href="./viewtopic.php?f=16&amp;p=172167&amp;thanks=172167&amp;to_id=531&amp;from_id=123876" title="Say Thanks to the author of the post: mariokart64n"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172167#p172167" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/531.html" class="username">mariokart64n</a></strong> &raquo; </span><time datetime="2021-03-11T18:37:32+00:00">Thu Mar 11, 2021 7:37 pm</time>
			</p>
			
			
			
			<div class="content">I examined the format, here is my understanding of the file spec:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct vertex_entry {
    float            x;
    float            y;
    float            z;
    };
    
struct tvertex_entry {
    float            u;
    float            v;
    };
    
struct unk107_entry {
    float            x;
    float            y;
    float            z;
    float            w;
    };
    
struct vnorm_entry {
    float            x;
    float            y;
    float            z;
    };
 
struct mesh_entry {
    uint32_t        unk105;
    uint32_t        vert_count;
    vertex_entry*   vertices;      // read per 'vert_count'
    uint32_t        tvert_count;
    tvertex_entry*  tvertices;     // read per 'tvert_count'
    uint8_t         unk106[25];
    uint32_t        unk107_count;
    uint8_t*         unk107    // read per 'unk107_count'
    uint8_t         unk108[5];
    uint32_t        face_count;
    uint8_t*        faces;         // read per 'face_count'
    uint32_t        unk109_count;
    unk107_entry*   unk109;        // read per 'unk109_count'
    uint32_t        unk110_count;
    uint32_t        norm_count;
    vnorm_entry*    normals;       // read per 'norm_count'
    uint32_t        unk111
};
 
struct lod_entry {
    uint32_t        unk101;
    uint32_t        block_size;
    uint32_t        unk103;
    uint32_t        sub_mesh_count;
    mesh_entry*  meshes;      // read per 'sub_mesh_count'
    };
    
struct erf_file {
    uint32_t        filedid;
    uint32_t        unk001;
    uint32_t        unk002;
    uint32_t        unk003;
    float           unk004[4];
    uint16_t        lod_count;
    uint32_t        unk005;
    uint32_t        unk006;
    uint32_t        unk007;
    lod_entry*     lods;        // read per 'lod_count'
    };
</code></pre></div>

<a href="https://ibb.co/BryK53w" class="postlink"><img src="https://i.ibb.co/txqPTK3/Image1.jpg" class="postimage" alt="Image"></a><br>
<br>
Below is a python script that will work in the latest version of blender (currently 2.92.0)<br>
<br>
usage: start blender, goto the script tab then press NEW in the text editor and paste the below script into the editor. To execute the script press ALT+P or press the [&gt;] play button, a file selection box will appear which will allow you to select erf files to import. Once the script has executed once it can then be accessed through the File &gt; Import Dialog<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>""" ======================================================================

    Python Code:    [PC] MechWarrior 4: Vengeance (for Blender 2.92.0)
    Author:         mariokart64n
    Date:           March 11, 2021
    Version:        0.1

    ======================================================================

    ChangeLog:

    2021-01-31
        Script Wrote

    ====================================================================== """


import bpy
from pathlib import Path  # Needed for os stuff
import random
import struct  # Needed for Binary Reader
import math

useOpenDialog = True

# ====================================================================================
# MAXCSRIPT FUNCTIONS
# ====================================================================================
# These function are written to mimic native functions in
# maxscript. This is to make porting my old maxscripts
# easier, so alot of these functions may be redundant..
# ====================================================================================
#

signed, unsigned = 0, 1  # Enums for read function
seek_set, seek_cur, seek_end = 0, 1, 2  # Enums for seek function
SEEK_ABS, SEEK_REL, SEEK_END = 0, 1, 2  # Enums for seek function


class dummy:
    object = None

    def __init__(self, position = (0.0, 0.0, 0.0)):
        self.object = bpy.data.objects.new("Empty", None )
        bpy.context.scene.collection.objects.link(self.object)
        self.object.empty_display_size = 1
        self.object.empty_display_type = 'CUBE'
        self.object.location = position
        
    def position(self, pos=(0.0, 0.0, 0.0)):
        if self.object != None: self.object.location = pos

    def name(self, name=""):
        if self.object != None and name != "": self.object.name = name

    def showLinks(self, enable=False):
        return enable

    def showLinksOnly(self, enable=False):
        return enable


def messageBox(message="", title="Message Box", icon='INFO'):
    def draw(self, context): self.layout.label(text=message)

    bpy.context.window_manager.popup_menu(draw, title=title, icon=icon)
    return None


def doesFileExist(filename):
    file = Path(filename)
    if file.is_file():
        return True
    elif file.is_dir():
        return True
    else:
        return False


def clearListener(len=64):
    for i in range(0, len): print('')


def getFilenameFile(file):  # returns: "myImage"
    return Path(file).stem


class fopen:
    little_endian = True
    file = ""
    mode = 'rb'
    data = bytearray()
    size = 0
    pos = 0
    isGood = False

    def __init__(self, filename=None, mode='rb', isLittleEndian=True):
        if mode == 'rb':
            if filename != None and Path(filename).is_file():
                self.data = open(filename, mode).read()
                self.size = len(self.data)
                self.pos = 0
                self.mode = mode
                self.file = filename
                self.little_endian = isLittleEndian
                self.isGood = True
        else:
            self.file = filename
            self.mode = mode
            self.data = bytearray()
            self.pos = 0
            self.size = 0
            self.little_endian = isLittleEndian
            self.isGood = False

        return None

    # def __del__(self):
    #    self.flush()

    def resize(self, dataSize=0):
        if dataSize &gt; 0:
            self.data = bytearray(dataSize)
        else:
            self.data = bytearray()
        self.pos = 0
        self.size = dataSize
        self.isGood = False
        return None

    def flush(self):
        print("flush")
        print("file:\t%s" % self.file)
        print("isGood:\t%s" % self.isGood)
        print("size:\t%s" % len(self.data))
        if self.file != "" and not self.isGood and len(self.data) &gt; 0:
            self.isGood = True

            s = open(self.file, 'w+b')
            s.write(self.data)
            s.close()

    def read_and_unpack(self, unpack, size):
        '''
          Charactor, Byte-order
          @,         native, native
          =,         native, standard
          &lt;,         little endian
          &gt;,         big endian
          !,         network

          Format, C-type,         Python-type, Size[byte]
          c,      char,           byte,        1
          b,      signed char,    integer,     1
          B,      unsigned char,  integer,     1
          h,      short,          integer,     2
          H,      unsigned short, integer,     2
          i,      int,            integer,     4
          I,      unsigned int,   integer,     4
          f,      float,          float,       4
          d,      double,         float,       8
        '''
        value = 0
        if self.size &gt; 0 and self.pos + size &lt; self.size:
            value = struct.unpack_from(unpack, self.data, self.pos)[0]
            self.pos += size
        return value

    def pack_and_write(self, pack, size, value):
        if self.pos + size &gt; self.size:
            self.data.extend(b'\x00' * ((self.pos + size) - self.size))
            self.size = self.pos + size
        try:
            struct.pack_into(pack, self.data, self.pos, value)
        except:
            print('Pos:\t%i / %i (buf:%i) [val:%i:%i:%s]' % (self.pos, self.size, len(self.data), value, size, pack))
            pass
        self.pos += size
        return None

    def set_pointer(self, offset):
        self.pos = offset
        return None


def fclose(bitStream):
    bitStream.flush()
    bitStream.isGood = False


def fseek(bitStream, offset, dir):
    if dir == 0:
        bitStream.set_pointer(offset)
    elif dir == 1:
        bitStream.set_pointer(bitStream.pos + offset)
    elif dir == 2:
        bitStream.set_pointer(bitStream.pos - offset)
    return None


def ftell(bitStream):
    return bitStream.pos


def readByte(bitStream, isSigned=0):
    fmt = 'b' if isSigned == 0 else 'B'
    return (bitStream.read_and_unpack(fmt, 1))


def readShort(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'h' if isSigned == 0 else 'H'
    return (bitStream.read_and_unpack(fmt, 2))


def readLong(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'i' if isSigned == 0 else 'I'
    return (bitStream.read_and_unpack(fmt, 4))


def readFloat(bitStream):
    fmt = '&gt;f' if not bitStream.little_endian else '&lt;f'
    return (bitStream.read_and_unpack(fmt, 4))


def mesh(vertices=[], faces=[], materialIDs=[], tverts=[], normals=[], colours=[], materials=[], mscale=1.0,
         flipAxis=False, obj_name="Object", lay_name=''):
    #
    # This function is pretty, ugly
    # imports the mesh into blender
    #

    # Clear Any Object Selections
    # for o in bpy.context.selected_objects: o.select = False
    bpy.context.view_layer.objects.active = None
    
    # Get Collection (Layers)
    if lay_name != '':
        # make collection
        layer = bpy.data.collections.new(lay_name)
        bpy.context.scene.collection.children.link(layer)
    else:
        layer = bpy.data.collections[bpy.context.view_layer.active_layer_collection.name]

    # make mesh
    msh = bpy.data.meshes.new('Mesh')

    # msh.name = msh.name.replace(".", "_")

    # Apply vertex scaling
    # mscale *= bpy.context.scene.unit_settings.scale_length
    if len(vertices) &gt; 0:
        vertArray = [[float] * 3] * len(vertices)
        if flipAxis:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    -vertices[v][2] * mscale,
                    vertices[v][1] * mscale
                )
        else:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    vertices[v][1] * mscale,
                    vertices[v][2] * mscale
                )

    # assign data from arrays
    msh.from_pydata(vertArray, [], faces)

    # set surface to smooth
    msh.polygons.foreach_set("use_smooth", [True] * len(msh.polygons))

    # Set Normals
    if len(faces) &gt; 0:
        if len(normals) &gt; 0:
            msh.use_auto_smooth = True
            if len(normals) == (len(faces) * 3):
                msh.normals_split_custom_set(normals)
            else:
                normArray = [[float] * 3] * (len(faces) * 3)
                if flipAxis:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 -normals[faces[i][v]][2],
                                 normals[faces[i][v]][1]]
                            )
                else:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 normals[faces[i][v]][1],
                                 normals[faces[i][v]][2]]
                            )
                msh.normals_split_custom_set(normArray)

        # create texture corrdinates
        #print("tverts ", len(tverts))
        # this is just a hack, i just add all the UVs into the same space &lt;&lt;&lt;
        if len(tverts) &gt; 0:
            uvw = msh.uv_layers.new()
            # if len(tverts) == (len(faces) * 3):
            #    for v in range(0, len(faces) * 3):
            #        msh.uv_layers[uvw.name].data[v].uv = tverts[v]
            # else:
            uvwArray = [[float] * 2] * len(tverts[0])
            for i in range(0, len(tverts[0])):
                uvwArray[i] = [0.0, 0.0]

            for v in range(0, len(tverts[0])):
                for i in range(0, len(tverts)):
                    uvwArray[v][0] += tverts[i][v][0]
                    uvwArray[v][1] += 1.0 - tverts[i][v][1]

            for i in range(0, len(faces)):
                for v in range(0, 3):
                    msh.uv_layers[uvw.name].data[(i * 3) + v].uv = (
                        uvwArray[faces[i][v]][0],
                        uvwArray[faces[i][v]][1]
                    )


    # Create Face Maps?
    # msh.face_maps.new()

    # Update Mesh
    msh.update()

    # Check mesh is Valid
    if msh.validate():
        # Erase Mesh
        print("Mesh Invalid!")
        msh.user_clear()
        bpy.data.meshes.remove(msh)
        return None

    # Assign Mesh to Object
    obj = bpy.data.objects.new(obj_name, msh)
    # obj.name = obj.name.replace(".", "_")

    for i in range(0, len(materials)):

        if len(obj.material_slots) &lt; (i + 1):
            # if there is no slot then we append to create the slot and assign
            obj.data.materials.append(materials[i])
        else:
            # we always want the material in slot[0]
            obj.material_slots[0].material = materials[i]
        # obj.active_material = obj.material_slots[i].material

    for i in range(0, len(materialIDs)):
        obj.data.polygons[i].material_index = materialIDs[i]

    # obj.data.materials.append(material)
    layer.objects.link(obj)

    # Generate a Material
    # img_name = "Test.jpg"  # dummy texture
    # mat_count = len(texmaps)

    # if mat_count == 0 and len(materialIDs) &gt; 0:
    #    for i in range(0, len(materialIDs)):
    #        if (materialIDs[i] + 1) &gt; mat_count: mat_count = materialIDs[i] + 1

    # Assign Material ID's
    bpy.context.view_layer.objects.active = obj
    bpy.ops.object.mode_set(mode='EDIT', toggle=False)
    bpy.context.tool_settings.mesh_select_mode = [False, False, True]

    bpy.ops.object.mode_set(mode='OBJECT')
    # materialIDs

    # Redraw Entire Scene
    # bpy.context.scene.update()

    return obj

class erf_mesh:
    unk101 = 0
    block_size = 0
    unk103 = 0  # hx4B
    unk104 = 0
    vert_count = 0
    face_count1 = 0
    tvert_count = 0
    # need to inspect this
    face_count2 = 0
    norm_count = 0
    vcol_count = 0
    unk105_count = 0
    vert_array = []
    tvert_array = []
    face_array = []
    norm_array = []
    vcol_array = []
    unk105_array = []
    def read_mesh (self, f= fopen()):
        
        
        self.unk101 = readLong(f)
        self.block_size = readLong(f) + ftell(f) + 4
        self.unk103 = readLong(f)
        self.unk104 = readByte(f)
        
        self.face_count1 = readLong(f)
        self.vert_count = readLong(f)
        
        
        if self.vert_count &gt; 0:
            self.vert_array = [[float] * 3] * self.vert_count
            for i in range(0, self.vert_count):
                self.vert_array[i] = [
                    readFloat(f),
                    readFloat(f),
                    readFloat(f)
                    ]
        
        self.tvert_count = readLong(f)
        if self.tvert_count &gt; 0:
            self.tvert_array = [[float] * 2] * self.tvert_count
            for i in range(0, self.tvert_count):
                self.tvert_array[i] = [
                    readFloat(f),
                    readFloat(f)
                    ]
        
        fseek(f, 40, seek_cur) # wtf is this
        
        
        self.face_count2 = readLong(f)
        
        if self.face_count2 &gt; 0:
            self.face_array = [[int] * 3] * int(self.face_count2 / 3)
            for i in range(0, int(self.face_count2 / 3)):
                self.face_array[i] = [
                    readByte(f, unsigned),
                    readByte(f, unsigned),
                    readByte(f, unsigned)
                    ]
        
        self.norm_count = readLong(f)
        if self.norm_count &gt; 0:
            self.norm_array = [[float] * 4] * self.norm_count
            for i in range(0, self.norm_count):
                self.norm_array[i] = [
                    readFloat(f),
                    readFloat(f),
                    readFloat(f),
                    readFloat(f)
                    ]
        
        self.vcol_count = readLong(f)
        if self.vcol_count &gt; 0:
            print ("Inspect this")
        
        
        
        
        self.unk105_count = readLong(f)
        if self.unk105_count &gt; 0:
            self.unk105_array = [[float] * 3] * self.unk105_count
            for i in range(0, self.unk105_count):
                self.unk105_array[i] = [
                    readFloat(f),
                    readFloat(f),
                    readFloat(f)
                    ]
        
        fseek(f, self.block_size, seek_set)

class erf_file:
    filedid = 0     # ERF#
    unk001 = 0      # hx0E
    unk002 = 0      # hx90
    unk003 = 0      # hx09
    unk004 = [0.0, 0.0, 0.0, 0.0]
    mesh_count = 0
    unk005 = 0
    unk006 = 0      # hx12
    unk007 = 0      # hx00
    meshes = []
    
    def read_erf (self, f = fopen()):
        
        self.filedid = readLong(f)
        
        if self.filedid != 0x45524623:
            print ("Unsupported File Type")
            return False # (ERF#)
        
        self.unk001 = readLong(f)
        self.unk002 = readLong(f)
        self.unk003 = readLong(f)
        self.unk004 = [readFloat(f), readFloat(f), readFloat(f), readFloat(f)]
        self.mesh_count = readShort(f)
        self.unk005 = readLong(f)
        self.unk006 = readLong(f)
        self.unk007 = readLong(f)
        
        if self.mesh_count &gt; 0:
            self.meshes = [erf_mesh] * self.mesh_count
            for i in range(0, self.mesh_count):
                self.meshes[i] = erf_mesh()
                self.meshes[i].read_mesh(f)
                
        return True

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None

def read (file):
    if not doesFileExist(file): return False
    
    #deleteScene(['MESH', 'ARMATURE'])  # Clear Scene
    
    f = fopen(file, 'rb')
    
    erf = erf_file()
    erf.read_erf(f)
    
    
    d = dummy(position=(erf.unk004[0],erf.unk004[1], erf.unk004[2]))
    d.object.empty_display_size = erf.unk004[3]
    d.object.empty_display_type = 'SPHERE'
    
    for i in range(0, erf.mesh_count):
        msh = mesh(
            obj_name=getFilenameFile(file),
            vertices=erf.meshes[i].vert_array,
            faces=erf.meshes[i].face_array,
            tverts=[erf.meshes[i].tvert_array],
            normals=erf.meshes[i].unk105_array
            )
        msh.location = (-erf.unk004[0], -erf.unk004[1], -erf.unk004[2])
        msh.parent = d.object
        break
    
    
    fclose(f)
    return True


# ====================================================================================
# BLENDER API FUNCTIONS
# ====================================================================================
# These are functions or wrappers specific with dealing with blenders API
# ====================================================================================
#

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None


# Callback when file(s) are selected
def mechwarrioriv_imp_callback(fpath="", files=[], clearScene=True):
    if len(files) &gt; 0 and clearScene: deleteScene(['MESH', 'ARMATURE'])
    for file in files:
        read(fpath + file.name)
    if len(files) &gt; 0:
        messageBox("Done!")
        return True
    else:
        return False


# Wrapper that Invokes FileSelector to open files from blender
def mechwarrioriv_imp(reload=False):
    # Un-Register Operator
    if reload and hasattr(bpy.types, "IMPORTHELPER_OT_mechwarrioriv_imp"):  # print(bpy.ops.importhelper.mechwarrioriv_imp.idname())

        try:
            bpy.types.TOPBAR_MT_file_import.remove(
                bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp').menu_func_import)
        except:
            print("Failed to Unregister2")

        try:
            bpy.utils.unregister_class(bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp'))
        except:
            print("Failed to Unregister1")

    # Define Operator
    class ImportHelper_mechwarrioriv_imp(bpy.types.Operator):

        # Operator Path
        bl_idname = "importhelper.mechwarrioriv_imp"
        bl_label = "Select File"

        # Operator Properties
        # filter_glob: bpy.props.StringProperty(default='*.jpg;*.jpeg;*.png;*.tif;*.tiff;*.bmp', options={'HIDDEN'})
        filter_glob: bpy.props.StringProperty(default='*.erf', options={'HIDDEN'}, subtype='FILE_PATH')

        # Variables
        filepath: bpy.props.StringProperty(subtype="FILE_PATH")  # full path of selected item (path+filename)
        filename: bpy.props.StringProperty(subtype="FILE_NAME")  # name of selected item
        directory: bpy.props.StringProperty(subtype="FILE_PATH")  # directory of the selected item
        files: bpy.props.CollectionProperty(
            type=bpy.types.OperatorFileListElement)  # a collection containing all the selected items�f filenames

        # Controls
        my_int1: bpy.props.IntProperty(name="Some Integer", description="Tooltip")
        my_float1: bpy.props.FloatProperty(name="Scale", default=1.0, description="Changes Scale of the imported Mesh")
        # my_float2: bpy.props.FloatProperty(name="Some Float point", default = 0.25, min = -0.25, max = 0.5)
        my_bool1: bpy.props.BoolProperty(name="Clear Scene", default=True,
                                         description="Deletes everything in the scene prior to importing")
        my_bool2: bpy.props.BoolProperty(name="Skeleton", default=False, description="Imports Bones to an Armature")
        my_bool3: bpy.props.BoolProperty(name="Vertex Weights", default=False, description="Builds Vertex Groups")
        my_bool4: bpy.props.BoolProperty(name="Vertex Normals", default=False, description="Applies Custom Normals")
        my_bool5: bpy.props.BoolProperty(name="Vertex Colours", default=False, description="Builds Vertex Colours")
        my_bool6: bpy.props.BoolProperty(name="Guess Parents", default=False,
                                         description="Uses algorithm to Guess Bone Parenting")
        my_bool7: bpy.props.BoolProperty(name="Dump Textures", default=False,
                                         description="Writes Textures from a file pair '_tex.bin'")
        my_string1: bpy.props.StringProperty(name="", default="Armature",
                                             description="Name of Armature to Import Bones to")
        my_dropdown1: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )
        my_dropdown2: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )

        # Runs when this class OPENS
        def invoke(self, context, event):

            # Retrieve Settings
            try:
                self.filepath = bpy.types.Scene.mechwarrioriv_imp_filepath
            except:
                bpy.types.Scene.mechwarrioriv_imp_filepath = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.directory = bpy.types.Scene.mechwarrioriv_imp_directory
            except:
                bpy.types.Scene.mechwarrioriv_imp_directory = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.my_float1 = bpy.types.Scene.mechwarrioriv_imp_my_float1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_float1 = bpy.props.FloatProperty(default=1.0)

            try:
                self.my_bool1 = bpy.types.Scene.mechwarrioriv_imp_my_bool1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool1 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool2 = bpy.types.Scene.mechwarrioriv_imp_my_bool2
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool2 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool3 = bpy.types.Scene.mechwarrioriv_imp_my_bool3
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool3 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool4 = bpy.types.Scene.mechwarrioriv_imp_my_bool4
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool4 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool5 = bpy.types.Scene.mechwarrioriv_imp_my_bool5
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool5 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool6 = bpy.types.Scene.mechwarrioriv_imp_my_bool6
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool6 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool7 = bpy.types.Scene.mechwarrioriv_imp_my_bool7
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool7 = bpy.props.BoolProperty(default=False)

            try:
                self.my_string1 = bpy.types.Scene.my_string1
            except:
                bpy.types.Scene.my_string1 = bpy.props.BoolProperty(default=False)

            # Open File Browser
            # Set Properties of the File Browser
            context.window_manager.fileselect_add(self)
            context.area.tag_redraw()

            return {'RUNNING_MODAL'}

        # Runs when this Window is CANCELLED
        def cancel(self, context):
            print("run bitch")

        # Runs when the class EXITS
        def execute(self, context):

            # Save Settings
            bpy.types.Scene.mechwarrioriv_imp_filepath = self.filepath
            bpy.types.Scene.mechwarrioriv_imp_directory = self.directory
            bpy.types.Scene.mechwarrioriv_imp_my_float1 = self.my_float1
            bpy.types.Scene.mechwarrioriv_imp_my_bool1 = self.my_bool1
            bpy.types.Scene.mechwarrioriv_imp_my_bool2 = self.my_bool2
            bpy.types.Scene.mechwarrioriv_imp_my_bool3 = self.my_bool3
            bpy.types.Scene.mechwarrioriv_imp_my_bool4 = self.my_bool4
            bpy.types.Scene.mechwarrioriv_imp_my_bool5 = self.my_bool5
            bpy.types.Scene.mechwarrioriv_imp_my_bool6 = self.my_bool6
            bpy.types.Scene.mechwarrioriv_imp_my_bool7 = self.my_bool7
            bpy.types.Scene.mechwarrioriv_imp_my_string1 = self.my_string1

            # Run Callback
            mechwarrioriv_imp_callback(
                self.directory + "\\",
                self.files,
                self.my_bool1
                )

            return {"FINISHED"}

            # Window Settings

        def draw(self, context):

            # Set Properties of the File Browser
            # context.space_data.params.use_filter = True
            # context.space_data.params.use_filter_folder=True #to not see folders

            # Configure Layout
            # self.layout.use_property_split = True       # To Enable Align
            # self.layout.use_property_decorate = False   # No animation.

            self.layout.row().label(text="Import Settings")

            self.layout.separator()
            self.layout.row().prop(self, "my_bool1")
            #self.layout.row().prop(self, "my_float1")

            #box = self.layout.box()
            #box.label(text="Include")
            #box.prop(self, "my_bool2")
            #box.prop(self, "my_bool3")
            #box.prop(self, "my_bool4")
            #box.prop(self, "my_bool5")

            #box = self.layout.box()
            #box.label(text="Misc")
            #box.prop(self, "my_bool6")
            #box.prop(self, "my_bool7")
            #box.label(text="Import Bones To:")
            #box.prop(self, "my_string1")

            self.layout.separator()

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="  Author:", icon='QUESTION')
            col.alignment = 'LEFT'
            col.label(text="mariokart64n")

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="Release:", icon='GRIP')
            col.alignment = 'LEFT'
            col.label(text="March 11, 2021")

        def menu_func_import(self, context):
            self.layout.operator(
                "importhelper.mechwarrioriv_imp",
                text="MechWarrior 4: Vengeance (*.erf)"
                )

    # Register Operator
    bpy.utils.register_class(ImportHelper_mechwarrioriv_imp)
    bpy.types.TOPBAR_MT_file_import.append(ImportHelper_mechwarrioriv_imp.menu_func_import)

    # Assign Shortcut key
    # bpy.context.window_manager.keyconfigs.active.keymaps["Window"].keymap_items.new('bpy.ops.text.run_script()', 'E', 'PRESS', ctrl=True, shift=False, repeat=False)

    # Call ImportHelper
    bpy.ops.importhelper.mechwarrioriv_imp('INVOKE_DEFAULT')




clearListener()  # clears out console
if not useOpenDialog:

    deleteScene(['MESH', 'ARMATURE'])  # Clear Scene
    read(
        ""
        )
    messageBox("Done!")
else:
    mechwarrioriv_imp(True)

</code></pre></div>

The process was recorded and are made available through youtube:<br>
<br>
Format Analysis: <a href="https://youtu.be/2f3kJWki5yw" class="postlink">https://youtu.be/2f3kJWki5yw</a><br>
Blender Coding: <a href="https://youtu.be/V0JrVue5erE" class="postlink">https://youtu.be/V0JrVue5erE</a></div>

			
			
													<div class="notice">
					Last edited by <a href="../Users/531.html" class="username">mariokart64n</a> on Fri Mar 12, 2021 2:57 pm, edited 1 time in total.
									</div>
			
						<div id='list_thanks172167'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/531.html" class="username">mariokart64n</a> for the post: </dt>
			<dd><span title="Thu Mar 11, 2021 8:54 pm"><a href="../Users/97263.html" class="username">OPR23b</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput172167'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

							<div id="sig172167" class="signature">Maxscript and other finished work I've done can be found on my <a href="https://www.deviantart.com/mariokart64n" class="postlink">DeviantArt</a> account</div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172170" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172170">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172170" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172170">

					<h3 >
						<a href="./viewtopic.php?p=172170#p172170">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172170/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172170" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172170' href="./viewtopic.php?f=16&amp;p=172170&amp;thanks=172170&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172170#p172170" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-11T19:55:48+00:00">Thu Mar 11, 2021 8:55 pm</time>
			</p>
			
			
			
			<div class="content">I genuinely can't thank you enough for doing this.<br>
<br>
I'll test it on some erf files, and then I'll post my results on here.<br>
<br>
Really though, TYSM.</div>

			
			
									
						<div id='list_thanks172170'>
</div>
<div id='div_post_reput172170'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172176" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172176">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172176" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172176">

					<h3 >
						<a href="./viewtopic.php?p=172176#p172176">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172176/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172176" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172176' href="./viewtopic.php?f=16&amp;p=172176&amp;thanks=172176&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172176#p172176" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-11T20:49:03+00:00">Thu Mar 11, 2021 9:49 pm</time>
			</p>
			
			
			
			<div class="content">After some testing, the script definitely works as intended, but there are some exceptions.<br>
<br>
With some files the mechs seem to be either missing vertices or cause blender to freeze.<br>
<br>
Here's some files from 3 mechs that seem to have this kind of problem, if you need more samples, let me know.</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=19705">erfexamples.zip</a></dt>
						<dd>(92.74 KiB) Downloaded 6 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks172176'>
</div>
<div id='div_post_reput172176'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172180" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172180">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/531.html" class="username">mariokart64n</a>							</dt>

						<dd class="profile-rank">ultra-veteran<br /><img src="./images/ranks/vip-1.png" alt="ultra-veteran" title="ultra-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=531&amp;sr=posts">586</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jun 05, 2005 12:00 pm</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Ontario, Canada</dd>
							    <dd class="profile-posts" data-user-give-id="531"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/true">36 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="531"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/false">243 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact mariokart64n">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact mariokart64n</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172180" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172180">

					<h3 >
						<a href="./viewtopic.php?p=172180#p172180">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172180/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172180" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172180' href="./viewtopic.php?f=16&amp;p=172180&amp;thanks=172180&amp;to_id=531&amp;from_id=123876" title="Say Thanks to the author of the post: mariokart64n"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172180#p172180" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/531.html" class="username">mariokart64n</a></strong> &raquo; </span><time datetime="2021-03-11T23:23:48+00:00">Fri Mar 12, 2021 12:23 am</time>
			</p>
			
			
			
			<div class="content">after you paste the script in blender's text editor, navigate to line #432 of the python script<br>
<br>
and <strong class="text-strong">replace</strong> the line 
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>fseek(f, 40, seek_cur) # wtf is this</code></pre></div>

with this
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>fseek(f, 25, seek_cur) # wtf is this
fseek(f, readLong(f) + 5, seek_cur)</code></pre></div></div>

			
			
									
						<div id='list_thanks172180'>
</div>
<div id='div_post_reput172180'>
</div>

							<div id="sig172180" class="signature">Maxscript and other finished work I've done can be found on my <a href="https://www.deviantart.com/mariokart64n" class="postlink">DeviantArt</a> account</div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172184" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172184">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172184" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172184">

					<h3 >
						<a href="./viewtopic.php?p=172184#p172184">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172184/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172184" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172184' href="./viewtopic.php?f=16&amp;p=172184&amp;thanks=172184&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172184#p172184" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-12T03:19:57+00:00">Fri Mar 12, 2021 4:19 am</time>
			</p>
			
			
			
			<div class="content">I think I've figured out why the script imports certain files with missing pieces.<br>
<br>
Its because some ERFs have multiple submeshes, and because the script doesn't support these submeshes, it doesn't import the files correctly.<br>
Keep in mind that there are also LODs for the models, and if you need it, I can send you a tool I've been using to analyze the ERFs.<br>
<br>
I've attached some examples of these ERFs for you to look at.</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=19706">submeshexamples.zip</a></dt>
						<dd>(105.37 KiB) Downloaded 4 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks172184'>
</div>
<div id='div_post_reput172184'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172195" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172195">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/531.html" class="username">mariokart64n</a>							</dt>

						<dd class="profile-rank">ultra-veteran<br /><img src="./images/ranks/vip-1.png" alt="ultra-veteran" title="ultra-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=531&amp;sr=posts">586</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jun 05, 2005 12:00 pm</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Ontario, Canada</dd>
							    <dd class="profile-posts" data-user-give-id="531"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/true">36 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="531"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/false">243 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact mariokart64n">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact mariokart64n</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172195" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172195">

					<h3 >
						<a href="./viewtopic.php?p=172195#p172195">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172195/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172195" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172195' href="./viewtopic.php?f=16&amp;p=172195&amp;thanks=172195&amp;to_id=531&amp;from_id=123876" title="Say Thanks to the author of the post: mariokart64n"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172195#p172195" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/531.html" class="username">mariokart64n</a></strong> &raquo; </span><time datetime="2021-03-12T13:46:49+00:00">Fri Mar 12, 2021 2:46 pm</time>
			</p>
			
			
			
			<div class="content"><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>""" ======================================================================

    Python Code:    [PC] MechWarrior 4: Vengeance (for Blender 2.92.0)
    Author:         mariokart64n
    Date:           March 11, 2021
    Version:        0.2

    Description:
        Imports erf Mesh files into blender, for more info see post
        
        https://forum.xentax.com/viewtopic.php?f=16&amp;t=23560
        
    ======================================================================

    ChangeLog:

    2021-03-11
        Script Wrote
        Fixed a crashed by incorrectly reading data that comes after the
        texture vertex data
    
    2021-03-12
        Corrected to read sub meshes
        Corrected Method for dimensioning Multi-Dimensional Arrays
        Added Toggle to import LOD Meshes
        Flipped the Y - Z Axis

    ====================================================================== """


import bpy
from pathlib import Path  # Needed for os stuff
import random
import struct  # Needed for Binary Reader
import math

useOpenDialog = True

# ====================================================================================
# MAXCSRIPT FUNCTIONS
# ====================================================================================
# These function are written to mimic native functions in
# maxscript. This is to make porting my old maxscripts
# easier, so alot of these functions may be redundant..
# ====================================================================================
#

signed, unsigned = 0, 1  # Enums for read function
seek_set, seek_cur, seek_end = 0, 1, 2  # Enums for seek function
SEEK_ABS, SEEK_REL, SEEK_END = 0, 1, 2  # Enums for seek function


class dummy:
    object = None

    def __init__(self, position = (0.0, 0.0, 0.0)):
        self.object = bpy.data.objects.new("Empty", None )
        bpy.context.scene.collection.objects.link(self.object)
        self.object.empty_display_size = 1
        self.object.empty_display_type = 'CUBE'
        self.object.location = position
        
    def position(self, pos=(0.0, 0.0, 0.0)):
        if self.object != None: self.object.location = pos

    def name(self, name=""):
        if self.object != None and name != "": self.object.name = name

    def showLinks(self, enable=False):
        return enable

    def showLinksOnly(self, enable=False):
        return enable


def messageBox(message="", title="Message Box", icon='INFO'):
    def draw(self, context): self.layout.label(text=message)

    bpy.context.window_manager.popup_menu(draw, title=title, icon=icon)
    return None


def doesFileExist(filename):
    file = Path(filename)
    if file.is_file():
        return True
    elif file.is_dir():
        return True
    else:
        return False


def clearListener(len=64):
    for i in range(0, len): print('')


def getFilenameFile(file):  # returns: "myImage"
    return Path(file).stem


class fopen:
    little_endian = True
    file = ""
    mode = 'rb'
    data = bytearray()
    size = 0
    pos = 0
    isGood = False

    def __init__(self, filename=None, mode='rb', isLittleEndian=True):
        if mode == 'rb':
            if filename != None and Path(filename).is_file():
                self.data = open(filename, mode).read()
                self.size = len(self.data)
                self.pos = 0
                self.mode = mode
                self.file = filename
                self.little_endian = isLittleEndian
                self.isGood = True
        else:
            self.file = filename
            self.mode = mode
            self.data = bytearray()
            self.pos = 0
            self.size = 0
            self.little_endian = isLittleEndian
            self.isGood = False

        return None

    # def __del__(self):
    #    self.flush()

    def resize(self, dataSize=0):
        if dataSize &gt; 0:
            self.data = bytearray(dataSize)
        else:
            self.data = bytearray()
        self.pos = 0
        self.size = dataSize
        self.isGood = False
        return None

    def flush(self):
        print("flush")
        print("file:\t%s" % self.file)
        print("isGood:\t%s" % self.isGood)
        print("size:\t%s" % len(self.data))
        if self.file != "" and not self.isGood and len(self.data) &gt; 0:
            self.isGood = True

            s = open(self.file, 'w+b')
            s.write(self.data)
            s.close()

    def read_and_unpack(self, unpack, size):
        '''
          Charactor, Byte-order
          @,         native, native
          =,         native, standard
          &lt;,         little endian
          &gt;,         big endian
          !,         network

          Format, C-type,         Python-type, Size[byte]
          c,      char,           byte,        1
          b,      signed char,    integer,     1
          B,      unsigned char,  integer,     1
          h,      short,          integer,     2
          H,      unsigned short, integer,     2
          i,      int,            integer,     4
          I,      unsigned int,   integer,     4
          f,      float,          float,       4
          d,      double,         float,       8
        '''
        value = 0
        if self.size &gt; 0 and self.pos + size &lt; self.size:
            value = struct.unpack_from(unpack, self.data, self.pos)[0]
            self.pos += size
        return value

    def pack_and_write(self, pack, size, value):
        if self.pos + size &gt; self.size:
            self.data.extend(b'\x00' * ((self.pos + size) - self.size))
            self.size = self.pos + size
        try:
            struct.pack_into(pack, self.data, self.pos, value)
        except:
            print('Pos:\t%i / %i (buf:%i) [val:%i:%i:%s]' % (self.pos, self.size, len(self.data), value, size, pack))
            pass
        self.pos += size
        return None

    def set_pointer(self, offset):
        self.pos = offset
        return None


def fclose(bitStream):
    bitStream.flush()
    bitStream.isGood = False


def fseek(bitStream, offset, dir):
    if dir == 0:
        bitStream.set_pointer(offset)
    elif dir == 1:
        bitStream.set_pointer(bitStream.pos + offset)
    elif dir == 2:
        bitStream.set_pointer(bitStream.pos - offset)
    return None


def ftell(bitStream):
    return bitStream.pos


def readByte(bitStream, isSigned=0):
    fmt = 'b' if isSigned == 0 else 'B'
    return (bitStream.read_and_unpack(fmt, 1))


def readShort(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'h' if isSigned == 0 else 'H'
    return (bitStream.read_and_unpack(fmt, 2))


def readLong(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'i' if isSigned == 0 else 'I'
    return (bitStream.read_and_unpack(fmt, 4))


def readFloat(bitStream):
    fmt = '&gt;f' if not bitStream.little_endian else '&lt;f'
    return (bitStream.read_and_unpack(fmt, 4))


def mesh(vertices=[], faces=[], materialIDs=[], tverts=[], normals=[], colours=[], materials=[], mscale=1.0,
         flipAxis=False, obj_name="Object", lay_name=''):
    #
    # This function is pretty, ugly
    # imports the mesh into blender
    #

    # Clear Any Object Selections
    # for o in bpy.context.selected_objects: o.select = False
    bpy.context.view_layer.objects.active = None
    
    # Get Collection (Layers)
    if lay_name != '':
        # make collection
        layer = bpy.data.collections.new(lay_name)
        bpy.context.scene.collection.children.link(layer)
    else:
        layer = bpy.data.collections[bpy.context.view_layer.active_layer_collection.name]

    # make mesh
    msh = bpy.data.meshes.new('Mesh')

    # msh.name = msh.name.replace(".", "_")

    # Apply vertex scaling
    # mscale *= bpy.context.scene.unit_settings.scale_length
    if len(vertices) &gt; 0:
        vertArray = [[float] * 3] * len(vertices)
        if flipAxis:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    -vertices[v][2] * mscale,
                    vertices[v][1] * mscale
                )
        else:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    vertices[v][1] * mscale,
                    vertices[v][2] * mscale
                )

    # assign data from arrays
    msh.from_pydata(vertArray, [], faces)

    # set surface to smooth
    msh.polygons.foreach_set("use_smooth", [True] * len(msh.polygons))

    # Set Normals
    if len(faces) &gt; 0:
        if len(normals) &gt; 0:
            msh.use_auto_smooth = True
            if len(normals) == (len(faces) * 3):
                msh.normals_split_custom_set(normals)
            else:
                normArray = [[float] * 3] * (len(faces) * 3)
                if flipAxis:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 -normals[faces[i][v]][2],
                                 normals[faces[i][v]][1]]
                            )
                else:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 normals[faces[i][v]][1],
                                 normals[faces[i][v]][2]]
                            )
                msh.normals_split_custom_set(normArray)

        # create texture corrdinates
        #print("tverts ", len(tverts))
        # this is just a hack, i just add all the UVs into the same space &lt;&lt;&lt;
        if len(tverts) &gt; 0:
            uvw = msh.uv_layers.new()
            # if len(tverts) == (len(faces) * 3):
            #    for v in range(0, len(faces) * 3):
            #        msh.uv_layers[uvw.name].data[v].uv = tverts[v]
            # else:
            uvwArray = [[float] * 2] * len(tverts[0])
            for i in range(0, len(tverts[0])):
                uvwArray[i] = [0.0, 0.0]

            for v in range(0, len(tverts[0])):
                for i in range(0, len(tverts)):
                    uvwArray[v][0] += tverts[i][v][0]
                    uvwArray[v][1] += 1.0 - tverts[i][v][1]

            for i in range(0, len(faces)):
                for v in range(0, 3):
                    msh.uv_layers[uvw.name].data[(i * 3) + v].uv = (
                        uvwArray[faces[i][v]][0],
                        uvwArray[faces[i][v]][1]
                    )


    # Create Face Maps?
    # msh.face_maps.new()

    # Update Mesh
    msh.update()

    # Check mesh is Valid
    if msh.validate():
        # Erase Mesh
        print("Mesh Invalid!")
        msh.user_clear()
        bpy.data.meshes.remove(msh)
        return None

    # Assign Mesh to Object
    obj = bpy.data.objects.new(obj_name, msh)
    # obj.name = obj.name.replace(".", "_")

    for i in range(0, len(materials)):

        if len(obj.material_slots) &lt; (i + 1):
            # if there is no slot then we append to create the slot and assign
            obj.data.materials.append(materials[i])
        else:
            # we always want the material in slot[0]
            obj.material_slots[0].material = materials[i]
        # obj.active_material = obj.material_slots[i].material

    for i in range(0, len(materialIDs)):
        obj.data.polygons[i].material_index = materialIDs[i]

    # obj.data.materials.append(material)
    layer.objects.link(obj)

    # Generate a Material
    # img_name = "Test.jpg"  # dummy texture
    # mat_count = len(texmaps)

    # if mat_count == 0 and len(materialIDs) &gt; 0:
    #    for i in range(0, len(materialIDs)):
    #        if (materialIDs[i] + 1) &gt; mat_count: mat_count = materialIDs[i] + 1

    # Assign Material ID's
    bpy.context.view_layer.objects.active = obj
    bpy.ops.object.mode_set(mode='EDIT', toggle=False)
    bpy.context.tool_settings.mesh_select_mode = [False, False, True]

    bpy.ops.object.mode_set(mode='OBJECT')
    # materialIDs

    # Redraw Entire Scene
    # bpy.context.scene.update()

    return obj

class erf_mesh:
    unk101 = 0
    block_size = 0
    unk103 = 0  # hx4B
    unk104 = 0
    vert_count = 0
    face_count1 = 0
    tvert_count = 0
    # need to inspect this
    face_count2 = 0
    norm_count = 0
    vcol_count = 0
    unk105_count = 0
    vert_array = []
    tvert_array = []
    face_array = []
    norm_array = []
    vcol_array = []
    unk105_array = []
    def read_mesh (self, f= fopen()):
        self.vert_array = []
        self.tvert_array = []
        self.face_array = []
        self.norm_array = []
        self.vcol_array = []
        self.unk105_array = []

        self.unk101 = readLong(f)
        self.block_size = readLong(f) + ftell(f) + 4
        self.unk103 = readLong(f)
        self.unk104 = readByte(f)
        
        vert_idx_off = 0
        tvert_idx_off = 0
        face_idx_off = 0
        norm_idx_off = 0
        vcol_idx_off = 0
        unk105_idx_off = 0
        
        for m in range(0, self.unk104):
            self.face_count1 = readLong(f)
            self.vert_count = readLong(f)
            
            if self.vert_count &gt; 0:
                self.vert_array.extend([[[float] for x in range(3)] for y in range(self.vert_count)])
                for i in range(0, self.vert_count):
                    self.vert_array[i + vert_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            self.tvert_count = readLong(f)
            if self.tvert_count &gt; 0:
                self.tvert_array.extend([[[float] for x in range(2)] for y in range(self.tvert_count)])
                for i in range(0, self.tvert_count):
                    self.tvert_array[i + tvert_idx_off] = [
                        readFloat(f),
                        readFloat(f)
                        ]
            
            fseek(f, 25, seek_cur) # wtf is this
            fseek(f, readLong(f) + 5, seek_cur)
            
            self.face_count2 = readLong(f)
            if self.face_count2 &gt; 0:
                self.face_array.extend([[[int] for x in range(3)] for y in range(int(self.face_count2 / 3))])
                for i in range(0, int(self.face_count2 / 3)):
                    self.face_array[i + face_idx_off] = [
                        readByte(f, unsigned) + vert_idx_off,
                        readByte(f, unsigned) + vert_idx_off,
                        readByte(f, unsigned) + vert_idx_off
                        ]
            
            self.norm_count = readLong(f)
            if self.norm_count &gt; 0:
                self.norm_array.extend([[[float] for x in range(4)] for y in range(self.norm_count)])
                for i in range(0, self.norm_count):
                    self.norm_array[i + norm_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            self.vcol_count = readLong(f)
            if self.vcol_count &gt; 0:
                print ("Inspect this")
            
            self.unk105_count = readLong(f)
            if self.unk105_count &gt; 0:
                self.unk105_array.extend([[[float] for x in range(3)] for y in range(self.unk105_count)])
                for i in range(0, self.unk105_count):
                    self.unk105_array[i + unk105_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            vert_idx_off += self.vert_count
            tvert_idx_off += self.tvert_count
            face_idx_off += int(self.face_count2 / 3)
            norm_idx_off += self.norm_count
            vcol_idx_off += self.vcol_count
            unk105_idx_off += self.unk105_count
        
        fseek(f, self.block_size, seek_set)

class erf_file:
    filedid = 0     # ERF#
    unk001 = 0      # hx0E
    unk002 = 0      # hx90
    unk003 = 0      # hx09
    unk004 = [0.0, 0.0, 0.0, 0.0]
    mesh_count = 0
    unk005 = 0
    unk006 = 0      # hx12
    unk007 = 0      # hx00
    meshes = []
    
    def read_erf (self, f = fopen()):
        
        self.filedid = readLong(f)
        
        if self.filedid != 0x45524623:
            print ("Unsupported File Type")
            return False # (ERF#)
        
        self.unk001 = readLong(f)
        self.unk002 = readLong(f)
        self.unk003 = readLong(f)
        self.unk004 = [readFloat(f), readFloat(f), readFloat(f), readFloat(f)]
        self.mesh_count = readShort(f)
        self.unk005 = readLong(f)
        self.unk006 = readLong(f)
        self.unk007 = readLong(f)
        
        if self.mesh_count &gt; 0:
            self.meshes = [erf_mesh] * self.mesh_count
            for i in range(0, self.mesh_count):
                self.meshes[i] = erf_mesh()
                self.meshes[i].read_mesh(f)
                
        return True

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None

def read (file, impLOD = False):
    if not doesFileExist(file): return False
    
    #deleteScene(['MESH', 'ARMATURE'])  # Clear Scene
    
    f = fopen(file, 'rb')
    
    erf = erf_file()
    erf.read_erf(f)
    
    
    d = dummy(position=(erf.unk004[0],erf.unk004[1], erf.unk004[2]))
    d.object.empty_display_size = erf.unk004[3]
    d.object.empty_display_type = 'SPHERE'
    
    for i in range(0, erf.mesh_count):
        msh = mesh(
            obj_name=getFilenameFile(file),
            vertices=erf.meshes[i].vert_array,
            faces=erf.meshes[i].face_array,
            tverts=[erf.meshes[i].tvert_array],
            normals=erf.meshes[i].unk105_array,
            flipAxis=True
            )
        msh.location = (-erf.unk004[0], erf.unk004[2], -erf.unk004[1])
        msh.parent = d.object
        if not impLOD: break
    
    
    fclose(f)
    return True


# ====================================================================================
# BLENDER API FUNCTIONS
# ====================================================================================
# These are functions or wrappers specific with dealing with blenders API
# ====================================================================================
#

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None


# Callback when file(s) are selected
def mechwarrioriv_imp_callback(fpath="", files=[], clearScene=True, impLOD=False):
    if len(files) &gt; 0 and clearScene: deleteScene(['MESH', 'ARMATURE', 'EMPTY'])
    for file in files:
        read(fpath + file.name, impLOD)
    if len(files) &gt; 0:
        messageBox("Done!")
        return True
    else:
        return False


# Wrapper that Invokes FileSelector to open files from blender
def mechwarrioriv_imp(reload=False):
    # Un-Register Operator
    if reload and hasattr(bpy.types, "IMPORTHELPER_OT_mechwarrioriv_imp"):  # print(bpy.ops.importhelper.mechwarrioriv_imp.idname())

        try:
            bpy.types.TOPBAR_MT_file_import.remove(
                bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp').menu_func_import)
        except:
            print("Failed to Unregister2")

        try:
            bpy.utils.unregister_class(bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp'))
        except:
            print("Failed to Unregister1")

    # Define Operator
    class ImportHelper_mechwarrioriv_imp(bpy.types.Operator):

        # Operator Path
        bl_idname = "importhelper.mechwarrioriv_imp"
        bl_label = "Select File"

        # Operator Properties
        # filter_glob: bpy.props.StringProperty(default='*.jpg;*.jpeg;*.png;*.tif;*.tiff;*.bmp', options={'HIDDEN'})
        filter_glob: bpy.props.StringProperty(default='*.erf', options={'HIDDEN'}, subtype='FILE_PATH')

        # Variables
        filepath: bpy.props.StringProperty(subtype="FILE_PATH")  # full path of selected item (path+filename)
        filename: bpy.props.StringProperty(subtype="FILE_NAME")  # name of selected item
        directory: bpy.props.StringProperty(subtype="FILE_PATH")  # directory of the selected item
        files: bpy.props.CollectionProperty(
            type=bpy.types.OperatorFileListElement)  # a collection containing all the selected items�f filenames

        # Controls
        my_int1: bpy.props.IntProperty(name="Some Integer", description="Tooltip")
        my_float1: bpy.props.FloatProperty(name="Scale", default=1.0, description="Changes Scale of the imported Mesh")
        # my_float2: bpy.props.FloatProperty(name="Some Float point", default = 0.25, min = -0.25, max = 0.5)
        my_bool1: bpy.props.BoolProperty(name="Clear Scene", default=True,
                                         description="Deletes everything in the scene prior to importing")
        my_bool2: bpy.props.BoolProperty(name="LOD Meshes", default=False, description="Imports Lower Res Meshes")
        my_bool3: bpy.props.BoolProperty(name="Vertex Weights", default=False, description="Builds Vertex Groups")
        my_bool4: bpy.props.BoolProperty(name="Vertex Normals", default=False, description="Applies Custom Normals")
        my_bool5: bpy.props.BoolProperty(name="Vertex Colours", default=False, description="Builds Vertex Colours")
        my_bool6: bpy.props.BoolProperty(name="Guess Parents", default=False,
                                         description="Uses algorithm to Guess Bone Parenting")
        my_bool7: bpy.props.BoolProperty(name="Dump Textures", default=False,
                                         description="Writes Textures from a file pair '_tex.bin'")
        my_string1: bpy.props.StringProperty(name="", default="Armature",
                                             description="Name of Armature to Import Bones to")
        my_dropdown1: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )
        my_dropdown2: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )

        # Runs when this class OPENS
        def invoke(self, context, event):

            # Retrieve Settings
            try:
                self.filepath = bpy.types.Scene.mechwarrioriv_imp_filepath
            except:
                bpy.types.Scene.mechwarrioriv_imp_filepath = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.directory = bpy.types.Scene.mechwarrioriv_imp_directory
            except:
                bpy.types.Scene.mechwarrioriv_imp_directory = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.my_float1 = bpy.types.Scene.mechwarrioriv_imp_my_float1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_float1 = bpy.props.FloatProperty(default=1.0)

            try:
                self.my_bool1 = bpy.types.Scene.mechwarrioriv_imp_my_bool1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool1 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool2 = bpy.types.Scene.mechwarrioriv_imp_my_bool2
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool2 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool3 = bpy.types.Scene.mechwarrioriv_imp_my_bool3
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool3 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool4 = bpy.types.Scene.mechwarrioriv_imp_my_bool4
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool4 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool5 = bpy.types.Scene.mechwarrioriv_imp_my_bool5
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool5 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool6 = bpy.types.Scene.mechwarrioriv_imp_my_bool6
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool6 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool7 = bpy.types.Scene.mechwarrioriv_imp_my_bool7
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool7 = bpy.props.BoolProperty(default=False)

            try:
                self.my_string1 = bpy.types.Scene.my_string1
            except:
                bpy.types.Scene.my_string1 = bpy.props.BoolProperty(default=False)

            # Open File Browser
            # Set Properties of the File Browser
            context.window_manager.fileselect_add(self)
            context.area.tag_redraw()

            return {'RUNNING_MODAL'}

        # Runs when this Window is CANCELLED
        def cancel(self, context):
            print("run bitch")

        # Runs when the class EXITS
        def execute(self, context):

            # Save Settings
            bpy.types.Scene.mechwarrioriv_imp_filepath = self.filepath
            bpy.types.Scene.mechwarrioriv_imp_directory = self.directory
            #bpy.types.Scene.mechwarrioriv_imp_my_float1 = self.my_float1
            bpy.types.Scene.mechwarrioriv_imp_my_bool1 = self.my_bool1
            bpy.types.Scene.mechwarrioriv_imp_my_bool2 = self.my_bool2
            #bpy.types.Scene.mechwarrioriv_imp_my_bool3 = self.my_bool3
            #bpy.types.Scene.mechwarrioriv_imp_my_bool4 = self.my_bool4
            #bpy.types.Scene.mechwarrioriv_imp_my_bool5 = self.my_bool5
            #bpy.types.Scene.mechwarrioriv_imp_my_bool6 = self.my_bool6
            #bpy.types.Scene.mechwarrioriv_imp_my_bool7 = self.my_bool7
            bpy.types.Scene.mechwarrioriv_imp_my_string1 = self.my_string1

            # Run Callback
            mechwarrioriv_imp_callback(
                self.directory + "\\",
                self.files,
                self.my_bool1,
                self.my_bool2
                )

            return {"FINISHED"}

            # Window Settings

        def draw(self, context):

            # Set Properties of the File Browser
            # context.space_data.params.use_filter = True
            # context.space_data.params.use_filter_folder=True #to not see folders

            # Configure Layout
            # self.layout.use_property_split = True       # To Enable Align
            # self.layout.use_property_decorate = False   # No animation.

            self.layout.row().label(text="Import Settings")

            self.layout.separator()
            self.layout.row().prop(self, "my_bool1")
            self.layout.row().prop(self, "my_bool2")
            #self.layout.row().prop(self, "my_float1")

            #box = self.layout.box()
            #box.label(text="Include")
            #box.prop(self, "my_bool2")
            #box.prop(self, "my_bool3")
            #box.prop(self, "my_bool4")
            #box.prop(self, "my_bool5")

            #box = self.layout.box()
            #box.label(text="Misc")
            #box.prop(self, "my_bool6")
            #box.prop(self, "my_bool7")
            #box.label(text="Import Bones To:")
            #box.prop(self, "my_string1")

            self.layout.separator()

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="  Author:", icon='QUESTION')
            col.alignment = 'LEFT'
            col.label(text="mariokart64n")

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="Release:", icon='GRIP')
            col.alignment = 'LEFT'
            col.label(text="March 11, 2021")

        def menu_func_import(self, context):
            self.layout.operator(
                "importhelper.mechwarrioriv_imp",
                text="MechWarrior 4: Vengeance (*.erf)"
                )

    # Register Operator
    bpy.utils.register_class(ImportHelper_mechwarrioriv_imp)
    bpy.types.TOPBAR_MT_file_import.append(ImportHelper_mechwarrioriv_imp.menu_func_import)

    # Assign Shortcut key
    # bpy.context.window_manager.keyconfigs.active.keymaps["Window"].keymap_items.new('bpy.ops.text.run_script()', 'E', 'PRESS', ctrl=True, shift=False, repeat=False)

    # Call ImportHelper
    bpy.ops.importhelper.mechwarrioriv_imp('INVOKE_DEFAULT')




clearListener()  # clears out console
if not useOpenDialog:

    deleteScene(['MESH', 'ARMATURE', 'EMPTY'])  # Clear Scene
    read(
        ""
        )
    messageBox("Done!")
else:
    mechwarrioriv_imp(True)

</code></pre></div></div>

			
			
									
						<div id='list_thanks172195'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/531.html" class="username">mariokart64n</a> for the post: </dt>
			<dd><span title="Fri Mar 12, 2021 3:16 pm"><a href="../Users/97263.html" class="username">OPR23b</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput172195'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

							<div id="sig172195" class="signature">Maxscript and other finished work I've done can be found on my <a href="https://www.deviantart.com/mariokart64n" class="postlink">DeviantArt</a> account</div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172196" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172196">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172196" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172196">

					<h3 >
						<a href="./viewtopic.php?p=172196#p172196">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172196/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172196" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172196' href="./viewtopic.php?f=16&amp;p=172196&amp;thanks=172196&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172196#p172196" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-12T14:12:07+00:00">Fri Mar 12, 2021 3:12 pm</time>
			</p>
			
			
			
			<div class="content">Script works like a charm, no more holes in the meshes.<br>
<br>
Great work, can't say enough that you've been a great help.</div>

			
			
									
						<div id='list_thanks172196'>
</div>
<div id='div_post_reput172196'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172200" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172200">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172200" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172200">

					<h3 >
						<a href="./viewtopic.php?p=172200#p172200">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172200/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172200" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172200' href="./viewtopic.php?f=16&amp;p=172200&amp;thanks=172200&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172200#p172200" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-12T15:16:59+00:00">Fri Mar 12, 2021 4:16 pm</time>
			</p>
			
			
			
			<div class="content">So, I have two last requests for MechWarrior 4 related stuff. I don't wanna ask for too much, but I would like to ask just these 2 things.<br>
<br>
<br>
For mariokart64n:<br>
<br>
Could you try to add support for the cockpit files? It's the last thing I'm asking for, and after that, the script should be completely finished.<br>
<br>
The attachment below has some examples of the cockpit files.<br>
<br>
<br>
For anyone with decryption knowledge:<br>
<br>
Could someone here try to decrypt the encrypted MekPak files?<br>
<br>
I would like to know if it would be possible to decrypt said files, since it would be nice to also have access to those mechs.<br>
<br>
The attachment below also has the encrypted files.<br>
<br>
<br>
Both things are put into 2 separate folders in the .zip, so just select the specific ones and you'll be good.</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=19708">finalerfexamples.zip</a></dt>
						<dd>(235.93 KiB) Downloaded 5 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks172200'>
</div>
<div id='div_post_reput172200'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172201" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172201">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/531.html" class="username">mariokart64n</a>							</dt>

						<dd class="profile-rank">ultra-veteran<br /><img src="./images/ranks/vip-1.png" alt="ultra-veteran" title="ultra-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=531&amp;sr=posts">586</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jun 05, 2005 12:00 pm</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Ontario, Canada</dd>
							    <dd class="profile-posts" data-user-give-id="531"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/true">36 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="531"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/false">243 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact mariokart64n">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact mariokart64n</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172201" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172201">

					<h3 >
						<a href="./viewtopic.php?p=172201#p172201">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172201/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172201" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172201' href="./viewtopic.php?f=16&amp;p=172201&amp;thanks=172201&amp;to_id=531&amp;from_id=123876" title="Say Thanks to the author of the post: mariokart64n"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172201#p172201" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/531.html" class="username">mariokart64n</a></strong> &raquo; </span><time datetime="2021-03-12T17:12:00+00:00">Fri Mar 12, 2021 6:12 pm</time>
			</p>
			
			
			
			<div class="content"><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>""" ======================================================================

    Python Code:    [PC] MechWarrior 4: Vengeance (for Blender 2.92.0)
    Author:         mariokart64n
    Date:           March 11, 2021
    Version:        0.2

    Description:
        Imports erf Mesh files into blender, for more info see post
        
        https://forum.xentax.com/viewtopic.php?f=16&amp;t=23560
        
    ======================================================================

    ChangeLog:

    2021-03-11
        Script Wrote
        Fixed a crashed by incorrectly reading data that comes after the
        texture vertex data
    
    2021-03-12
        Corrected to read sub meshes
        Corrected Method for dimensioning Multi-Dimensional Arrays
        Added Toggle to import LOD Meshes
        Flipped the Y - Z Axis
        Patch for cockpits
        By passed mesh validation which was causing issues
        MaterialIds are added to submeshes to be able to seperate them
        

    ====================================================================== """


import bpy
from pathlib import Path  # Needed for os stuff
import random
import struct  # Needed for Binary Reader
import math

useOpenDialog = True

# ====================================================================================
# MAXCSRIPT FUNCTIONS
# ====================================================================================
# These function are written to mimic native functions in
# maxscript. This is to make porting my old maxscripts
# easier, so alot of these functions may be redundant..
# ====================================================================================
#

signed, unsigned = 0, 1  # Enums for read function
seek_set, seek_cur, seek_end = 0, 1, 2  # Enums for seek function
SEEK_ABS, SEEK_REL, SEEK_END = 0, 1, 2  # Enums for seek function

def rancol4():
    return (random.uniform(0.0, 1.0), random.uniform(0.0, 1.0), random.uniform(0.0, 1.0), 1.0)

class dummy:
    object = None

    def __init__(self, position = (0.0, 0.0, 0.0)):
        self.object = bpy.data.objects.new("Empty", None )
        bpy.context.scene.collection.objects.link(self.object)
        self.object.empty_display_size = 1
        self.object.empty_display_type = 'CUBE'
        self.object.location = position
        
    def position(self, pos=(0.0, 0.0, 0.0)):
        if self.object != None: self.object.location = pos

    def name(self, name=""):
        if self.object != None and name != "": self.object.name = name

    def showLinks(self, enable=False):
        return enable

    def showLinksOnly(self, enable=False):
        return enable


def messageBox(message="", title="Message Box", icon='INFO'):
    def draw(self, context): self.layout.label(text=message)

    bpy.context.window_manager.popup_menu(draw, title=title, icon=icon)
    return None


def doesFileExist(filename):
    file = Path(filename)
    if file.is_file():
        return True
    elif file.is_dir():
        return True
    else:
        return False


def clearListener(len=64):
    for i in range(0, len): print('')


def getFilenameFile(file):  # returns: "myImage"
    return Path(file).stem


def findItem(array, value):
    index = -1
    try:
        index = array.index(value)
    except:
        pass
    return index


def append(array, value):
    array.append(value)
    return None


def appendIfUnique(array, value):
    try:
        array.index(value)
    except:
        array.append(value)
    return None


class fopen:
    little_endian = True
    file = ""
    mode = 'rb'
    data = bytearray()
    size = 0
    pos = 0
    isGood = False

    def __init__(self, filename=None, mode='rb', isLittleEndian=True):
        if mode == 'rb':
            if filename != None and Path(filename).is_file():
                self.data = open(filename, mode).read()
                self.size = len(self.data)
                self.pos = 0
                self.mode = mode
                self.file = filename
                self.little_endian = isLittleEndian
                self.isGood = True
        else:
            self.file = filename
            self.mode = mode
            self.data = bytearray()
            self.pos = 0
            self.size = 0
            self.little_endian = isLittleEndian
            self.isGood = False

        return None

    # def __del__(self):
    #    self.flush()

    def resize(self, dataSize=0):
        if dataSize &gt; 0:
            self.data = bytearray(dataSize)
        else:
            self.data = bytearray()
        self.pos = 0
        self.size = dataSize
        self.isGood = False
        return None

    def flush(self):
        print("flush")
        print("file:\t%s" % self.file)
        print("isGood:\t%s" % self.isGood)
        print("size:\t%s" % len(self.data))
        if self.file != "" and not self.isGood and len(self.data) &gt; 0:
            self.isGood = True

            s = open(self.file, 'w+b')
            s.write(self.data)
            s.close()

    def read_and_unpack(self, unpack, size):
        '''
          Charactor, Byte-order
          @,         native, native
          =,         native, standard
          &lt;,         little endian
          &gt;,         big endian
          !,         network

          Format, C-type,         Python-type, Size[byte]
          c,      char,           byte,        1
          b,      signed char,    integer,     1
          B,      unsigned char,  integer,     1
          h,      short,          integer,     2
          H,      unsigned short, integer,     2
          i,      int,            integer,     4
          I,      unsigned int,   integer,     4
          f,      float,          float,       4
          d,      double,         float,       8
        '''
        value = 0
        if self.size &gt; 0 and self.pos + size &lt; self.size:
            value = struct.unpack_from(unpack, self.data, self.pos)[0]
            self.pos += size
        return value

    def pack_and_write(self, pack, size, value):
        if self.pos + size &gt; self.size:
            self.data.extend(b'\x00' * ((self.pos + size) - self.size))
            self.size = self.pos + size
        try:
            struct.pack_into(pack, self.data, self.pos, value)
        except:
            print('Pos:\t%i / %i (buf:%i) [val:%i:%i:%s]' % (self.pos, self.size, len(self.data), value, size, pack))
            pass
        self.pos += size
        return None

    def set_pointer(self, offset):
        self.pos = offset
        return None


def fclose(bitStream):
    bitStream.flush()
    bitStream.isGood = False


def fseek(bitStream, offset, dir):
    if dir == 0:
        bitStream.set_pointer(offset)
    elif dir == 1:
        bitStream.set_pointer(bitStream.pos + offset)
    elif dir == 2:
        bitStream.set_pointer(bitStream.pos - offset)
    return None


def ftell(bitStream):
    return bitStream.pos


def readByte(bitStream, isSigned=0):
    fmt = 'b' if isSigned == 0 else 'B'
    return (bitStream.read_and_unpack(fmt, 1))


def readShort(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'h' if isSigned == 0 else 'H'
    return (bitStream.read_and_unpack(fmt, 2))


def readLong(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'i' if isSigned == 0 else 'I'
    return (bitStream.read_and_unpack(fmt, 4))


def readFloat(bitStream):
    fmt = '&gt;f' if not bitStream.little_endian else '&lt;f'
    return (bitStream.read_and_unpack(fmt, 4))

def readString(bitStream, length=0):
    string = ''
    pos = bitStream.pos
    lim = length if length != 0 else bitStream.size - bitStream.pos
    for i in range(0, lim):
        b = bitStream.read_and_unpack('B', 1)
        if b != 0:
            string += chr(b)
        else:
            if length &gt; 0:
                bitStream.set_pointer(pos + length)
            break
    return string

class StandardMaterial:
    data = None
    bsdf = None

    def __init__(self, name="Material"):
        # make material
        self.data = bpy.data.materials.new(name=name)
        self.data.use_nodes = True
        self.data.use_backface_culling = True
        self.bsdf = self.data.node_tree.nodes["Principled BSDF"]
        self.bsdf.label = "Standard"
        return None

    def diffuse(self, colour=(0.0, 0.0, 0.0, 0.0), name="Diffuse"):
        rgbaColor = self.data.node_tree.nodes.new('ShaderNodeRGB')
        rgbaColor.label = name
        rgbaColor.outputs[0].default_value = (colour[0], colour[1], colour[2], colour[3])
        if self.bsdf != None:
            self.data.node_tree.links.new(self.bsdf.inputs['Base Color'], rgbaColor.outputs['Color'])
        return None

    def diffuseMap(self, imageTex=None):
        if imageTex != None and self.bsdf != None:
            self.data.node_tree.links.new(self.bsdf.inputs['Base Color'], imageTex.outputs['Color'])
        return None

    def opacityMap(self, imageTex=None):
        if imageTex != None and self.bsdf != None:
            self.data.blend_method = 'BLEND'
            self.data.shadow_method = 'HASHED'
            self.data.show_transparent_back = False
            self.data.node_tree.links.new(self.bsdf.inputs['Alpha'], imageTex.outputs['Alpha'])
        return None

    def normalMap(self, imageNode=None):
        if imageTex != None and self.bsdf != None:
            imageTex.image.colorspace_settings.name = 'Linear'
            normMap = self.data.node_tree.nodes.new('ShaderNodeNormalMap')
            normMap.label = 'ShaderNodeNormalMap'
            self.data.node_tree.links.new(normMap.inputs['Color'], imageTex.outputs['Color'])
            self.data.node_tree.links.new(self.bsdf.inputs['Normal'], normMap.outputs['Normal'])
        return None

    def specularMap(self, imageNode=None, invert=True):
        if imageTex != None and self.bsdf != None:
            if invert:
                invertRGB = self.data.node_tree.nodes.new('ShaderNodeInvert')
                invertRGB.label = 'ShaderNodeInvert'
                self.data.node_tree.links.new(invertRGB.inputs['Color'], imageTex.outputs['Color'])
                self.data.node_tree.links.new(self.bsdf.inputs['Roughness'], invertRGB.outputs['Color'])
            else:
                self.data.node_tree.links.new(self.bsdf.inputs['Roughness'], imageTex.outputs['Color'])
        return None

def mesh_validate (vertices, faces):
    for fa in faces:
        if fa[0] == fa[1] or fa[1] == fa[2] or fa[2] == fa[0]:
            print ("face conjunctor")
            return True
    for fa in faces:
        for fb in fa:
            if fb &gt; len(vertices) - 1:
                print ("face index out of range")
                return True
    return False
def mesh(vertices=[], faces=[], materialIDs=[], tverts=[], normals=[], colours=[], materials=[], mscale=1.0,
         flipAxis=False, obj_name="Object", lay_name=''):
    #
    # This function is pretty, ugly
    # imports the mesh into blender
    #

    # Clear Any Object Selections
    # for o in bpy.context.selected_objects: o.select = False
    bpy.context.view_layer.objects.active = None
    
    # Get Collection (Layers)
    if lay_name != '':
        # make collection
        layer = bpy.data.collections.new(lay_name)
        bpy.context.scene.collection.children.link(layer)
    else:
        layer = bpy.data.collections[bpy.context.view_layer.active_layer_collection.name]

    # make mesh
    msh = bpy.data.meshes.new('Mesh')

    # msh.name = msh.name.replace(".", "_")

    # Apply vertex scaling
    # mscale *= bpy.context.scene.unit_settings.scale_length
    if len(vertices) &gt; 0:
        vertArray = [[float] * 3] * len(vertices)
        if flipAxis:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    -vertices[v][2] * mscale,
                    vertices[v][1] * mscale
                )
        else:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    vertices[v][1] * mscale,
                    vertices[v][2] * mscale
                )

    # assign data from arrays
    msh.from_pydata(vertArray, [], faces)

    # set surface to smooth
    msh.polygons.foreach_set("use_smooth", [True] * len(msh.polygons))

    # Set Normals
    if len(faces) &gt; 0:
        if len(normals) &gt; 0:
            msh.use_auto_smooth = True
            if len(normals) == (len(faces) * 3):
                msh.normals_split_custom_set(normals)
            else:
                normArray = [[float] * 3] * (len(faces) * 3)
                if flipAxis:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 -normals[faces[i][v]][2],
                                 normals[faces[i][v]][1]]
                            )
                else:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 normals[faces[i][v]][1],
                                 normals[faces[i][v]][2]]
                            )
                msh.normals_split_custom_set(normArray)

        # create texture corrdinates
        #print("tverts ", len(tverts))
        # this is just a hack, i just add all the UVs into the same space &lt;&lt;&lt;
        if len(tverts) &gt; 0:
            uvw = msh.uv_layers.new()
            # if len(tverts) == (len(faces) * 3):
            #    for v in range(0, len(faces) * 3):
            #        msh.uv_layers[uvw.name].data[v].uv = tverts[v]
            # else:
            uvwArray = [[float] * 2] * len(tverts[0])
            for i in range(0, len(tverts[0])):
                uvwArray[i] = [0.0, 0.0]

            for v in range(0, len(tverts[0])):
                for i in range(0, len(tverts)):
                    uvwArray[v][0] += tverts[i][v][0]
                    uvwArray[v][1] += 1.0 - tverts[i][v][1]

            for i in range(0, len(faces)):
                for v in range(0, 3):
                    msh.uv_layers[uvw.name].data[(i * 3) + v].uv = (
                        uvwArray[faces[i][v]][0],
                        uvwArray[faces[i][v]][1]
                    )


    # Create Face Maps?
    # msh.face_maps.new()

    # Update Mesh
    msh.update()

    # Check mesh is Valid
    if mesh_validate(vertices, faces): #msh.validate(verbose=True):
        # Erase Mesh
        print("Mesh Invalid!")

        msh.user_clear()
        bpy.data.meshes.remove(msh)
        return None

    # Assign Mesh to Object
    obj = bpy.data.objects.new(obj_name, msh)
    # obj.name = obj.name.replace(".", "_")

    for i in range(0, len(materials)):

        if len(obj.material_slots) &lt; (i + 1):
            # if there is no slot then we append to create the slot and assign
            obj.data.materials.append(materials[i])
        else:
            # we always want the material in slot[0]
            obj.material_slots[0].material = materials[i]
        # obj.active_material = obj.material_slots[i].material

    for i in range(0, len(materialIDs)):
        obj.data.polygons[i].material_index = materialIDs[i]

    # obj.data.materials.append(material)
    layer.objects.link(obj)

    # Generate a Material
    # img_name = "Test.jpg"  # dummy texture
    # mat_count = len(texmaps)

    # if mat_count == 0 and len(materialIDs) &gt; 0:
    #    for i in range(0, len(materialIDs)):
    #        if (materialIDs[i] + 1) &gt; mat_count: mat_count = materialIDs[i] + 1

    # Assign Material ID's
    bpy.context.view_layer.objects.active = obj
    bpy.ops.object.mode_set(mode='EDIT', toggle=False)
    bpy.context.tool_settings.mesh_select_mode = [False, False, True]

    bpy.ops.object.mode_set(mode='OBJECT')
    # materialIDs

    # Redraw Entire Scene
    # bpy.context.scene.update()

    return obj

class erf_mesh:
    unk101 = 0
    block_size = 0
    unk103 = 0  # hx4B
    unk104 = 0
    vert_count = 0
    face_count1 = 0
    tvert_count = 0
    # need to inspect this
    mat_name = ""
    face_count2 = 0
    norm_count = 0
    vcol_count = 0
    unk105_count = 0
    vert_array = []
    tvert_array = []
    face_array = []
    norm_array = []
    vcol_array = []
    unk105_array = []
    matid_array = []
    mat_names = []
    def read_mesh (self, f= fopen()):
        self.vert_array = []
        self.tvert_array = []
        self.face_array = []
        self.norm_array = []
        self.vcol_array = []
        self.unk105_array = []

        self.unk101 = readLong(f)
        self.block_size = readLong(f) + ftell(f) + 4
        self.unk103 = readLong(f)
        self.unk104 = readByte(f)
        
        vert_idx_off = 0
        tvert_idx_off = 0
        face_idx_off = 0
        norm_idx_off = 0
        vcol_idx_off = 0
        unk105_idx_off = 0
        
        mat_index = 0
        self.mat_names = []
        
        for m in range(0, self.unk104):
            self.face_count1 = readLong(f)
            self.vert_count = readLong(f)
            
            if self.vert_count &gt; 0:
                self.vert_array.extend([[[float] for x in range(3)] for y in range(self.vert_count)])
                for i in range(0, self.vert_count):
                    self.vert_array[i + vert_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            self.tvert_count = readLong(f)
            if self.tvert_count &gt; 0:
                self.tvert_array.extend([[[float] for x in range(2)] for y in range(self.tvert_count)])
                for i in range(0, self.tvert_count):
                    self.tvert_array[i + tvert_idx_off] = [
                        readFloat(f),
                        readFloat(f)
                        ]
            
            fseek(f, 25, seek_cur) # wtf is this
            self.mat_name = readString(f, readLong(f))
            appendIfUnique(self.mat_names, self.mat_name)
            mat_index = findItem(self.mat_names, self.mat_name)
            fseek(f, 5, seek_cur)
            #print("Name:\t%s" % self.mat_name)
            
            self.face_count2 = readLong(f)
            if self.face_count2 &gt; 0:
                self.face_array.extend([[[int] for x in range(3)] for y in range(int(self.face_count2 / 3))])
                self.matid_array.extend([[int] for y in range(int(self.face_count2 / 3))])
                for i in range(0, int(self.face_count2 / 3)):
                    self.matid_array[i + face_idx_off] = mat_index
                    self.face_array[i + face_idx_off] = [
                        readByte(f, unsigned) + vert_idx_off,
                        readByte(f, unsigned) + vert_idx_off,
                        readByte(f, unsigned) + vert_idx_off
                        ]
            
            self.norm_count = readLong(f)
            if self.norm_count &gt; 0:
                self.norm_array.extend([[[float] for x in range(4)] for y in range(self.norm_count)])
                for i in range(0, self.norm_count):
                    self.norm_array[i + norm_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            self.vcol_count = readLong(f)
            if self.vcol_count &gt; 0:
                print ("Inspect this")
            
            self.unk105_count = readLong(f)
            if self.unk105_count &gt; 0:
                self.unk105_array.extend([[[float] for x in range(3)] for y in range(self.unk105_count)])
                for i in range(0, self.unk105_count):
                    self.unk105_array[i + unk105_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            vert_idx_off += self.vert_count
            tvert_idx_off += self.tvert_count
            face_idx_off += int(self.face_count2 / 3)
            norm_idx_off += self.norm_count
            vcol_idx_off += self.vcol_count
            unk105_idx_off += self.unk105_count
        
        fseek(f, self.block_size, seek_set)

class erf_file:
    filedid = 0     # ERF#
    unk001 = 0      # hx0E
    unk002 = 0      # hx90
    unk003 = 0      # hx09
    unk004 = [0.0, 0.0, 0.0, 0.0]
    mesh_count = 0
    unk005 = 0
    unk006 = 0      # hx12
    unk007 = 0      # hx00
    meshes = []
    
    def read_erf (self, f = fopen()):
        
        self.filedid = readLong(f)
        
        isCockpit = False
        
        if self.filedid != 0x45524623:
            print ("Unsupported File Type")
            return False # (ERF#)
        
        self.unk001 = readLong(f)
        self.unk002 = readLong(f)
        self.unk003 = readLong(f)
        self.unk004 = [readFloat(f), readFloat(f), readFloat(f), readFloat(f)]
        self.mesh_count = readShort(f)
        
        if self.mesh_count == 21027:
            self.mesh_count = 1
            fseek(f, -2, seek_cur)
            isCockpit = True
            
        self.unk005 = readLong(f)
        self.unk006 = readLong(f)
        self.unk007 = readLong(f)
        
        if self.mesh_count &gt; 0:
            self.meshes = [erf_mesh] * self.mesh_count
            for i in range(0, self.mesh_count):
                if isCockpit: fseek(f, -8, seek_cur)
                self.meshes[i] = erf_mesh()
                self.meshes[i].read_mesh(f)
                
        return True

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None

def read (file, impLOD = False):
    if not doesFileExist(file): return False
    
    #deleteScene(['MESH', 'ARMATURE'])  # Clear Scene
    
    f = fopen(file, 'rb')
    
    erf = erf_file()
    erf.read_erf(f)
    
    
    d = dummy(position=(erf.unk004[0],erf.unk004[1], erf.unk004[2]))
    d.object.empty_display_size = erf.unk004[3]
    d.object.empty_display_type = 'SPHERE'
    
    
    #
    mat_lib_names = []
    for i in range(0, erf.mesh_count):
        for mn in erf.meshes[i].mat_names:
            appendIfUnique(mat_lib_names, mn)
    
    mat_lib = []
    mat = None
    for i in range(0, len(mat_lib_names)):
        mat = StandardMaterial(name=mat_lib_names[i])
        mat.diffuse(rancol4())
        mat_lib.append(mat.data)
        
    
    for i in range(0, erf.mesh_count):
        msh = mesh(
            obj_name=getFilenameFile(file),
            vertices=erf.meshes[i].vert_array,
            faces=erf.meshes[i].face_array,
            tverts=[erf.meshes[i].tvert_array],
            normals=erf.meshes[i].unk105_array,
            materialIDs=erf.meshes[i].matid_array,
            materials=mat_lib,
            flipAxis=True
            )
        if msh != None:
            msh.location = (-erf.unk004[0], erf.unk004[2], -erf.unk004[1])
            msh.parent = d.object
        if not impLOD: break
    
    
    fclose(f)
    return True


# ====================================================================================
# BLENDER API FUNCTIONS
# ====================================================================================
# These are functions or wrappers specific with dealing with blenders API
# ====================================================================================
#

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None


# Callback when file(s) are selected
def mechwarrioriv_imp_callback(fpath="", files=[], clearScene=True, impLOD=False):
    if len(files) &gt; 0 and clearScene: deleteScene(['MESH', 'ARMATURE', 'EMPTY'])
    for file in files:
        read(fpath + file.name, impLOD)
    if len(files) &gt; 0:
        messageBox("Done!")
        return True
    else:
        return False


# Wrapper that Invokes FileSelector to open files from blender
def mechwarrioriv_imp(reload=False):
    # Un-Register Operator
    if reload and hasattr(bpy.types, "IMPORTHELPER_OT_mechwarrioriv_imp"):  # print(bpy.ops.importhelper.mechwarrioriv_imp.idname())

        try:
            bpy.types.TOPBAR_MT_file_import.remove(
                bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp').menu_func_import)
        except:
            print("Failed to Unregister2")

        try:
            bpy.utils.unregister_class(bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp'))
        except:
            print("Failed to Unregister1")

    # Define Operator
    class ImportHelper_mechwarrioriv_imp(bpy.types.Operator):

        # Operator Path
        bl_idname = "importhelper.mechwarrioriv_imp"
        bl_label = "Select File"

        # Operator Properties
        # filter_glob: bpy.props.StringProperty(default='*.jpg;*.jpeg;*.png;*.tif;*.tiff;*.bmp', options={'HIDDEN'})
        filter_glob: bpy.props.StringProperty(default='*.erf', options={'HIDDEN'}, subtype='FILE_PATH')

        # Variables
        filepath: bpy.props.StringProperty(subtype="FILE_PATH")  # full path of selected item (path+filename)
        filename: bpy.props.StringProperty(subtype="FILE_NAME")  # name of selected item
        directory: bpy.props.StringProperty(subtype="FILE_PATH")  # directory of the selected item
        files: bpy.props.CollectionProperty(
            type=bpy.types.OperatorFileListElement)  # a collection containing all the selected items�f filenames

        # Controls
        my_int1: bpy.props.IntProperty(name="Some Integer", description="Tooltip")
        my_float1: bpy.props.FloatProperty(name="Scale", default=1.0, description="Changes Scale of the imported Mesh")
        # my_float2: bpy.props.FloatProperty(name="Some Float point", default = 0.25, min = -0.25, max = 0.5)
        my_bool1: bpy.props.BoolProperty(name="Clear Scene", default=True,
                                         description="Deletes everything in the scene prior to importing")
        my_bool2: bpy.props.BoolProperty(name="LOD Meshes", default=False, description="Imports Lower Res Meshes")
        my_bool3: bpy.props.BoolProperty(name="Vertex Weights", default=False, description="Builds Vertex Groups")
        my_bool4: bpy.props.BoolProperty(name="Vertex Normals", default=False, description="Applies Custom Normals")
        my_bool5: bpy.props.BoolProperty(name="Vertex Colours", default=False, description="Builds Vertex Colours")
        my_bool6: bpy.props.BoolProperty(name="Guess Parents", default=False,
                                         description="Uses algorithm to Guess Bone Parenting")
        my_bool7: bpy.props.BoolProperty(name="Dump Textures", default=False,
                                         description="Writes Textures from a file pair '_tex.bin'")
        my_string1: bpy.props.StringProperty(name="", default="Armature",
                                             description="Name of Armature to Import Bones to")
        my_dropdown1: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )
        my_dropdown2: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )

        # Runs when this class OPENS
        def invoke(self, context, event):

            # Retrieve Settings
            try:
                self.filepath = bpy.types.Scene.mechwarrioriv_imp_filepath
            except:
                bpy.types.Scene.mechwarrioriv_imp_filepath = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.directory = bpy.types.Scene.mechwarrioriv_imp_directory
            except:
                bpy.types.Scene.mechwarrioriv_imp_directory = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.my_float1 = bpy.types.Scene.mechwarrioriv_imp_my_float1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_float1 = bpy.props.FloatProperty(default=1.0)

            try:
                self.my_bool1 = bpy.types.Scene.mechwarrioriv_imp_my_bool1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool1 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool2 = bpy.types.Scene.mechwarrioriv_imp_my_bool2
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool2 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool3 = bpy.types.Scene.mechwarrioriv_imp_my_bool3
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool3 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool4 = bpy.types.Scene.mechwarrioriv_imp_my_bool4
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool4 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool5 = bpy.types.Scene.mechwarrioriv_imp_my_bool5
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool5 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool6 = bpy.types.Scene.mechwarrioriv_imp_my_bool6
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool6 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool7 = bpy.types.Scene.mechwarrioriv_imp_my_bool7
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool7 = bpy.props.BoolProperty(default=False)

            try:
                self.my_string1 = bpy.types.Scene.my_string1
            except:
                bpy.types.Scene.my_string1 = bpy.props.BoolProperty(default=False)

            # Open File Browser
            # Set Properties of the File Browser
            context.window_manager.fileselect_add(self)
            context.area.tag_redraw()

            return {'RUNNING_MODAL'}

        # Runs when this Window is CANCELLED
        def cancel(self, context):
            print("run bitch")

        # Runs when the class EXITS
        def execute(self, context):

            # Save Settings
            bpy.types.Scene.mechwarrioriv_imp_filepath = self.filepath
            bpy.types.Scene.mechwarrioriv_imp_directory = self.directory
            #bpy.types.Scene.mechwarrioriv_imp_my_float1 = self.my_float1
            bpy.types.Scene.mechwarrioriv_imp_my_bool1 = self.my_bool1
            bpy.types.Scene.mechwarrioriv_imp_my_bool2 = self.my_bool2
            #bpy.types.Scene.mechwarrioriv_imp_my_bool3 = self.my_bool3
            #bpy.types.Scene.mechwarrioriv_imp_my_bool4 = self.my_bool4
            #bpy.types.Scene.mechwarrioriv_imp_my_bool5 = self.my_bool5
            #bpy.types.Scene.mechwarrioriv_imp_my_bool6 = self.my_bool6
            #bpy.types.Scene.mechwarrioriv_imp_my_bool7 = self.my_bool7
            bpy.types.Scene.mechwarrioriv_imp_my_string1 = self.my_string1

            # Run Callback
            mechwarrioriv_imp_callback(
                self.directory + "\\",
                self.files,
                self.my_bool1,
                self.my_bool2
                )

            return {"FINISHED"}

            # Window Settings

        def draw(self, context):

            # Set Properties of the File Browser
            # context.space_data.params.use_filter = True
            # context.space_data.params.use_filter_folder=True #to not see folders

            # Configure Layout
            # self.layout.use_property_split = True       # To Enable Align
            # self.layout.use_property_decorate = False   # No animation.

            self.layout.row().label(text="Import Settings")

            self.layout.separator()
            self.layout.row().prop(self, "my_bool1")
            self.layout.row().prop(self, "my_bool2")
            #self.layout.row().prop(self, "my_float1")

            #box = self.layout.box()
            #box.label(text="Include")
            #box.prop(self, "my_bool2")
            #box.prop(self, "my_bool3")
            #box.prop(self, "my_bool4")
            #box.prop(self, "my_bool5")

            #box = self.layout.box()
            #box.label(text="Misc")
            #box.prop(self, "my_bool6")
            #box.prop(self, "my_bool7")
            #box.label(text="Import Bones To:")
            #box.prop(self, "my_string1")

            self.layout.separator()

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="  Author:", icon='QUESTION')
            col.alignment = 'LEFT'
            col.label(text="mariokart64n")

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="Release:", icon='GRIP')
            col.alignment = 'LEFT'
            col.label(text="March 12, 2021")

        def menu_func_import(self, context):
            self.layout.operator(
                "importhelper.mechwarrioriv_imp",
                text="MechWarrior 4: Vengeance (*.erf)"
                )

    # Register Operator
    bpy.utils.register_class(ImportHelper_mechwarrioriv_imp)
    bpy.types.TOPBAR_MT_file_import.append(ImportHelper_mechwarrioriv_imp.menu_func_import)

    # Assign Shortcut key
    # bpy.context.window_manager.keyconfigs.active.keymaps["Window"].keymap_items.new('bpy.ops.text.run_script()', 'E', 'PRESS', ctrl=True, shift=False, repeat=False)

    # Call ImportHelper
    bpy.ops.importhelper.mechwarrioriv_imp('INVOKE_DEFAULT')




clearListener()  # clears out console
if not useOpenDialog:

    deleteScene(['MESH', 'ARMATURE', 'EMPTY'])  # Clear Scene
    read(
        ""
        )
    messageBox("Done!")
else:
    mechwarrioriv_imp(True)
</code></pre></div></div>

			
			
									
						<div id='list_thanks172201'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/531.html" class="username">mariokart64n</a> for the post: </dt>
			<dd><span title="Fri Mar 12, 2021 6:18 pm"><a href="../Users/97263.html" class="username">OPR23b</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput172201'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

							<div id="sig172201" class="signature">Maxscript and other finished work I've done can be found on my <a href="https://www.deviantart.com/mariokart64n" class="postlink">DeviantArt</a> account</div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172202" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172202">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172202" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172202">

					<h3 >
						<a href="./viewtopic.php?p=172202#p172202">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172202/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172202" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172202' href="./viewtopic.php?f=16&amp;p=172202&amp;thanks=172202&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172202#p172202" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-12T17:14:52+00:00">Fri Mar 12, 2021 6:14 pm</time>
			</p>
			
			
			
			<div class="content">As always, big thanks for the help mariokart.<br>
<br>
I really have to say that you've helped a lot with this file format, and while I can't really give anything in return, I can at least give thanks.</div>

			
			
									
						<div id='list_thanks172202'>
</div>
<div id='div_post_reput172202'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172204" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172204">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172204" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172204">

					<h3 >
						<a href="./viewtopic.php?p=172204#p172204">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172204/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172204" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172204' href="./viewtopic.php?f=16&amp;p=172204&amp;thanks=172204&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172204#p172204" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-12T17:31:24+00:00">Fri Mar 12, 2021 6:31 pm</time>
			</p>
			
			
			
			<div class="content">There seems to be a problem with the new script<br>
<br>
It isn't able to import any of the normal mech files (bodyparts and whatnot), only their cockpits.</div>

			
			
									
						<div id='list_thanks172204'>
</div>
<div id='div_post_reput172204'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172205" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile172205">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/531.html" class="username">mariokart64n</a>							</dt>

						<dd class="profile-rank">ultra-veteran<br /><img src="./images/ranks/vip-1.png" alt="ultra-veteran" title="ultra-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=531&amp;sr=posts">586</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jun 05, 2005 12:00 pm</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Ontario, Canada</dd>
							    <dd class="profile-posts" data-user-give-id="531"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/true">36 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="531"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/531/false">243 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact mariokart64n">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact mariokart64n</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172205" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172205">

					<h3 >
						<a href="./viewtopic.php?p=172205#p172205">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172205/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172205" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172205' href="./viewtopic.php?f=16&amp;p=172205&amp;thanks=172205&amp;to_id=531&amp;from_id=123876" title="Say Thanks to the author of the post: mariokart64n"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172205#p172205" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/531.html" class="username">mariokart64n</a></strong> &raquo; </span><time datetime="2021-03-12T17:55:48+00:00">Fri Mar 12, 2021 6:55 pm</time>
			</p>
			
			
			
			<div class="content"><div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>""" ======================================================================

    Python Code:    [PC] MechWarrior 4: Vengeance (for Blender 2.92.0)
    Author:         mariokart64n
    Date:           March 11, 2021
    Version:        0.2

    Description:
        Imports erf Mesh files into blender, for more info see post
        
        https://forum.xentax.com/viewtopic.php?f=16&amp;t=23560
        
    ======================================================================

    ChangeLog:

    2021-03-11
        Script Wrote
        Fixed a crashed by incorrectly reading data that comes after the
        texture vertex data
    
    2021-03-12
        Corrected to read sub meshes
        Corrected Method for dimensioning Multi-Dimensional Arrays
        Added Toggle to import LOD Meshes
        Flipped the Y - Z Axis
        Patch for cockpits
        By passed mesh validation which was causing issues
        MaterialIds are added to submeshes to be able to seperate them
        Fixed a bugged caused by an array not being initialized
        

    ====================================================================== """


import bpy
from pathlib import Path  # Needed for os stuff
import random
import struct  # Needed for Binary Reader
import math

useOpenDialog = True

# ====================================================================================
# MAXCSRIPT FUNCTIONS
# ====================================================================================
# These function are written to mimic native functions in
# maxscript. This is to make porting my old maxscripts
# easier, so alot of these functions may be redundant..
# ====================================================================================
#

signed, unsigned = 0, 1  # Enums for read function
seek_set, seek_cur, seek_end = 0, 1, 2  # Enums for seek function
SEEK_ABS, SEEK_REL, SEEK_END = 0, 1, 2  # Enums for seek function

def rancol4():
    return (random.uniform(0.0, 1.0), random.uniform(0.0, 1.0), random.uniform(0.0, 1.0), 1.0)

class dummy:
    object = None

    def __init__(self, position = (0.0, 0.0, 0.0)):
        self.object = bpy.data.objects.new("Empty", None )
        bpy.context.scene.collection.objects.link(self.object)
        self.object.empty_display_size = 1
        self.object.empty_display_type = 'CUBE'
        self.object.location = position
        
    def position(self, pos=(0.0, 0.0, 0.0)):
        if self.object != None: self.object.location = pos

    def name(self, name=""):
        if self.object != None and name != "": self.object.name = name

    def showLinks(self, enable=False):
        return enable

    def showLinksOnly(self, enable=False):
        return enable


def messageBox(message="", title="Message Box", icon='INFO'):
    def draw(self, context): self.layout.label(text=message)

    bpy.context.window_manager.popup_menu(draw, title=title, icon=icon)
    return None


def doesFileExist(filename):
    file = Path(filename)
    if file.is_file():
        return True
    elif file.is_dir():
        return True
    else:
        return False


def clearListener(len=64):
    for i in range(0, len): print('')


def getFilenameFile(file):  # returns: "myImage"
    return Path(file).stem


def findItem(array, value):
    index = -1
    try:
        index = array.index(value)
    except:
        pass
    return index


def append(array, value):
    array.append(value)
    return None


def appendIfUnique(array, value):
    try:
        array.index(value)
    except:
        array.append(value)
    return None


class fopen:
    little_endian = True
    file = ""
    mode = 'rb'
    data = bytearray()
    size = 0
    pos = 0
    isGood = False

    def __init__(self, filename=None, mode='rb', isLittleEndian=True):
        if mode == 'rb':
            if filename != None and Path(filename).is_file():
                self.data = open(filename, mode).read()
                self.size = len(self.data)
                self.pos = 0
                self.mode = mode
                self.file = filename
                self.little_endian = isLittleEndian
                self.isGood = True
        else:
            self.file = filename
            self.mode = mode
            self.data = bytearray()
            self.pos = 0
            self.size = 0
            self.little_endian = isLittleEndian
            self.isGood = False

        return None

    # def __del__(self):
    #    self.flush()

    def resize(self, dataSize=0):
        if dataSize &gt; 0:
            self.data = bytearray(dataSize)
        else:
            self.data = bytearray()
        self.pos = 0
        self.size = dataSize
        self.isGood = False
        return None

    def flush(self):
        print("flush")
        print("file:\t%s" % self.file)
        print("isGood:\t%s" % self.isGood)
        print("size:\t%s" % len(self.data))
        if self.file != "" and not self.isGood and len(self.data) &gt; 0:
            self.isGood = True

            s = open(self.file, 'w+b')
            s.write(self.data)
            s.close()

    def read_and_unpack(self, unpack, size):
        '''
          Charactor, Byte-order
          @,         native, native
          =,         native, standard
          &lt;,         little endian
          &gt;,         big endian
          !,         network

          Format, C-type,         Python-type, Size[byte]
          c,      char,           byte,        1
          b,      signed char,    integer,     1
          B,      unsigned char,  integer,     1
          h,      short,          integer,     2
          H,      unsigned short, integer,     2
          i,      int,            integer,     4
          I,      unsigned int,   integer,     4
          f,      float,          float,       4
          d,      double,         float,       8
        '''
        value = 0
        if self.size &gt; 0 and self.pos + size &lt; self.size:
            value = struct.unpack_from(unpack, self.data, self.pos)[0]
            self.pos += size
        return value

    def pack_and_write(self, pack, size, value):
        if self.pos + size &gt; self.size:
            self.data.extend(b'\x00' * ((self.pos + size) - self.size))
            self.size = self.pos + size
        try:
            struct.pack_into(pack, self.data, self.pos, value)
        except:
            print('Pos:\t%i / %i (buf:%i) [val:%i:%i:%s]' % (self.pos, self.size, len(self.data), value, size, pack))
            pass
        self.pos += size
        return None

    def set_pointer(self, offset):
        self.pos = offset
        return None


def fclose(bitStream):
    bitStream.flush()
    bitStream.isGood = False


def fseek(bitStream, offset, dir):
    if dir == 0:
        bitStream.set_pointer(offset)
    elif dir == 1:
        bitStream.set_pointer(bitStream.pos + offset)
    elif dir == 2:
        bitStream.set_pointer(bitStream.pos - offset)
    return None


def ftell(bitStream):
    return bitStream.pos


def readByte(bitStream, isSigned=0):
    fmt = 'b' if isSigned == 0 else 'B'
    return (bitStream.read_and_unpack(fmt, 1))


def readShort(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'h' if isSigned == 0 else 'H'
    return (bitStream.read_and_unpack(fmt, 2))


def readLong(bitStream, isSigned=0):
    fmt = '&gt;' if not bitStream.little_endian else '&lt;'
    fmt += 'i' if isSigned == 0 else 'I'
    return (bitStream.read_and_unpack(fmt, 4))


def readFloat(bitStream):
    fmt = '&gt;f' if not bitStream.little_endian else '&lt;f'
    return (bitStream.read_and_unpack(fmt, 4))

def readString(bitStream, length=0):
    string = ''
    pos = bitStream.pos
    lim = length if length != 0 else bitStream.size - bitStream.pos
    for i in range(0, lim):
        b = bitStream.read_and_unpack('B', 1)
        if b != 0:
            string += chr(b)
        else:
            if length &gt; 0:
                bitStream.set_pointer(pos + length)
            break
    return string

class StandardMaterial:
    data = None
    bsdf = None

    def __init__(self, name="Material"):
        # make material
        self.data = bpy.data.materials.new(name=name)
        self.data.use_nodes = True
        self.data.use_backface_culling = True
        self.bsdf = self.data.node_tree.nodes["Principled BSDF"]
        self.bsdf.label = "Standard"
        return None

    def diffuse(self, colour=(0.0, 0.0, 0.0, 0.0), name="Diffuse"):
        rgbaColor = self.data.node_tree.nodes.new('ShaderNodeRGB')
        rgbaColor.label = name
        rgbaColor.outputs[0].default_value = (colour[0], colour[1], colour[2], colour[3])
        if self.bsdf != None:
            self.data.node_tree.links.new(self.bsdf.inputs['Base Color'], rgbaColor.outputs['Color'])
        return None

    def diffuseMap(self, imageTex=None):
        if imageTex != None and self.bsdf != None:
            self.data.node_tree.links.new(self.bsdf.inputs['Base Color'], imageTex.outputs['Color'])
        return None

    def opacityMap(self, imageTex=None):
        if imageTex != None and self.bsdf != None:
            self.data.blend_method = 'BLEND'
            self.data.shadow_method = 'HASHED'
            self.data.show_transparent_back = False
            self.data.node_tree.links.new(self.bsdf.inputs['Alpha'], imageTex.outputs['Alpha'])
        return None

    def normalMap(self, imageNode=None):
        if imageTex != None and self.bsdf != None:
            imageTex.image.colorspace_settings.name = 'Linear'
            normMap = self.data.node_tree.nodes.new('ShaderNodeNormalMap')
            normMap.label = 'ShaderNodeNormalMap'
            self.data.node_tree.links.new(normMap.inputs['Color'], imageTex.outputs['Color'])
            self.data.node_tree.links.new(self.bsdf.inputs['Normal'], normMap.outputs['Normal'])
        return None

    def specularMap(self, imageNode=None, invert=True):
        if imageTex != None and self.bsdf != None:
            if invert:
                invertRGB = self.data.node_tree.nodes.new('ShaderNodeInvert')
                invertRGB.label = 'ShaderNodeInvert'
                self.data.node_tree.links.new(invertRGB.inputs['Color'], imageTex.outputs['Color'])
                self.data.node_tree.links.new(self.bsdf.inputs['Roughness'], invertRGB.outputs['Color'])
            else:
                self.data.node_tree.links.new(self.bsdf.inputs['Roughness'], imageTex.outputs['Color'])
        return None

def mesh_validate (vertices, faces):
    for fa in faces:
        if fa[0] == fa[1] or fa[1] == fa[2] or fa[2] == fa[0]:
            print ("face conjunctor")
            return True
    for fa in faces:
        for fb in fa:
            if fb &gt; len(vertices) - 1:
                print ("face index out of range")
                return True
    return False
def mesh(vertices=[], faces=[], materialIDs=[], tverts=[], normals=[], colours=[], materials=[], mscale=1.0,
         flipAxis=False, obj_name="Object", lay_name=''):
    #
    # This function is pretty, ugly
    # imports the mesh into blender
    #

    # Clear Any Object Selections
    # for o in bpy.context.selected_objects: o.select = False
    bpy.context.view_layer.objects.active = None
    
    # Get Collection (Layers)
    if lay_name != '':
        # make collection
        layer = bpy.data.collections.new(lay_name)
        bpy.context.scene.collection.children.link(layer)
    else:
        layer = bpy.data.collections[bpy.context.view_layer.active_layer_collection.name]

    # make mesh
    msh = bpy.data.meshes.new('Mesh')

    # msh.name = msh.name.replace(".", "_")

    # Apply vertex scaling
    # mscale *= bpy.context.scene.unit_settings.scale_length
    if len(vertices) &gt; 0:
        vertArray = [[float] * 3] * len(vertices)
        if flipAxis:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    -vertices[v][2] * mscale,
                    vertices[v][1] * mscale
                )
        else:
            for v in range(0, len(vertices)):
                vertArray[v] = (
                    vertices[v][0] * mscale,
                    vertices[v][1] * mscale,
                    vertices[v][2] * mscale
                )

    # assign data from arrays
    msh.from_pydata(vertArray, [], faces)

    # set surface to smooth
    msh.polygons.foreach_set("use_smooth", [True] * len(msh.polygons))

    # Set Normals
    if len(faces) &gt; 0:
        if len(normals) &gt; 0:
            msh.use_auto_smooth = True
            if len(normals) == (len(faces) * 3):
                msh.normals_split_custom_set(normals)
            else:
                normArray = [[float] * 3] * (len(faces) * 3)
                if flipAxis:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 -normals[faces[i][v]][2],
                                 normals[faces[i][v]][1]]
                            )
                else:
                    for i in range(0, len(faces)):
                        for v in range(0, 3):
                            normArray[(i * 3) + v] = (
                                [normals[faces[i][v]][0],
                                 normals[faces[i][v]][1],
                                 normals[faces[i][v]][2]]
                            )
                msh.normals_split_custom_set(normArray)

        # create texture corrdinates
        #print("tverts ", len(tverts))
        # this is just a hack, i just add all the UVs into the same space &lt;&lt;&lt;
        if len(tverts) &gt; 0:
            uvw = msh.uv_layers.new()
            # if len(tverts) == (len(faces) * 3):
            #    for v in range(0, len(faces) * 3):
            #        msh.uv_layers[uvw.name].data[v].uv = tverts[v]
            # else:
            uvwArray = [[float] * 2] * len(tverts[0])
            for i in range(0, len(tverts[0])):
                uvwArray[i] = [0.0, 0.0]

            for v in range(0, len(tverts[0])):
                for i in range(0, len(tverts)):
                    uvwArray[v][0] += tverts[i][v][0]
                    uvwArray[v][1] += 1.0 - tverts[i][v][1]

            for i in range(0, len(faces)):
                for v in range(0, 3):
                    msh.uv_layers[uvw.name].data[(i * 3) + v].uv = (
                        uvwArray[faces[i][v]][0],
                        uvwArray[faces[i][v]][1]
                    )


    # Create Face Maps?
    # msh.face_maps.new()

    # Update Mesh
    msh.update()

    # Check mesh is Valid
    if mesh_validate(vertices, faces): #msh.validate(verbose=True):
        # Erase Mesh
        print("Mesh Invalid!")

        msh.user_clear()
        bpy.data.meshes.remove(msh)
        return None

    # Assign Mesh to Object
    obj = bpy.data.objects.new(obj_name, msh)
    # obj.name = obj.name.replace(".", "_")

    for i in range(0, len(materials)):

        if len(obj.material_slots) &lt; (i + 1):
            # if there is no slot then we append to create the slot and assign
            obj.data.materials.append(materials[i])
        else:
            # we always want the material in slot[0]
            obj.material_slots[0].material = materials[i]
        # obj.active_material = obj.material_slots[i].material
    
    if len(faces) &gt; 0 and len(faces) == len(materialIDs):
        for i in range(0, len(materialIDs)):
            obj.data.polygons[i].material_index = materialIDs[i]
    elif len(materialIDs) &gt; 0:
        print("Supplied Mat Ids to not Match faces:\t%i / %i" % (len(faces), len(materialIDs)))

    # obj.data.materials.append(material)
    layer.objects.link(obj)

    # Generate a Material
    # img_name = "Test.jpg"  # dummy texture
    # mat_count = len(texmaps)

    # if mat_count == 0 and len(materialIDs) &gt; 0:
    #    for i in range(0, len(materialIDs)):
    #        if (materialIDs[i] + 1) &gt; mat_count: mat_count = materialIDs[i] + 1

    # Assign Material ID's
    bpy.context.view_layer.objects.active = obj
    bpy.ops.object.mode_set(mode='EDIT', toggle=False)
    bpy.context.tool_settings.mesh_select_mode = [False, False, True]

    bpy.ops.object.mode_set(mode='OBJECT')
    # materialIDs

    # Redraw Entire Scene
    # bpy.context.scene.update()

    return obj

class erf_mesh:
    unk101 = 0
    block_size = 0
    unk103 = 0  # hx4B
    unk104 = 0
    vert_count = 0
    face_count1 = 0
    tvert_count = 0
    # need to inspect this
    mat_name = ""
    face_count2 = 0
    norm_count = 0
    vcol_count = 0
    unk105_count = 0
    vert_array = []
    tvert_array = []
    face_array = []
    norm_array = []
    vcol_array = []
    unk105_array = []
    matid_array = []
    mat_names = []
    def read_mesh (self, f= fopen()):
        self.vert_array = []
        self.tvert_array = []
        self.face_array = []
        self.norm_array = []
        self.vcol_array = []
        self.unk105_array = []
        self.matid_array = []

        self.unk101 = readLong(f)
        self.block_size = readLong(f) + ftell(f) + 4
        self.unk103 = readLong(f)
        self.unk104 = readByte(f)
        
        vert_idx_off = 0
        tvert_idx_off = 0
        face_idx_off = 0
        norm_idx_off = 0
        vcol_idx_off = 0
        unk105_idx_off = 0
        
        mat_index = 0
        self.mat_names = []
        
        for m in range(0, self.unk104):
            self.face_count1 = readLong(f)
            self.vert_count = readLong(f)
            
            if self.vert_count &gt; 0:
                self.vert_array.extend([[[float] for x in range(3)] for y in range(self.vert_count)])
                for i in range(0, self.vert_count):
                    self.vert_array[i + vert_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            self.tvert_count = readLong(f)
            if self.tvert_count &gt; 0:
                self.tvert_array.extend([[[float] for x in range(2)] for y in range(self.tvert_count)])
                for i in range(0, self.tvert_count):
                    self.tvert_array[i + tvert_idx_off] = [
                        readFloat(f),
                        readFloat(f)
                        ]
            
            fseek(f, 25, seek_cur) # wtf is this
            self.mat_name = readString(f, readLong(f))
            appendIfUnique(self.mat_names, self.mat_name)
            mat_index = findItem(self.mat_names, self.mat_name)
            fseek(f, 5, seek_cur)
            #print("Name:\t%s" % self.mat_name)
            
            self.face_count2 = readLong(f)
            if self.face_count2 &gt; 0:
                self.face_array.extend([[[int] for x in range(3)] for y in range(int(self.face_count2 / 3))])
                self.matid_array.extend([[int] for y in range(int(self.face_count2 / 3))])
                for i in range(0, int(self.face_count2 / 3)):
                    self.matid_array[i + face_idx_off] = mat_index
                    self.face_array[i + face_idx_off] = [
                        readByte(f, unsigned) + vert_idx_off,
                        readByte(f, unsigned) + vert_idx_off,
                        readByte(f, unsigned) + vert_idx_off
                        ]
            
            self.norm_count = readLong(f)
            if self.norm_count &gt; 0:
                self.norm_array.extend([[[float] for x in range(4)] for y in range(self.norm_count)])
                for i in range(0, self.norm_count):
                    self.norm_array[i + norm_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            self.vcol_count = readLong(f)
            if self.vcol_count &gt; 0:
                print ("Inspect this")
            
            self.unk105_count = readLong(f)
            if self.unk105_count &gt; 0:
                self.unk105_array.extend([[[float] for x in range(3)] for y in range(self.unk105_count)])
                for i in range(0, self.unk105_count):
                    self.unk105_array[i + unk105_idx_off] = [
                        readFloat(f),
                        readFloat(f),
                        readFloat(f)
                        ]
            
            vert_idx_off += self.vert_count
            tvert_idx_off += self.tvert_count
            face_idx_off += int(self.face_count2 / 3)
            norm_idx_off += self.norm_count
            vcol_idx_off += self.vcol_count
            unk105_idx_off += self.unk105_count
        
        fseek(f, self.block_size, seek_set)

class erf_file:
    filedid = 0     # ERF#
    unk001 = 0      # hx0E
    unk002 = 0      # hx90
    unk003 = 0      # hx09
    unk004 = [0.0, 0.0, 0.0, 0.0]
    mesh_count = 0
    unk005 = 0
    unk006 = 0      # hx12
    unk007 = 0      # hx00
    meshes = []
    
    def read_erf (self, f = fopen()):
        
        self.filedid = readLong(f)
        
        isCockpit = False
        
        if self.filedid != 0x45524623:
            print ("Unsupported File Type")
            return False # (ERF#)
        
        self.unk001 = readLong(f)
        self.unk002 = readLong(f)
        self.unk003 = readLong(f)
        self.unk004 = [readFloat(f), readFloat(f), readFloat(f), readFloat(f)]
        self.mesh_count = readShort(f)
        
        if self.mesh_count == 21027:
            self.mesh_count = 1
            fseek(f, -2, seek_cur)
            isCockpit = True
            
        self.unk005 = readLong(f)
        self.unk006 = readLong(f)
        self.unk007 = readLong(f)
        
        if self.mesh_count &gt; 0:
            self.meshes = [erf_mesh] * self.mesh_count
            for i in range(0, self.mesh_count):
                if isCockpit: fseek(f, -8, seek_cur)
                self.meshes[i] = erf_mesh()
                self.meshes[i].read_mesh(f)
                
        return True

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None

def read (file, impLOD = False):
    if not doesFileExist(file): return False
    
    #deleteScene(['MESH', 'ARMATURE'])  # Clear Scene
    
    f = fopen(file, 'rb')
    
    erf = erf_file()
    erf.read_erf(f)
    
    
    d = dummy(position=(erf.unk004[0],erf.unk004[1], erf.unk004[2]))
    d.object.empty_display_size = erf.unk004[3]
    d.object.empty_display_type = 'SPHERE'
    
    
    #
    mat_lib_names = []
    for i in range(0, erf.mesh_count):
        for mn in erf.meshes[i].mat_names:
            appendIfUnique(mat_lib_names, mn)
    
    mat_lib = []
    mat = None
    for i in range(0, len(mat_lib_names)):
        mat = StandardMaterial(name=mat_lib_names[i])
        mat.diffuse(rancol4())
        mat_lib.append(mat.data)
        
    
    for i in range(0, erf.mesh_count):
        msh = mesh(
            obj_name=getFilenameFile(file),
            vertices=erf.meshes[i].vert_array,
            faces=erf.meshes[i].face_array,
            tverts=[erf.meshes[i].tvert_array],
            normals=erf.meshes[i].unk105_array,
            materialIDs=erf.meshes[i].matid_array,
            materials=mat_lib,
            flipAxis=True
            )
        if msh != None:
            msh.location = (-erf.unk004[0], erf.unk004[2], -erf.unk004[1])
            msh.parent = d.object
        if not impLOD: break
    
    
    fclose(f)
    return True


# ====================================================================================
# BLENDER API FUNCTIONS
# ====================================================================================
# These are functions or wrappers specific with dealing with blenders API
# ====================================================================================
#

def deleteScene(include=[]):
    if len(include) &gt; 0:
        # Exit and Interactions
        if bpy.context.view_layer.objects.active != None:
            bpy.ops.object.mode_set(mode='OBJECT')

        # Select All
        bpy.ops.object.select_all(action='SELECT')

        # Loop Through Each Selection
        for o in bpy.context.view_layer.objects.selected:
            for t in include:
                if o.type == t:
                    bpy.data.objects.remove(o, do_unlink=True)
                    break

        # De-Select All
        bpy.ops.object.select_all(action='DESELECT')
    return None


# Callback when file(s) are selected
def mechwarrioriv_imp_callback(fpath="", files=[], clearScene=True, impLOD=False):
    if len(files) &gt; 0 and clearScene: deleteScene(['MESH', 'ARMATURE', 'EMPTY'])
    for file in files:
        read(fpath + file.name, impLOD)
    if len(files) &gt; 0:
        messageBox("Done!")
        return True
    else:
        return False


# Wrapper that Invokes FileSelector to open files from blender
def mechwarrioriv_imp(reload=False):
    # Un-Register Operator
    if reload and hasattr(bpy.types, "IMPORTHELPER_OT_mechwarrioriv_imp"):  # print(bpy.ops.importhelper.mechwarrioriv_imp.idname())

        try:
            bpy.types.TOPBAR_MT_file_import.remove(
                bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp').menu_func_import)
        except:
            print("Failed to Unregister2")

        try:
            bpy.utils.unregister_class(bpy.types.Operator.bl_rna_get_subclass_py('IMPORTHELPER_OT_mechwarrioriv_imp'))
        except:
            print("Failed to Unregister1")

    # Define Operator
    class ImportHelper_mechwarrioriv_imp(bpy.types.Operator):

        # Operator Path
        bl_idname = "importhelper.mechwarrioriv_imp"
        bl_label = "Select File"

        # Operator Properties
        # filter_glob: bpy.props.StringProperty(default='*.jpg;*.jpeg;*.png;*.tif;*.tiff;*.bmp', options={'HIDDEN'})
        filter_glob: bpy.props.StringProperty(default='*.erf', options={'HIDDEN'}, subtype='FILE_PATH')

        # Variables
        filepath: bpy.props.StringProperty(subtype="FILE_PATH")  # full path of selected item (path+filename)
        filename: bpy.props.StringProperty(subtype="FILE_NAME")  # name of selected item
        directory: bpy.props.StringProperty(subtype="FILE_PATH")  # directory of the selected item
        files: bpy.props.CollectionProperty(
            type=bpy.types.OperatorFileListElement)  # a collection containing all the selected items�f filenames

        # Controls
        my_int1: bpy.props.IntProperty(name="Some Integer", description="Tooltip")
        my_float1: bpy.props.FloatProperty(name="Scale", default=1.0, description="Changes Scale of the imported Mesh")
        # my_float2: bpy.props.FloatProperty(name="Some Float point", default = 0.25, min = -0.25, max = 0.5)
        my_bool1: bpy.props.BoolProperty(name="Clear Scene", default=True,
                                         description="Deletes everything in the scene prior to importing")
        my_bool2: bpy.props.BoolProperty(name="LOD Meshes", default=False, description="Imports Lower Res Meshes")
        my_bool3: bpy.props.BoolProperty(name="Vertex Weights", default=False, description="Builds Vertex Groups")
        my_bool4: bpy.props.BoolProperty(name="Vertex Normals", default=False, description="Applies Custom Normals")
        my_bool5: bpy.props.BoolProperty(name="Vertex Colours", default=False, description="Builds Vertex Colours")
        my_bool6: bpy.props.BoolProperty(name="Guess Parents", default=False,
                                         description="Uses algorithm to Guess Bone Parenting")
        my_bool7: bpy.props.BoolProperty(name="Dump Textures", default=False,
                                         description="Writes Textures from a file pair '_tex.bin'")
        my_string1: bpy.props.StringProperty(name="", default="Armature",
                                             description="Name of Armature to Import Bones to")
        my_dropdown1: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )
        my_dropdown2: bpy.props.EnumProperty(
            name="Drop",
            items=[
                ('CLEAR', 'clear scene', 'clear scene'),
                ('ADD_CUBE', 'add cube', 'add cube'),
                ('ADD_SPHERE', 'add sphere', 'add sphere')
            ]
        )

        # Runs when this class OPENS
        def invoke(self, context, event):

            # Retrieve Settings
            try:
                self.filepath = bpy.types.Scene.mechwarrioriv_imp_filepath
            except:
                bpy.types.Scene.mechwarrioriv_imp_filepath = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.directory = bpy.types.Scene.mechwarrioriv_imp_directory
            except:
                bpy.types.Scene.mechwarrioriv_imp_directory = bpy.props.StringProperty(subtype="FILE_PATH")

            try:
                self.my_float1 = bpy.types.Scene.mechwarrioriv_imp_my_float1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_float1 = bpy.props.FloatProperty(default=1.0)

            try:
                self.my_bool1 = bpy.types.Scene.mechwarrioriv_imp_my_bool1
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool1 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool2 = bpy.types.Scene.mechwarrioriv_imp_my_bool2
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool2 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool3 = bpy.types.Scene.mechwarrioriv_imp_my_bool3
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool3 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool4 = bpy.types.Scene.mechwarrioriv_imp_my_bool4
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool4 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool5 = bpy.types.Scene.mechwarrioriv_imp_my_bool5
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool5 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool6 = bpy.types.Scene.mechwarrioriv_imp_my_bool6
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool6 = bpy.props.BoolProperty(default=False)

            try:
                self.my_bool7 = bpy.types.Scene.mechwarrioriv_imp_my_bool7
            except:
                bpy.types.Scene.mechwarrioriv_imp_my_bool7 = bpy.props.BoolProperty(default=False)

            try:
                self.my_string1 = bpy.types.Scene.my_string1
            except:
                bpy.types.Scene.my_string1 = bpy.props.BoolProperty(default=False)

            # Open File Browser
            # Set Properties of the File Browser
            context.window_manager.fileselect_add(self)
            context.area.tag_redraw()

            return {'RUNNING_MODAL'}

        # Runs when this Window is CANCELLED
        def cancel(self, context):
            print("run bitch")

        # Runs when the class EXITS
        def execute(self, context):

            # Save Settings
            bpy.types.Scene.mechwarrioriv_imp_filepath = self.filepath
            bpy.types.Scene.mechwarrioriv_imp_directory = self.directory
            #bpy.types.Scene.mechwarrioriv_imp_my_float1 = self.my_float1
            bpy.types.Scene.mechwarrioriv_imp_my_bool1 = self.my_bool1
            bpy.types.Scene.mechwarrioriv_imp_my_bool2 = self.my_bool2
            #bpy.types.Scene.mechwarrioriv_imp_my_bool3 = self.my_bool3
            #bpy.types.Scene.mechwarrioriv_imp_my_bool4 = self.my_bool4
            #bpy.types.Scene.mechwarrioriv_imp_my_bool5 = self.my_bool5
            #bpy.types.Scene.mechwarrioriv_imp_my_bool6 = self.my_bool6
            #bpy.types.Scene.mechwarrioriv_imp_my_bool7 = self.my_bool7
            bpy.types.Scene.mechwarrioriv_imp_my_string1 = self.my_string1

            # Run Callback
            mechwarrioriv_imp_callback(
                self.directory + "\\",
                self.files,
                self.my_bool1,
                self.my_bool2
                )

            return {"FINISHED"}

            # Window Settings

        def draw(self, context):

            # Set Properties of the File Browser
            # context.space_data.params.use_filter = True
            # context.space_data.params.use_filter_folder=True #to not see folders

            # Configure Layout
            # self.layout.use_property_split = True       # To Enable Align
            # self.layout.use_property_decorate = False   # No animation.

            self.layout.row().label(text="Import Settings")

            self.layout.separator()
            self.layout.row().prop(self, "my_bool1")
            self.layout.row().prop(self, "my_bool2")
            #self.layout.row().prop(self, "my_float1")

            #box = self.layout.box()
            #box.label(text="Include")
            #box.prop(self, "my_bool2")
            #box.prop(self, "my_bool3")
            #box.prop(self, "my_bool4")
            #box.prop(self, "my_bool5")

            #box = self.layout.box()
            #box.label(text="Misc")
            #box.prop(self, "my_bool6")
            #box.prop(self, "my_bool7")
            #box.label(text="Import Bones To:")
            #box.prop(self, "my_string1")

            self.layout.separator()

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="  Author:", icon='QUESTION')
            col.alignment = 'LEFT'
            col.label(text="mariokart64n")

            col = self.layout.row()
            col.alignment = 'RIGHT'
            col.label(text="Release:", icon='GRIP')
            col.alignment = 'LEFT'
            col.label(text="March 12, 2021")

        def menu_func_import(self, context):
            self.layout.operator(
                "importhelper.mechwarrioriv_imp",
                text="MechWarrior 4: Vengeance (*.erf)"
                )

    # Register Operator
    bpy.utils.register_class(ImportHelper_mechwarrioriv_imp)
    bpy.types.TOPBAR_MT_file_import.append(ImportHelper_mechwarrioriv_imp.menu_func_import)

    # Assign Shortcut key
    # bpy.context.window_manager.keyconfigs.active.keymaps["Window"].keymap_items.new('bpy.ops.text.run_script()', 'E', 'PRESS', ctrl=True, shift=False, repeat=False)

    # Call ImportHelper
    bpy.ops.importhelper.mechwarrioriv_imp('INVOKE_DEFAULT')




clearListener()  # clears out console
if not useOpenDialog:

    deleteScene(['MESH', 'ARMATURE', 'EMPTY'])  # Clear Scene
    read(
        ""
        )
    messageBox("Done!")
else:
    mechwarrioriv_imp(True)
</code></pre></div></div>

			
			
									
						<div id='list_thanks172205'>
</div>
<div id='div_post_reput172205'>
</div>

							<div id="sig172205" class="signature">Maxscript and other finished work I've done can be found on my <a href="https://www.deviantart.com/mariokart64n" class="postlink">DeviantArt</a> account</div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p172206" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile172206">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/97263.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=97263_1615158361.jpg" width="120" height="119" alt="User avatar" /></a>														</div>
								<a href="../Users/97263.html" class="username">OPR23b</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=97263&amp;sr=posts">50</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Mar 07, 2021 11:54 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="97263"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/true">11 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="97263"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/97263/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact OPR23b">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact OPR23b</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=172206" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content172206">

					<h3 >
						<a href="./viewtopic.php?p=172206#p172206">Re: Help needed with Hex2Obj/MechWarrior 4</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/172206/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=172206" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post172206' href="./viewtopic.php?f=16&amp;p=172206&amp;thanks=172206&amp;to_id=97263&amp;from_id=123876" title="Say Thanks to the author of the post: OPR23b"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=172206#p172206" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/97263.html" class="username">OPR23b</a></strong> &raquo; </span><time datetime="2021-03-12T18:02:07+00:00">Fri Mar 12, 2021 7:02 pm</time>
			</p>
			
			
			
			<div class="content">Alright, works for both the normal parts and cockpits now.<br>
<br>
<br>
Though I do want to ask, can anyone here take a look at the encrypted files and see if you can decrypt them?<br>
<br>
It's the last thing that I wanted to ask for.</div>

			
			
									
						<div id='list_thanks172206'>
</div>
<div id='div_post_reput172206'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=23560" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=16&amp;t=23560&amp;watch=topic&amp;start=15&amp;hash=47965b57" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=16&amp;t=23560&amp;unwatch=topic&amp;start=15&amp;hash=47965b57" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=23560&amp;start=15&amp;bookmark=1&amp;hash=47965b57" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=23560" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=23560&amp;start=15&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=23560&amp;start=15">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			43 posts
							<ul>
			<li class="arrow previous"><a class="button button-icon-only" href="./23560.html" rel="prev" role="button"><i class="icon fa-chevron-left fa-fw" aria-hidden="true"></i><span class="sr-only">Previous</span></a></li>
				<li><a class="button" href="./23560.html" role="button">1</a></li>
			<li class="active"><span>2</span></li>
				<li><a class="button" href="./23560 (2).html" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./23560 (2).html" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=16" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “3D/2D models”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <a href="../Users/119893.html" class="username">DataKeeper</a>, <a href="../Users/123876.html" class="username">escape209</a> and 7 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="../Navigation/index.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
