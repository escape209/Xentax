<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Maplestory 2 - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=18090">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="./ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="./index.php" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="./index.php" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="http://forum.xentax.com/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="./memberlist.php?mode=viewprofile&u=123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=959ea14a0771cc2de19d1bba114b7679" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="./index.php" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="10"><a itemprop="item" href="./viewforum.php?f=10"><span itemprop="name">Game Archive</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./18090.html">Maplestory 2</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">The Original Forum. Game archives, full of resources. How to open them? Get help here.<br /></div>

	<div class="rules rules-link">
		<div class="inner">

					<a href="http://forum.xentax.com/viewtopic.php?f=28&amp;t=1270">Forum rules</a>
		
		</div>
	</div>

<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=18090" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=10&amp;t=18090&amp;watch=topic&amp;start=0&amp;hash=89ef0ca6" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=10&amp;t=18090&amp;unwatch=topic&amp;start=0&amp;hash=89ef0ca6" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=18090&amp;bookmark=1&amp;hash=89ef0ca6" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=18090" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=18090&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="18090" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			32 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./viewtopic.php?t=18090&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="./viewtopic.php?t=18090&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./viewtopic.php?t=18090&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




			<div id="p140505" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140505">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140505" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140505">

					<h3 class="first">
						<a href="./viewtopic.php?p=140505#p140505">Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140505/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140505" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140505' href="./viewtopic.php?f=10&amp;p=140505&amp;thanks=140505&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140505#p140505" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-13T04:18:55+00:00">Sun May 13, 2018 5:18 am</time>
			</p>
			
			
			
			<div class="content">Been digging into the closed beta lately and I have yet to see one central cohesive place where anyone is documenting any of their efforts so in hopes of starting some cohesive efforts before I have to divide myself away for finals. Hoping someone can pick things up with this info. Open to more questions as well.<br>
<br>
At the moment the best IDA pro databases you can make for yourself are by suspending Maplestory2.exe and opening the process in IDA Pro to do a live analysis and eventually saving your database once you've analyzed enough of the relevant modules(such as kernel32 and mfc90) or else you'll run into calls into import pools that lead to seemingly random addresses(be sure to analyse the mfc90 and kernel32 modules and so forth before saving your database as there are no IATs).<br>
<br>
Here are some links. <strong class="text-strong">Note that these are transfer.sh links that will expire in about 2 weeks.</strong><br>
<br>
<a href="https://transfer.sh/157KM2/Library.m2h" class="postlink">https://transfer.sh/157KM2/Library.m2h</a><br>
<a href="https://transfer.sh/f3m0i/Library.m2d" class="postlink">https://transfer.sh/f3m0i/Library.m2d</a><br>
<a href="https://transfer.sh/KRGUE/Movie.m2h" class="postlink">https://transfer.sh/KRGUE/Movie.m2h</a><br>
<a href="https://transfer.sh/bXdPg/Movie.m2d" class="postlink">https://transfer.sh/bXdPg/Movie.m2d</a><br>
<a href="https://transfer.sh/fEmN3/Shaders.m2h" class="postlink">https://transfer.sh/fEmN3/Shaders.m2h</a><br>
<a href="https://transfer.sh/Aaqw2/Shaders.m2d" class="postlink">https://transfer.sh/Aaqw2/Shaders.m2d</a><br>
<a href="https://transfer.sh/Tw455/asset-web-metadata.m2h" class="postlink">https://transfer.sh/Tw455/asset-web-metadata.m2h</a><br>
<a href="https://transfer.sh/jR3Ak/asset-web-metadata.m2d" class="postlink">https://transfer.sh/jR3Ak/asset-web-metadata.m2d</a><br>
<br>
Archives come in couples of "m2h" and "m2d" files such that there is a "Header" and the Data that the header is binded to. Format is different depending on the 4-byte header as well as the size of the headers which I have yet to map out fully due to vtable hell but the sizes are all determinant.
<ul>
<li>Magic - Size<br>
---------------<br>
MS2F - 0x3C<br>
NS2F - 0x34<br>
OS2F - 0x38<br>
PS2F - 0x38</li></ul>
After these 4 bytes is the header bytes. And then followed by a base64 stream:<br>
<img src="https://i.imgur.com/5zqfSyy.png" class="postimage" alt="Image"><br>
<br>
I've traced enough to get several of the XOR keys and the pools of 128 AES Keys and Initialization Vectors which it seems to select at run time.<br>
<img src="https://i.imgur.com/85QCcaV.png" class="postimage" alt="Image"><br>
<br>
The game uses CryptoPP as its encryption middleware and exposes plenty of strings and RTTI symbols to find out where things are at. The above disassembly is CryptoPP's usual Source-Sink pattern of decrypting a stream concisely:<br>
<img src="https://i.imgur.com/Eku0Tkm.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/QpcGFvJ.png" class="postimage" alt="Image"><br>
<br>
In the above pic you'll see it setting up a string source, base64 decoder, some decryptor, and a string sink and a call to what turns out to be <a href="https://github.com/weidai11/cryptopp/blob/7c1d296283fab97a2a5d34445b8c4adca0b9ea0e/cryptlib.h#L664" class="postlink">SetKeyWithIV</a> where it picks from a "vault" of 128 possible(the `&amp; 0x7F` is the same as a `% 128`) 32-byte(256 bit) keys and a 16-byte(128 bit) initialization vector. The way it selects one of these 128 keys is based on one of the fields of the header(Internally named 'PackFileHeaderVer1' for the 'MS2F' files) using the 64-bit integer at 0x24. After the initial base64-decoding. The stream is optionally decrypted with a xor pad and decompressed using <a href="https://www.zlib.net/manual.html" class="postlink">zlib</a>'s "inflate".<br>
<br>
Here's all the keys.<br>
<br>
<a href="https://transfer.sh/CFU1d/MS2FIVVault.bin" class="postlink">https://transfer.sh/CFU1d/MS2FIVVault.bin</a><br>
<a href="https://transfer.sh/njxur/MS2FKeyVault.bin" class="postlink">https://transfer.sh/njxur/MS2FKeyVault.bin</a><br>
<br>
<a href="https://transfer.sh/gRr2l/NS2FXORKey.bin" class="postlink">https://transfer.sh/gRr2l/NS2FXORKey.bin</a><br>
<a href="https://transfer.sh/q6k2p/OS2FXORKey.bin" class="postlink">https://transfer.sh/q6k2p/OS2FXORKey.bin</a><br>
<a href="https://transfer.sh/NhpYd/PS2FXORKey.bin" class="postlink">https://transfer.sh/NhpYd/PS2FXORKey.bin</a><br>
<a href="https://transfer.sh/PqM52/MS2FXORKey.bin" class="postlink">https://transfer.sh/PqM52/MS2FXORKey.bin</a></div>

			
			
									
						<div id='list_thanks140505'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a> for the post: </dt>
			<dd><span title="Sun May 13, 2018 11:41 am"><a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput140505'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140514" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140514">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=23853&amp;sr=posts">1823</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 31, 2010 6:54 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="23853"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/true">92 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="23853"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/false">1058 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ekey">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ekey</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140514" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140514">

					<h3 >
						<a href="./viewtopic.php?p=140514#p140514">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140514/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140514" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140514' href="./viewtopic.php?f=10&amp;p=140514&amp;thanks=140514&amp;to_id=23853&amp;from_id=123876" title="Say Thanks to the author of the post: Ekey"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140514#p140514" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a></strong> &raquo; </span><time datetime="2018-05-13T10:49:33+00:00">Sun May 13, 2018 11:49 am</time>
			</p>
			
			
			
			<div class="content">Do you have EN CBT client?</div>

			
			
									
						<div id='list_thanks140514'>
</div>
<div id='div_post_reput140514'>
</div>

							<div id="sig140514" class="signature">My <a href="https://github.com/Ekey" class="postlink">Github repo</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140537" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140537">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140537" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140537">

					<h3 >
						<a href="./viewtopic.php?p=140537#p140537">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140537/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140537" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140537' href="./viewtopic.php?f=10&amp;p=140537&amp;thanks=140537&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140537#p140537" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-14T07:11:11+00:00">Mon May 14, 2018 8:11 am</time>
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ekey wrote:</cite>Do you have EN CBT client?</div></blockquote>
Here's all the client data for the english closed beta.<br>
<a href="https://mega.nz/#!eK4T3LbL!ejsWFNipuow1WK3PUzSTtTsCpBafGIFk9P0mbXxMJyI" class="postlink">https://mega.nz/#!eK4T3LbL!ejsWFNipuow1 ... P0mbXxMJyI</a></div>

			
			
									
						<div id='list_thanks140537'>
</div>
<div id='div_post_reput140537'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140540" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140540">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=23853&amp;sr=posts">1823</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 31, 2010 6:54 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="23853"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/true">92 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="23853"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/false">1058 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ekey">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ekey</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140540" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140540">

					<h3 >
						<a href="./viewtopic.php?p=140540#p140540">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140540/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140540" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140540' href="./viewtopic.php?f=10&amp;p=140540&amp;thanks=140540&amp;to_id=23853&amp;from_id=123876" title="Say Thanks to the author of the post: Ekey"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140540#p140540" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a></strong> &raquo; </span><time datetime="2018-05-14T11:43:10+00:00">Mon May 14, 2018 12:43 pm</time>
			</p>
			
			
			
			<div class="content">Thanks for client. As I see for NS2F, OS2F and PS2F keys and vectors are generated individually.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>int __stdcall sub_4A04B0(int a1, int a2, int a3, int a4, int a5)
{
  switch ( a1 )
  {
    case 0x4632534D:
      return sub_49FBF0(a2, a3, a4, a5);
    case 0x4632534E:
      return sub_49FE20(a2, a3, a4, a5);
    case 0x4632534F:
      return sub_4A0050(a2, a3, a4, a5);
    case 0x46325350:
      return sub_4A0280(a2, a3, a4, a5);
  }
  return 0;
}</code></pre></div>

MS2F (Static keys)<br>
<br>
<img src="https://i.imgur.com/AQfDhQu.png" class="postimage" alt="Image"><br>
<br>
NS2F (Dynamic keys)<br>
<br>
<img src="https://i.imgur.com/vYyrb7g.png" class="postimage" alt="Image"><br>
<br>
OS2F (Dynamic keys)<br>
<br>
<img src="https://i.imgur.com/AkNcUkN.png" class="postimage" alt="Image"><br>
<br>
PS2F (Dynamic keys)<br>
<br>
<img src="https://i.imgur.com/P1Fv57U.png" class="postimage" alt="Image"><br>
<br>
That keys generates this call int sub_48EED0() or it's more like pointers<br>
<br>
<img src="https://i.imgur.com/7O5TZc5.png" class="postimage" alt="Image"><br>
<br>
Seems j_mfc90_265 is a malloc.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>buffer = (char*) malloc (512);</code></pre></div></div>

			
			
									
						<div id='list_thanks140540'>
</div>
<div id='div_post_reput140540'>
</div>

							<div id="sig140540" class="signature">My <a href="https://github.com/Ekey" class="postlink">Github repo</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140548" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140548">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140548" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140548">

					<h3 >
						<a href="./viewtopic.php?p=140548#p140548">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140548/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140548" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140548' href="./viewtopic.php?f=10&amp;p=140548&amp;thanks=140548&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140548#p140548" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-14T19:24:11+00:00">Mon May 14, 2018 8:24 pm</time>
			</p>
			
			
			
			<div class="content">I noticed these too. It generates the other keys based on some xoring of the static MS2F keys and the associated static XorKey for the NS2F and so forth though I did not find any files that used these headers. They are allocated on the heap and will have to be dumped at runtime if we want them.<br>
<br>
I made a megafolder with the keys and client.<br>
<br>
<a href="https://mega.nz/#F!DbxEAL5S!MvLhvAcyusMF4kp6_qBXYA" class="postlink">https://mega.nz/#F!DbxEAL5S!MvLhvAcyusMF4kp6_qBXYA</a><br>
<br>
I was in the middle of mapping out the vtables and logic for MS2F files(Internally called PackFileHeaderVer1) before I had to part. This is what I got in my little utility library before I had to part with my main workstation.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>MapleStory2.exe:015CC9D8 dd offset ??_R4?$PackFileStream@VCPackStreamVer1@@@@6B@ ; const PackFileStream&lt;CPackStreamVer1&gt;::`RTTI Complete Object Locator'
MapleStory2.exe:015CC9DC ; const PackFileStream&lt;class CPackStreamVer1&gt;::`vftable'
MapleStory2.exe:015CC9DC ??_7?$PackFileStream@VCPackStreamVer1@@@@6B@ dd offset sub_579430
MapleStory2.exe:015CC9DC                                         ; DATA XREF: CPackStreamVer1_Ctor+27↑o
MapleStory2.exe:015CC9E0 dd offset ??_R4?$PackFileStream@VCPackStreamVer1@@@@6B@_0 ; const PackFileStream&lt;CPackStreamVer1&gt;::`RTTI Complete Object Locator'
MapleStory2.exe:015CC9E4 ; CPackStreamVer1Vtable PackFileStream&lt;CPackStreamVer1&gt;::`vftable'
MapleStory2.exe:015CC9E4 ??_7?$PackFileStream@VCPackStreamVer1@@@@6B@_0 CPackStreamVer1Vtable &lt;offset CPackStreamVer1Vtable__Dtor, \
MapleStory2.exe:015CC9E4                                         ; DATA XREF: CPackStreamVer1_Ctor+21↑o
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__GetHeaderSize, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__GetBufferPtr, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_C, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__GetCompressedSize?,\
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_14, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__GetLength?, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__GetVersion?, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_20, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_24, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__SetMagic, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_2C, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_30, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_34, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_38, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_3C, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_40, \
MapleStory2.exe:015CC9E4                        offset CPackStreamVer1Vtable__field_44&gt;</code></pre></div>

The header structures do not consider the 4 Magic bytes.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>union PackFileHeaderVer1
{
public:
        Util::Field&lt;0x00, std::uint32_t&gt; Unknown00;
        Util::Field&lt;0x04, std::uint64_t&gt; Unknown04;
        Util::Field&lt;0x0C, std::uint64_t&gt; Unknown0C; // Compressed Size?
        Util::Field&lt;0x14, std::uint64_t&gt; Unknown14;
        Util::Field&lt;0x1C, std::uint64_t&gt; Unknown1C; // Size?
        Util::Field&lt;0x24, std::uint64_t&gt; Unknown24; // Version?
        Util::Field&lt;0x2C, std::uint32_t&gt; Unknown2C;
        Util::Field&lt;0x30, std::uint32_t&gt; Unknown30;
        Util::Field&lt;0x34, std::uint64_t&gt; Unknown34;

private:
        Util::Padding&lt;0x3C&gt; Pad;
};</code></pre></div>

The "version" flag(named it that might it's above 128 at times and probably means something other than just a straight up "KeyIndex") might be what is used to determine which of the 128 keys that it uses from the Key/IV LUT(after a % 128) from what I've seen.<br>
<br>
Here's the full decryption pseudo code which i made some guesses for.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>CFileSystem = this;
  PackFile = PackFile_1;
  Length = 0;
  this[24] = 0;
  v8 = PackFile-&gt;vtable-&gt;GetLength_(PackFile);
  mfc_Alloc_0(v8);
  Buffer = v9;
  v32 = v9;
  Size = (PackFile-&gt;vtable-&gt;GetLength_)(PackFile, &amp;Length, 0);
  ReadFile(FileHandle, Buffer, Size, BytesRead, Overlapped);
  IsCompressedFunc? = PackFile-&gt;vtable-&gt;GetCompressedSize_;
  PackFile_1 = 0;
  if ( !(*(IsCompressedFunc?(PackFile, &amp;FileHandle) + 3) &amp; 1) )
  {
    KeyIndex_1 = PackFile-&gt;vtable-&gt;GetVersion_(PackFile);
    v14 = (*(*CFileSystem[55] + 8))(            // AES decrypt
            CFileSystem[57],
            Buffer,
            Length,
            &amp;PackFile_1,
            KeyIndex_1);
    if ( v14 &amp;&amp; PackFile_1 )
    {
      mfc90_free(v32);
      v32 = 0;
      goto LABEL_7;
    }
LABEL_32:
    mfc90_free(v32);
    return 0;
  }
  KeyIndex = PackFile-&gt;vtable-&gt;GetVersion_(PackFile);
  v14 = (*(*CFileSystem[56] + 8))(              // Xor Decrypt
          CFileSystem[57],
          Buffer,
          Length,
          &amp;PackFile_1,
          KeyIndex);
  if ( !v14 || !PackFile_1 )
    goto LABEL_32;
LABEL_7:
  if ( v14 != PackFile-&gt;vtable-&gt;GetVersion_(PackFile) || v16 )
  {
    if ( v32 )
    {
      mfc90_free(v32);
      return 0;
    }
    return 0;
  }
  if ( *PackFile-&gt;vtable-&gt;GetCompressedSize_(PackFile, &amp;FileHandle) )// Compression
  {
    v21 = Compressed;
    v22 = 0;
    CFileSystem[26] = *a4;
    CFileSystem[27] = v21;
    if ( v21 )
    {
      while ( 1 )
      {
        if ( !CFileSystem[24] )
        {
          v23 = Length;
          v24 = PackFile_1 + v22;
          v22 += Length;
          v25 = CFileSystem[38] &lt; Length;
          CFileSystem[38] -= Length;
          CFileSystem[23] = v24;
          CFileSystem[24] = v23;
          CFileSystem[39] -= v25;
        }
        if ( *(CFileSystem + 19) )
          v26 = 0;
        else
          v26 = 4;
        v27 = zlib_inflate(CFileSystem + 23, v26);
        if ( v27 == -5 )
        {
          mfc90_free(PackFile_1);
          return 0;
        }
        if ( v27 )
          break;
        if ( !CFileSystem[27] )
        {
          mfc90_free(PackFile_1);
          return 0;
        }
      }
      if ( v27 == 1 )
      {
        *a6 = Compressed - CFileSystem[27];
        goto LABEL_28;
      }
      mfc90_free(PackFile_1);
      result = 0;
    }
    else
    {
      v28 = a6;
      v29 = HIDWORD(Compressed);
      *a6 = Compressed;
      v28[1] = v29;
LABEL_28:
      mfc90_free(PackFile_1);
      result = 1;
    }
  }
  else
  {
    v18 = *(CFileSystem + 19) - Length;
    if ( v18 &gt;= 0 )
    {
      *(CFileSystem + 19) = v18;
    }
    else
    {
      CFileSystem[38] = 0;
      CFileSystem[39] = 0;
    }
    v19 = a6;
    a6[1] = 0;
    v20 = a4;
    *v19 = v14;
    j_msvcr90_memcpy(*v20, PackFile_1, v14);
    mfc90_free(PackFile_1);
    result = 1;
  }
  return result;
</code></pre></div></div>

			
			
									
						<div id='list_thanks140548'>
</div>
<div id='div_post_reput140548'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140552" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140552">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=23853&amp;sr=posts">1823</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 31, 2010 6:54 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="23853"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/true">92 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="23853"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/false">1058 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ekey">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ekey</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140552" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140552">

					<h3 >
						<a href="./viewtopic.php?p=140552#p140552">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140552/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140552" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140552' href="./viewtopic.php?f=10&amp;p=140552&amp;thanks=140552&amp;to_id=23853&amp;from_id=123876" title="Say Thanks to the author of the post: Ekey"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140552#p140552" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a></strong> &raquo; </span><time datetime="2018-05-14T21:14:35+00:00">Mon May 14, 2018 10:14 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>DEElekgolo wrote:</cite>I did not find any files that used these headers</div></blockquote>
Xml.m2h used NS2F. About headers: is not to hard<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct MSPHeader
{
   uint64_t   dwMagic;
};

struct MS2FSubHeader
{
   uint64_t   dwTOCZSize; //compressed size (zlib) also it's a KeyIndex
   uint64_t   dwTOCESize; //encoded size
   uint64_t   dwFileListSize;  //uncompressed size
   uint64_t   dwFileListZSize;  //compressed size (zlib) also it's a KeyIndex
   uint64_t   dwFileListESize; //encoded size
   uint64_t   dwTotalFiles;
   uint64_t   dwTOCSize; //uncompressed size
};

struct NS2FSubHeader
{
   uint32_t   dwTotalFiles;
   uint64_t   dwTOCZSize; //compressed size (zlib) also it's a KeyIndex
   uint64_t   dwTOCESize; //encoded size
   uint64_t   dwTOCSize; //uncompressed size
   uint64_t   dwFileListZSize; //compressed size (zlib) also it's a KeyIndex
   uint64_t   dwFileListESize; //encoded size
   uint64_t   dwFileListSize; //uncompressed size
};</code></pre></div>

Example on asset-web-metadata file:<br>
<br>
1) Read data by dwFileListESize = 340 bytes<br>
2) Decode and decrypt by Base64 + AES and you got size equal dwFileListZSize = 254 bytes<br>
3) Decompress it (dwFileListSize = 480 bytes) and we got list of filenames like<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>1,application.nt
2,awebckpt.nt
3,awebinst.nt
4,canonical.nt
5,cn.nt
6,dds.nt
7,emergent-flat-model.nt
8,emergent-world.nt
9,enums.nt
10,fx-shader-compiled.nt
11,gamebryo-animation.nt
12,gamebryo-scenegraph.nt
13,gamebryo-sequence-file.nt
14,image.nt
15,kr.nt
16,llid.nt
17,logpath.nt
18,lua-behavior.nt
19,model.nt
20,name.nt
21,nuts.nt
22,png.nt
23,precache.nt
24,relpath.nt
25,script.nt
26,shader.nt
27,soup.nt
28,x-shockwave-flash.nt
29,x-world.nt
</code></pre></div>

Repeat for TOC table<br>
<br>
1) Read data by dwTOCESize = 756 bytes<br>
2) Decode and decrypt by Base64 + AES and you got size equal dwTOCZSize = 565 bytes<br>
3) Decompress it (dwTOCSize = 1392 bytes) and we got table of contents (see attach)<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct MSPTocEntry
{
   uint32_t   dwNull;
   uint32_t   dwFileID; //equal to the number from the filelist
   uint64_t   dwUnknown; //dunno what this (flags ?) : always 0xEE000009
   uint64_t   dwOffset;
   uint64_t   dwESize; //encoded size
   uint64_t   dwZSize; //compressed size
   uint64_t   dwSize; //uncompressed size
};
</code></pre></div></div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=14363">asset-web-metadata_tables.rar</a></dt>
						<dd>(923 Bytes) Downloaded 16 times</dd>
		</dl>
		
			</dd>
									</dl>
			
													<div class="notice">
					Last edited by <a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a> on Mon May 21, 2018 12:00 am, edited 2 times in total.
									</div>
			
						<div id='list_thanks140552'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a> for the post: </dt>
			<dd><span title="Tue May 15, 2018 1:54 am"><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput140552'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

							<div id="sig140552" class="signature">My <a href="https://github.com/Ekey" class="postlink">Github repo</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140555" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140555">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140555" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140555">

					<h3 >
						<a href="./viewtopic.php?p=140555#p140555">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140555/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140555" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140555' href="./viewtopic.php?f=10&amp;p=140555&amp;thanks=140555&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140555#p140555" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-15T00:39:20+00:00">Tue May 15, 2018 1:39 am</time>
			</p>
			
			
			
			<div class="content">Looks solid!<br>
Can't wait to dive in once I get back and I can make a little general purpose extractor.<br>
Looks like repackaging is even possible. Back when this was a Korea-only game some others had made an English translation patch I believe that involved edits to the m2h and m2d files.</div>

			
			
									
						<div id='list_thanks140555'>
</div>
<div id='div_post_reput140555'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140592" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140592">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=71335.html" class="username">Ewol</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=71335&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed May 16, 2018 2:55 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="71335"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/71335/true">1 time</a></dd>
    <dd class="profile-posts" data-user-receive-id="71335"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ewol">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ewol</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140592" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140592">

					<h3 >
						<a href="./viewtopic.php?p=140592#p140592">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140592/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140592" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140592' href="./viewtopic.php?f=10&amp;p=140592&amp;thanks=140592&amp;to_id=71335&amp;from_id=123876" title="Say Thanks to the author of the post: Ewol"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140592#p140592" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=71335.html" class="username">Ewol</a></strong> &raquo; </span><time datetime="2018-05-16T14:27:03+00:00">Wed May 16, 2018 3:27 pm</time>
			</p>
			
			
			
			<div class="content">Keep us updated on the extractor. <br>
<br>
I spent all night trying to figure out how to get into those files, but it's quite clearly way above my head.</div>

			
			
									
						<div id='list_thanks140592'>
</div>
<div id='div_post_reput140592'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140604" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140604">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140604" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140604">

					<h3 >
						<a href="./viewtopic.php?p=140604#p140604">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140604/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140604" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140604' href="./viewtopic.php?f=10&amp;p=140604&amp;thanks=140604&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140604#p140604" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-17T07:04:34+00:00">Thu May 17, 2018 8:04 am</time>
			</p>
			
			
			
			<div class="content">Wedged in some time to make a quick little decryptor. Can fully open MS2F m2h/m2d files and read/decrypt file data. Hoping to aim it to fully "mounting" the Data folder and recreating the internal virtual file system that "CFileSystem" implements<br>
<br>
<img src="https://i.imgur.com/yg3jUd4.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/7W9K8UL.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/hZN6r4q.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/ColoPNa.png" class="postimage" alt="Image"><br>
<br>
ATM I don't have the keys for N/O/PS2F files as they are generated at runtime as a multidimensional array though the generation for the keys can be pretty trivially recreated.<br>
<br>
Some xoring and swizzling to the effect of:<br>
<img src="https://i.imgur.com/RkAxBrg.png" class="postimage" alt="Image"><br>
Which is a <strong class="text-strong">( (i + 5 ) % 8 )</strong> offset from the XOR key lookup. Would probably be much quicker to dump the multidimensional array from memory( which is a pointer to 512 bytes which is 128 pointers to the keys and IVs and such ).<br>
<br>
Since the beta is over it might be harder to do some runtime analysis to dump the keys from memory but running the exe directly unpacks it enough that it can be derived. Something I don't have the time atm for but would allow for `NS2F` files and such to be handled.</div>

			
			
									
						<div id='list_thanks140604'>
</div>
<div id='div_post_reput140604'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140607" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140607">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140607" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140607">

					<h3 >
						<a href="./viewtopic.php?p=140607#p140607">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140607/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140607" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140607' href="./viewtopic.php?f=10&amp;p=140607&amp;thanks=140607&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140607#p140607" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-17T09:16:43+00:00">Thu May 17, 2018 10:16 am</time>
			</p>
			
			
			
			<div class="content">some dumps from <strong class="text-strong">Image.m2h/m2d</strong><br>
<br>
<img src="https://i.imgur.com/TcYMGnK.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/0kYBoLD.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/1d0R5sn.png" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/lh5bJUJ.jpg" class="postimage" alt="Image"><br>
<img src="https://i.imgur.com/mScbJdI.png" class="postimage" alt="Image"></div>

			
			
									
						<div id='list_thanks140607'>
</div>
<div id='div_post_reput140607'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140608" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140608">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=71335.html" class="username">Ewol</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=71335&amp;sr=posts">2</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed May 16, 2018 2:55 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="71335"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/71335/true">1 time</a></dd>
    <dd class="profile-posts" data-user-receive-id="71335"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ewol">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ewol</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140608" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140608">

					<h3 >
						<a href="./viewtopic.php?p=140608#p140608">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140608/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140608" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140608' href="./viewtopic.php?f=10&amp;p=140608&amp;thanks=140608&amp;to_id=71335&amp;from_id=123876" title="Say Thanks to the author of the post: Ewol"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140608#p140608" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=71335.html" class="username">Ewol</a></strong> &raquo; </span><time datetime="2018-05-17T10:33:05+00:00">Thu May 17, 2018 11:33 am</time>
			</p>
			
			
			
			<div class="content">Will you be sharing the tool once it's ready?</div>

			
			
									
						<div id='list_thanks140608'>
</div>
<div id='div_post_reput140608'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140610" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140610">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a>							</dt>

						<dd class="profile-rank">M-M-M-Monster veteran<br /><img src="./images/ranks/vip-1.png" alt="M-M-M-Monster veteran" title="M-M-M-Monster veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=23853&amp;sr=posts">1823</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Mar 31, 2010 6:54 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="23853"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/true">92 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="23853"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/23853/false">1058 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Ekey">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Ekey</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140610" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140610">

					<h3 >
						<a href="./viewtopic.php?p=140610#p140610">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140610/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140610" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140610' href="./viewtopic.php?f=10&amp;p=140610&amp;thanks=140610&amp;to_id=23853&amp;from_id=123876" title="Say Thanks to the author of the post: Ekey"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140610#p140610" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a></strong> &raquo; </span><time datetime="2018-05-17T12:48:43+00:00">Thu May 17, 2018 1:48 pm</time>
			</p>
			
			
			
			<div class="content">Looks good, keep going <img class="smilies" src="./images/smilies/%5Bcolon%5D%29.gif" width="15" height="15" alt=":)" title="Smile"></div>

			
			
									
						<div id='list_thanks140610'>
</div>
<div id='div_post_reput140610'>
</div>

							<div id="sig140610" class="signature">My <a href="https://github.com/Ekey" class="postlink">Github repo</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140632" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140632">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140632" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140632">

					<h3 >
						<a href="./viewtopic.php?p=140632#p140632">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140632/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140632" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140632' href="./viewtopic.php?f=10&amp;p=140632&amp;thanks=140632&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140632#p140632" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-18T03:29:58+00:00">Fri May 18, 2018 4:29 am</time>
			</p>
			
			
			
			<div class="content"><blockquote><div><cite>Ewol wrote:</cite>Will you be sharing the tool once it's ready?</div></blockquote>
Sure. Though I am developing this remotely in a linux environment(compatible with windows but will involve some hoop-jumping to get it to build. Uses CMake and CryptoPP).<br>
I can post the source code once its ready for the public and I can just post a fully dumped version of the game for all to pick through.<br>
<br>
At the moment I just need to find time to get NS2F and O/PS2F keys to get my program to recursively dump and flatten out all possible m2h/m2d files it runs into.</div>

			
			
									
						<div id='list_thanks140632'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a> for the post: </dt>
			<dd><span title="Fri May 18, 2018 7:50 pm"><a href="./memberlist.php?mode=viewprofile&u=71335.html" class="username">Ewol</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput140632'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140781" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile140781">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=55512.html" class="username">Miyu</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=55512&amp;sr=posts">7</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Apr 03, 2016 11:39 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="55512"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/55512/true">3 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="55512"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/55512/false">2 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Miyu">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Miyu</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140781" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140781">

					<h3 >
						<a href="./viewtopic.php?p=140781#p140781">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140781/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140781" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140781' href="./viewtopic.php?f=10&amp;p=140781&amp;thanks=140781&amp;to_id=55512&amp;from_id=123876" title="Say Thanks to the author of the post: Miyu"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140781#p140781" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=55512.html" class="username">Miyu</a></strong> &raquo; </span><time datetime="2018-05-22T21:55:17+00:00">Tue May 22, 2018 10:55 pm</time>
			</p>
			
			
			
			<div class="content">I uploaded the tools and library that I created when I made the english patches. There is an extractor and a creator tool on my github: <a href="https://github.com/Miyuyami/MS2Tools" class="postlink">https://github.com/Miyuyami/MS2Tools</a>.<br>
Both of them use the library I created which is here: <a href="https://github.com/Miyuyami/MS2Lib" class="postlink">https://github.com/Miyuyami/MS2Lib</a>. This is where you can also find the NS2F, OS2F and PS2F IV and Key pairs that are missing from this thread.<br>
<br>
I hope that those tools are not too scuffed/broken and that will help the people interested in this. <img class="smilies" src="./images/smilies/%5Bcolon%5D%29.gif" width="15" height="15" alt=":)" title="Smile"></div>

			
			
									
						<div id='list_thanks140781'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="./memberlist.php?mode=viewprofile&u=55512.html" class="username">Miyu</a> for the post (total 2):</dt>
			<dd><span title="Tue May 22, 2018 11:57 pm"><a href="./memberlist.php?mode=viewprofile&u=23853.html" class="username">Ekey</a></span>, <span title="Wed May 23, 2018 5:04 am"><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput140781'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;3.45%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 3.45%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p140859" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile140859">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=31956_1526327465.png" width="120" height="115" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a>							</dt>

						<dd class="profile-rank">advanced</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=31956&amp;sr=posts">44</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Dec 23, 2010 9:49 am</dd>		
		
											    <dd class="profile-posts" data-user-give-id="31956"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/true">9 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="31956"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/31956/false">32 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact wunk">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact wunk</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=140859" title="Send private message">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																																																<a href="http://twitter.com/wunkolo" title="Twitter" class="last-cell">
										<span class="contact-icon phpbb_twitter-icon">Twitter</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content140859">

					<h3 >
						<a href="./viewtopic.php?p=140859#p140859">Re: Maplestory 2</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/140859/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=140859" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post140859' href="./viewtopic.php?f=10&amp;p=140859&amp;thanks=140859&amp;to_id=31956&amp;from_id=123876" title="Say Thanks to the author of the post: wunk"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=140859#p140859" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=31956.html" class="username">wunk</a></strong> &raquo; </span><time datetime="2018-05-26T11:48:42+00:00">Sat May 26, 2018 12:48 pm</time>
			</p>
			
			
			
			<div class="content">Been updating my tool a bit with some of the internal structures and the elusive OS2F/PS2F ones while I can.<br>
<br>
I updated the mega folder with all the keys as well as a <strong class="text-strong">fully dumped and "flattened" version of the CBT files </strong>for anyone browsing this thread to poke through(<em class="text-italics">MapleStory2-CBT-May18-Dumped.zip <strong class="text-strong">~12GB</strong></em>) Each m2h/m2d pair has a folder by the same name created with the entire runtime virtual file system flattened out.<br>
<br>
<a href="https://mega.nz/#F!DbxEAL5S!MvLhvAcyusMF4kp6_qBXYA" class="postlink">https://mega.nz/#F!DbxEAL5S!MvLhvAcyusMF4kp6_qBXYA</a><br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>tree Dump -d -L 5

Dump
└── MapleFiles
    ├── appdata
    │   ├── BlackCipher
    │   ├── Custom
    │   │   ├── Cube
    │   │   └── Equip
    │   ├── Data
    │   │   ├── lua
    │   │   │   └── Precompiled
    │   │   ├── Resource
    │   │   │   ├── asset-web-config
    │   │   │   ├── asset-web-metadata
    │   │   │   ├── Exported
    │   │   │   ├── gfx
    │   │   │   ├── Gfx
    │   │   │   ├── Image
    │   │   │   ├── Library
    │   │   │   ├── Model
    │   │   │   ├── Movie
    │   │   │   ├── PrecomputedTerrain
    │   │   │   └── Shaders
    │   │   ├── Shaders
    │   │   │   └── PreGenerated
    │   │   ├── Sound
    │   │   └── Xml
    │   │       ├── achieve
    │   │       ├── additionaleffect
    │   │       ├── camera
    │   │       ├── effect
    │   │       ├── emotion
    │   │       ├── excel
    │   │       ├── exportedugcmap
    │   │       ├── groundeffect
    │   │       ├── item
    │   │       ├── itemoption
    │   │       ├── itempreset
    │   │       ├── map
    │   │       ├── mapxblock
    │   │       ├── masteryhomemade
    │   │       ├── musicscore
    │   │       ├── npc
    │   │       ├── object
    │   │       ├── pet
    │   │       ├── quest
    │   │       ├── riding
    │   │       ├── script
    │   │       ├── skill
    │   │       ├── string
    │   │       ├── table
    │   │       ├── trigger
    │   │       ├── ugcmap
    │   │       └── ui
    │   ├── locales
    │   ├── Microsoft.VC90.CRT
    │   └── Microsoft.VC90.MFC
    └── patchdata
</code></pre></div>

<br>
<a href="https://pastebin.com/raw/Q7XcYFMn" class="postlink">Also here's a full list of banned words for the English CBT for kicks</a></div>

			
			
									
						<div id='list_thanks140859'>
</div>
<div id='div_post_reput140859'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=18090" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=10&amp;t=18090&amp;watch=topic&amp;start=0&amp;hash=89ef0ca6" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=10&amp;t=18090&amp;unwatch=topic&amp;start=0&amp;hash=89ef0ca6" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=18090&amp;bookmark=1&amp;hash=89ef0ca6" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=18090" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=18090&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=18090">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			32 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./viewtopic.php?t=18090&amp;start=15" role="button">2</a></li>
				<li><a class="button" href="./viewtopic.php?t=18090&amp;start=30" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./viewtopic.php?t=18090&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=10" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Game Archive”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Ahrefs [Bot]</span>, <a href="./memberlist.php?mode=viewprofile&u=123876.html" class="username">escape209</a> and 3 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="./index.php" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
