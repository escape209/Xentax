<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>[Help] Weights issue in Noesis script - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=21731">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="../../Source/assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="../../Source/styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="../../Source/ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="../Navigation/index.html" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="../Navigation/index.html" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="../Source/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="../Users/123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=959ea14a0771cc2de19d1bba114b7679" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="../Navigation/index.html" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="16"><a itemprop="item" href="./viewforum.php?f=16"><span itemprop="name">3D/2D models</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./21731.html">[Help] Weights issue in Noesis script</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Post questions about game models here, or help out others!<br /></div>

	<div class="rules rules-link">
		<div class="inner">

					<a href="http://forum.xentax.com/viewtopic.php?f=28&amp;t=1270">Forum rules</a>
		
		</div>
	</div>

<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=21731" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=16&amp;t=21731&amp;watch=topic&amp;start=0&amp;hash=eb4b93cd" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=16&amp;t=21731&amp;unwatch=topic&amp;start=0&amp;hash=eb4b93cd" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=21731&amp;bookmark=1&amp;hash=eb4b93cd" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=21731" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=21731&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="21731" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			19 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./21731 (1).html" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./21731 (1).html" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




			<div id="p159822" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile159822">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159822" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159822">

					<h3 class="first">
							<img src="./images/icons/smile/question.gif" width="16" height="16" alt="" title="">
						<a href="./viewtopic.php?p=159822#p159822">[Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159822/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159822" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159822' href="./viewtopic.php?f=16&amp;p=159822&amp;thanks=159822&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159822#p159822" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-10T13:46:18+00:00">Mon Feb 10, 2020 2:46 pm</time>
			</p>
			
			
			
			<div class="content">Hi everyone,<br>
After months giving up, I decide to fight again with the boneWeight and animation in Noesis.<br>
Mesh and bone are loaded correctly (or as I think so) but bone weight isn't.<br>
There are 3 issues:
<ul style="list-style-type:3"><li>I do not know how to use functions for bone weight in Noesis in my case.</li>
<li>Why is there a 4x4 Mat for parent bone under each 4x4 Mat for each bone, or maybe I missunderstand about its role. See below for reference.</li>
<li>How to test for the weight and bone when I have no animation file, is it anyway to create a simple animation for testing purpose?</li></ul>
Hope someone could help or give hints. Many thanks.<br>
Here is the file structure:
<blockquote cite="./viewtopic.php?p=67394#p67394"><div><cite><a href="../Users/33646.html">Ninja</a> wrote: <a href="./viewtopic.php?p=67394#p67394" data-post-id="67394" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><span class="responsive-hide">Sat Feb 18, 2012 7:35 am</span></cite>
...<br>
edit 2. the ksword3d models look static - very simple, vertices 3 floats, normals 3 floats, UV 2 floats + 1 long, triangle strips?
</div></blockquote>
I add structure of bone as below:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>bone offset 4 bytes - byte 188th from the beginning
After jumping to bone offset
number of bones 4 bytes
char bone-name 30 bytes
char parent-bone-name 30 bytes
int number of child bones 4 bytes
char child-bone-name[] 30 bytes
float transform-matrix[4][4] 64 bytes //need to be inversed
float parent bone transform-matrix[4][4] 64 bytes //need to be inversed
int number of vertex connected to this bone 4 bytes 
int vertex id[] 4 bytes 
float weight[] 4 bytes // weighting information corresponding to vertex id</code></pre></div>
Here is the code:<br>
<a href="https://pastebin.com/vTbzXe8A" class="postlink">https://pastebin.com/vTbzXe8A</a><br>
And sample file:<br>
<a href="https://drive.google.com/file/d/14G-9xR_QSdagUPpa5hV7VF5HGQDnnPoB/view" class="postlink">https://drive.google.com/file/d/14G-9xR ... nnPoB/view</a></div>

			
			
									
						<div id='list_thanks159822'>
</div>
<div id='div_post_reput159822'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159869" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile159869">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/36239.html" class="username">jayn23</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=36239&amp;sr=posts">250</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jul 17, 2011 9:30 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="36239"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/true">61 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="36239"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/false">241 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact jayn23">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact jayn23</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159869" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159869">

					<h3 >
						<a href="./viewtopic.php?p=159869#p159869">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159869/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159869" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159869' href="./viewtopic.php?f=16&amp;p=159869&amp;thanks=159869&amp;to_id=36239&amp;from_id=123876" title="Say Thanks to the author of the post: jayn23"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159869#p159869" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/36239.html" class="username">jayn23</a></strong> &raquo; </span><time datetime="2020-02-11T19:54:09+00:00">Tue Feb 11, 2020 8:54 pm</time>
			</p>
			
			
			
			<div class="content">I took a very quick look at your script and your weight list and vertex number should be equal, but vert number is 569 while weight list length is 1.<br>
its probably some small mistake in the code, ill try and take a better look later.<br>
<br>
Another problem i think you have is you are phrasing mesh then skeleton but weight are in the skeleton section, so you basically read the weights once the mesh is already defied, i dont think it will work like that.<br>
<br>
try using NoeMesh() and NoeModel() - that way you can insert all the data at the end<br>
<br>
edit:<br>
just from a few prints, one mistake is what you are appending to bidx which should hold bone ID and you are appending vert ID.</div>

			
			
									
						<div id='list_thanks159869'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/36239.html" class="username">jayn23</a> for the post: </dt>
			<dd><span title="Wed Feb 12, 2020 5:51 am"><a href="../Users/83419.html" class="username">srbvn</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput159869'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159914" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile159914">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159914" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159914">

					<h3 >
						<a href="./viewtopic.php?p=159914#p159914">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159914/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159914" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159914' href="./viewtopic.php?f=16&amp;p=159914&amp;thanks=159914&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159914#p159914" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-12T13:22:18+00:00">Wed Feb 12, 2020 2:22 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote cite="./viewtopic.php?p=159869#p159869"><div><cite><a href="../Users/36239.html">jayn23</a> wrote: <a href="./viewtopic.php?p=159869#p159869" data-post-id="159869" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><span class="responsive-hide">Tue Feb 11, 2020 8:54 pm</span></cite>
I took a very quick look at your script and your weight list and vertex number should be equal, but vert number is 569 while weight list length is 1.<br>
its probably some small mistake in the code, ill try and take a better look later.<br>
<br>
Another problem i think you have is you are phrasing mesh then skeleton but weight are in the skeleton section, so you basically read the weights once the mesh is already defied, i dont think it will work like that.<br>
<br>
try using NoeMesh() and NoeModel() - that way you can insert all the data at the end
</div></blockquote>

Hi jayn23,<br>
You are right, I think I should try to re-write the script with NoeMesh() and NoeModel() - not sure how to write, but will update here soon  <img class="smilies" src="./images/smilies/%5Bcolon%5DD.gif" width="15" height="15" alt=":D" title="Very Happy"> .
<blockquote cite="./viewtopic.php?p=159869#p159869"><div><cite><a href="../Users/36239.html">jayn23</a> wrote: <a href="./viewtopic.php?p=159869#p159869" data-post-id="159869" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><span class="responsive-hide">Tue Feb 11, 2020 8:54 pm</span></cite>
edit:<br>
just from a few prints, one mistake is what you are appending to bidx which should hold bone ID and you are appending vert ID.
</div></blockquote>
Currently, I am trying to reshape the weighting data to create Buffers for rpgBindBoneIndexBuffer and rpgBindBoneWeightBuffer., since the file structure looks like figures no.1 while the functions require the figure no. 2. Honestly, I am in trouble with this step since I do not know much about Python. Do you have any hints for this, or we should have another method that get rid of rpgBindBoneIndexBuffer  and rpgBindBoneWeightBuffer. Thanks.<br>
<br>
<img src="https://i.imgur.com/8XDV3bB.png" class="postimage" alt="Image"><br>
Figure no. 1<br>
<br>
<img src="https://i.imgur.com/kcgWVA9.png" class="postimage" alt="Image"><br>
Figure no. 2</div>

			
			
									
						<div id='list_thanks159914'>
</div>
<div id='div_post_reput159914'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159920" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile159920">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/36239.html" class="username">jayn23</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=36239&amp;sr=posts">250</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jul 17, 2011 9:30 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="36239"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/true">61 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="36239"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/false">241 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact jayn23">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact jayn23</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159920" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159920">

					<h3 >
						<a href="./viewtopic.php?p=159920#p159920">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159920/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159920" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159920' href="./viewtopic.php?f=16&amp;p=159920&amp;thanks=159920&amp;to_id=36239&amp;from_id=123876" title="Say Thanks to the author of the post: jayn23"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159920#p159920" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/36239.html" class="username">jayn23</a></strong> &raquo; </span><time datetime="2020-02-12T19:18:44+00:00">Wed Feb 12, 2020 8:18 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>Currently, I am trying to reshape the weighting data to create Buffers for rpgBindBoneIndexBuffer and rpgBindBoneWeightBuffer., since the file structure looks like figures no.1 while the functions require the figure no. 2. Honestly, I am in trouble with this step since I do not know much about Python. Do you have any hints for this, or we should have another method that get rid of rpgBindBoneIndexBuffer and rpgBindBoneWeightBuffer. Thanks.</div></blockquote>

here is a working code with weights applied correctly - tested it in 3ds max, and i am using  NoeMesh() and NoeModel() so you can learn how to use them   <img class="smilies" src="./images/smilies/%5Bcolon%5D%29.gif" width="15" height="15" alt=":)" title="Smile"> <br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>from os.path import *
from math import *
from inc_noesis import *

class FileData:

    def __init__(self):
        self.BoneID = []
        self.Weights = []
        
def registerNoesisTypes():
    handle = noesis.register("unk game", ".ksw")    
    noesis.setHandlerTypeCheck(handle, noepyCheckType)
    noesis.setHandlerLoadModel(handle, noepyLoadModel)
    #opens debug consle
    #noesis.logPopup()
    return 1


def noepyCheckType(data):
    '''Verify that the format is supported by this plugin. Default yes'''
    #I preform my check while reading mesh data
    return 1


def noepyLoadModel(data, mdlList): 
     meshName = "test"
     Positions = []
     Normals = []
     UV = []
     PolygonIndex = []
     meshes = []
     VertData = []
     
     bs = NoeBitStream(data, NOE_LITTLEENDIAN)
     bs.seek(140,0)
     numMesh = bs.readInt()
     print("numMesh",numMesh)
     numVerts = bs.readInt()
     print("numVerts",numVerts)
     numFace = bs.readInt()
     print("numFace",numFace)
     unk1 = bs.readInt()
     vertOff = bs.readInt()
     normOff = bs.readInt()
     unk2 = bs.readInt()
     UVOff = bs.readInt()
     unk3 = bs.readInt()
     unk4 = bs.readInt()
     faceoff = bs.readInt()
     unk5 = bs.readInt()
     boneOff = bs.readInt()
     print("boneOff",boneOff)
     
     bs.seek(vertOff,0)
     for i in range(numVerts):
        vx = bs.readFloat()
        vy = bs.readFloat()
        vz = bs.readFloat()
        VertData.append(FileData())
        Positions.append(NoeVec3([vx,vy,vz]))
            
     bs.seek(normOff,0)
     for i in range(numVerts):
        nx = bs.readFloat()
        ny = bs.readFloat()
        nz = bs.readFloat()
        #print(str(nx ) + str(ny ) + str(nz))
        Normals.append(NoeVec3([nx,ny,nz]))
 
     bs.seek(UVOff,0)
     for i in range(numVerts):     
        tu = bs.readFloat()
        tv = bs.readFloat()
        UV.append(NoeVec3([tu,tv,0.0])) 
            
     bs.seek(faceoff,0)
     for j in range(numFace*3):
        PolygonIndex.append(bs.readInt())
            
     boneList = []
     
     bs.seek(boneOff,0)
     boneCount = bs.readUInt()
      
    # read bones loop
     for i in range(boneCount):
        # read bone name
        boneName = bs.readBytes(30).decode('utf-8', 'ignore').replace('\x00','').replace('\xCD','')
        # read parent name of the current bone
        parentBoneName = bs.readBytes(30).decode('utf-8', 'ignore').replace('\x00','').replace('\xCD','')
        # read the number of child bone
        numChildren = bs.readUInt()
        # read child bone name
        for j in range(numChildren):
            childBoneName = bs.readBytes(30).decode('utf-8', 'ignore').replace('\x00','').replace('\xCD','')
        # read 4x4 bone matrix
        boneMat = NoeMat44.fromBytes( bs.readBytes(0x40), NOE_LITTLEENDIAN )
        # convert and inverse to 4x3 matrix
        boneMat43 = boneMat.toMat43().inverse()
        # read 4x4 parent bone matrix
        parentMat = NoeMat44.fromBytes( bs.readBytes(0x40), NOE_LITTLEENDIAN )
        # convert and inverse to 4x3 matrix
        parentMat43 = parentMat.toMat43().inverse()
        # read the number of vertices deformed by this bone
        numVertices = bs.readUInt()
        if numVertices &gt; 0:
            weightList = []
            VertexList = []
            weights = []
            # read vertex IDs
            for j in range(numVertices):
                vertexID = bs.readUInt()
                VertData[vertexID].BoneID.append(i)
                VertexList.append(vertexID)
            # read weights correspondent to vertex IDs
            for j in range(numVertices):
                weight = bs.readFloat()
                VertData[VertexList[j]].Weights.append(weight)
                weights.append(weight)
 
        # set bones for Noesis to display      
        boneList.append(NoeBone(i, boneName, boneMat43, parentBoneName, parentIndex = -1)) 
       
     for k in range(numVerts):
        weightList.append(NoeVertWeight(VertData[k].BoneID, VertData[k].Weights))
        
     a = len(weightList)
     print("len weight =", a)  
     mesh = NoeMesh(PolygonIndex, Positions, meshName)
     mesh.setWeights(weightList)
     mesh.setNormals(Normals)
     mesh.setUVs(UV)
     meshes.append(mesh)
     mdl = NoeModel(meshes)   
     mdl.setBones(boneList) 
     mdlList.append(mdl)
     
     return 1
            
        </code></pre></div></div>

			
			
									
						<div id='list_thanks159920'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/36239.html" class="username">jayn23</a> for the post (total 2):</dt>
			<dd><span title="Wed Feb 12, 2020 8:30 pm"><a href="../Users/41194.html" class="username">shakotay2</a></span>, <span title="Thu Feb 13, 2020 12:57 am"><a href="../Users/83419.html" class="username">srbvn</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput159920'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;3.45%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 3.45%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159939" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile159939">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159939" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159939">

					<h3 >
						<a href="./viewtopic.php?p=159939#p159939">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159939/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159939" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159939' href="./viewtopic.php?f=16&amp;p=159939&amp;thanks=159939&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159939#p159939" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-13T15:55:21+00:00">Thu Feb 13, 2020 4:55 pm</time>
			</p>
			
			
			
			<div class="content">Yeah, it works correctly, thanks so much jayn23.<br>
I think it's time for researching animation. File structure is below, I think my code is ok except matrices part or may be the parameters for NoeAnim. I also get a warning every time load file:
<blockquote class="uncited"><div>WARNING: Number of frame matrices should be at least numBones*numFrames</div></blockquote>
Attached is example of animation files which should work for the previous model.<br>
Hope you could take a look on this. Thanks again.<br>
<a href="https://pastebin.com/4ga09TG8" class="postlink">https://pastebin.com/4ga09TG8</a><br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>MINA 4 bytes string // signature
unk1 4 bytes // 00 00 00 00
numAnim 4 bytes //Uint
frameRate 4 bytes //Uint
animName 30 bytes //string
numBones 4 bytes //Uint
numFrames 4 bytes //Uint
unk2 4 bytes // float 33 or 60
boneNames [] 30 *  numBones bytes // string
boneMatrices [] 64 * numBones * numFrames bytes // 4x4 matrices, may be not need to invert
4 bytes // end of file
</code></pre></div></div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=17498">MIN.rar</a></dt>
			<dd><em>Animation files</em></dd>			<dd>(232.16 KiB) Downloaded 13 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks159939'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/83419.html" class="username">srbvn</a> for the post: </dt>
			<dd><span title="Thu Feb 13, 2020 5:15 pm"><a href="../Users/41194.html" class="username">shakotay2</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput159939'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159950" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile159950">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/36239.html" class="username">jayn23</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=36239&amp;sr=posts">250</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jul 17, 2011 9:30 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="36239"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/true">61 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="36239"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/false">241 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact jayn23">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact jayn23</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159950" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159950">

					<h3 >
						<a href="./viewtopic.php?p=159950#p159950">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159950/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159950" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159950' href="./viewtopic.php?f=16&amp;p=159950&amp;thanks=159950&amp;to_id=36239&amp;from_id=123876" title="Say Thanks to the author of the post: jayn23"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159950#p159950" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/36239.html" class="username">jayn23</a></strong> &raquo; </span><time datetime="2020-02-13T23:57:08+00:00">Fri Feb 14, 2020 12:57 am</time>
			</p>
			
			
			
			<div class="content">Hi,<br>
<br>
I believe i found the problem:<br>
in the code below you are building a new bonelist that is not equal to your skeleton bonelist - i think this is incorrect, the animation looks at the entire skeleton, in this case it has 62 bones while animation and your new list "animBones"is using only 51 (the one that i looked at), this leads WARNING: Number of frame matrices should be at least numBones*numFrames<br>
<br>
what you need is use the skeleton bonelist and for animFrameMats is to do is per frame and bone name apply the new matrices to bones that are used, for the others that are static insert the matrix from you skeleton bone list (per frame)<br>
<br>
i hope this was clear enough if not ill try to explain better.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>for i in range(numBones):
        animBoneName = aniF.readBytes(30).decode('ascii', 'ignore').replace('\x00','').replace('\xCD','')
        for j in range(len(boneList)):
            if animBoneName == boneList[j].name:
                animBones.append(boneList[j])</code></pre></div></div>

			
			
									
						<div id='list_thanks159950'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/36239.html" class="username">jayn23</a> for the post: </dt>
			<dd><span title="Fri Feb 14, 2020 4:29 am"><a href="../Users/83419.html" class="username">srbvn</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput159950'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159969" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile159969">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159969" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159969">

					<h3 >
						<a href="./viewtopic.php?p=159969#p159969">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159969/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159969" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159969' href="./viewtopic.php?f=16&amp;p=159969&amp;thanks=159969&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159969#p159969" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-14T17:17:05+00:00">Fri Feb 14, 2020 6:17 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote cite="./viewtopic.php?p=159950#p159950"><div><cite><a href="../Users/36239.html">jayn23</a> wrote: <a href="./viewtopic.php?p=159950#p159950" data-post-id="159950" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><span class="responsive-hide">Fri Feb 14, 2020 12:57 am</span></cite>
what you need is use the skeleton bonelist and for animFrameMats is to do is per frame and bone name apply the new matrices to bones that are used, for the others that are static insert the matrix from you skeleton bone list (per frame)
</div></blockquote>
Hello,<br>
I could understand your words but I am in trouble with the algorithm. In my mind, the code should be something like this:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>bones = list of NoeBone of the model # or you call skeleton bonelist
animBones = list of bone names in the .MIN file
animMat =  list of matrices in the .MIN file
trueMat = [NoeMat43()] * numFrames * len(bones
for i in range(numFrames):
    for j in range(len(bones)):
        if bones[j].name is in [all elements of animBones[].name]:
             trueMat = bones[j].getMatrix().__mul__(current matrix of current animBones at current frame)
        else:
             trueMat = bones[j].getMatrix()
anim = NoeAnim(animName, bones , numFrames, trueMat , frameRate)</code></pre></div>

Is my thought correct? Hope you could help me to transfer to python script if the algorithm is ok. I have been trying for 2 hours but it seems not work as I expected <img class="smilies" src="./images/smilies/%5Bcolon%5DD.gif" width="15" height="15" alt=":D" title="Very Happy">.<br>
<br>
updated:<br>
Here is my current code, but it still not work, with an error "IndexError: list index out of range" at line "if boneList[j].name in [animBones[k].name for k in range(numBones)]:":<br>
A full version is at <a href="https://pastebin.com/cvSzKLRP" class="postlink">https://pastebin.com/cvSzKLRP</a>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>     # load animation -------------------------------------------------------------------
     anims = rapi.loadPairedFile("JX2 ani", ".min")
     aniF = NoeBitStream(anims)
     signature = aniF.readBytes(8)
     numAnims = aniF.readUInt()
     print('numAnims: ', numAnims)
     frameRate = aniF.readUInt()
     print('frameRate: ', frameRate)
     #animName may not be read correctly since it is Chinese string when using ascii or utf-8, 
     animName = aniF.readBytes(30).decode('ascii', 'ignore').replace('\x00','').replace('\xCD','')
     print('animName: ', animName)
     numBones = aniF.readUInt()
     print('numBones: ', numBones)
     numFrames = aniF.readUInt()
     print('numFrames: ', numFrames)
     unk6 = aniF.readBytes(4)
     animBones = []
     idBones = [-1] * len(boneList)
     for i in range(numBones):
        animBoneName = aniF.readBytes(30).decode('ascii', 'ignore').replace('\x00','').replace('\xCD','')
        for j in range(len(boneList)):
            if animBoneName == boneList[j].name:
                animBones.append(boneList[j])
                idBones[j] = i
     animFrameMats = []
     numMats = numBones * numFrames
     print('numMats: ', numMats)
     for i in range(numMats):
        frameMat44 = NoeMat44.fromBytes(aniF.readBytes(64))
        frameMat43 = frameMat44.toMat43()
        animFrameMats.append(frameMat43)
     trueFrameMats = [NoeMat43()] * numFrames * len(boneList)
     # for i in range(numFrames):
        # for j in range(len(boneList)):
            # trueFrameMats.append(boneList[j].getMatrix())
     for i in range(numFrames):
        for j in range(len(boneList)):
            curId = (i + 1) * (j + 1) - 1
            if boneList[j].name in [animBones[k].name for k in range(numBones)]:
                if idBones[j] != -1:
                    trueFrameMats[curId] = boneList[j].getMatrix().__mul__(animFrameMats[(i + 1) * (idBones[j] + 1) - 1])
                else:
                    print('Error: idBones[', j, '] is = -1')
            else:
                trueFrameMats[curId] = boneList[j].getMatrix()
     #print(len(trueFrameMats))
     anim = NoeAnim(animName, boneList, numFrames, animFrameMats, frameRate)
     #print(anim.__repr__())
     animList = []
     animList.append(anim)
</code></pre></div></div>

			
			
									
						<div id='list_thanks159969'>
</div>
<div id='div_post_reput159969'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159990" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile159990">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159990" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159990">

					<h3 >
						<a href="./viewtopic.php?p=159990#p159990">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159990/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159990" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159990' href="./viewtopic.php?f=16&amp;p=159990&amp;thanks=159990&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159990#p159990" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-15T08:51:44+00:00">Sat Feb 15, 2020 9:51 am</time>
			</p>
			
			
			
			<div class="content">Hi,<br>
Here is my current script, although it still not work correctly, I think there are some errors in the appending framematrix but have no clue how to fix them. Keep trying now   <img class="smilies" src="./images/smilies/bruceleeanim.gif" width="84" height="23" alt="[bruce]" title="hero"> .<br>
Updated part is from line 129.<br>
<a href="https://pastebin.com/cP9G8LBC" class="postlink">https://pastebin.com/cP9G8LBC</a><br>
<br>
Also, some animations may have more bones than in the model's skeleton, or vise versa. It may not affect the result, as if a bone in MIN file do not exist in skeleton, we just ignore it. If a bone in the skeleton does not exist in the MIN file, we use its original matrix for each frame. It's my thought, but the script somehow still not work  <img class="smilies" src="./images/smilies/%5Bcolon%5Dcry.gif" width="15" height="15" alt=":cry:" title="Crying or Very sad"> <br>
<br>
Hope jayn23 or someone could take a glance.<br>
Many thanks.</div>

			
			
									
						<div id='list_thanks159990'>
</div>
<div id='div_post_reput159990'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159995" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile159995">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/36239.html" class="username">jayn23</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=36239&amp;sr=posts">250</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jul 17, 2011 9:30 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="36239"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/true">61 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="36239"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/false">241 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact jayn23">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact jayn23</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159995" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159995">

					<h3 >
						<a href="./viewtopic.php?p=159995#p159995">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159995/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159995" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159995' href="./viewtopic.php?f=16&amp;p=159995&amp;thanks=159995&amp;to_id=36239&amp;from_id=123876" title="Say Thanks to the author of the post: jayn23"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159995#p159995" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/36239.html" class="username">jayn23</a></strong> &raquo; </span><time datetime="2020-02-15T16:31:58+00:00">Sat Feb 15, 2020 5:31 pm</time>
			</p>
			
			
			
			<div class="content">Sorry haven't been near my computer for the past day,<br>
<br>
ill try and write the code see if it works, i did something slimier in my total war warhammer script.<br>

<blockquote class="uncited"><div>Also, some animations may have more bones than in the model's skeleton, or vise versa. It may not affect the result, as if a bone in MIN file do not exist in skeleton, we just ignore it. If a bone in the skeleton does not exist in the MIN file, we use its original matrix for each frame. It's my thought, but the script somehow still not work</div></blockquote>
 <br>
this sounds weird, i have never seen an animation file that has more bones than the skeleton  <img class="smilies" src="./images/smilies/%28%5Bcolon%5D.gif" width="15" height="15" alt="(:" title="reverse smiley"></div>

			
			
									
						<div id='list_thanks159995'>
</div>
<div id='div_post_reput159995'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p159998" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile159998">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=159998" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content159998">

					<h3 >
						<a href="./viewtopic.php?p=159998#p159998">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/159998/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=159998" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post159998' href="./viewtopic.php?f=16&amp;p=159998&amp;thanks=159998&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=159998#p159998" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-15T18:07:53+00:00">Sat Feb 15, 2020 7:07 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote cite="./viewtopic.php?p=159995#p159995"><div><cite><a href="../Users/36239.html">jayn23</a> wrote: <a href="./viewtopic.php?p=159995#p159995" data-post-id="159995" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><span class="responsive-hide">Sat Feb 15, 2020 5:31 pm</span></cite>
this sounds weird, i have never seen an animation file that has more bones than the skeleton  <img class="smilies" src="./images/smilies/%28%5Bcolon%5D.gif" width="15" height="15" alt="(:" title="reverse smiley">
</div></blockquote>

Yes, and I think it's because there are 4 class of characters in the game that models are extracted, and some animations are only used for a specific class (which has more bones than others). I think we just ignore the animBone that not in the skeleton and see if the script work. Thanks in advance and nice weekend.</div>

			
			
									
						<div id='list_thanks159998'>
</div>
<div id='div_post_reput159998'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p160001" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile160001">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/36239.html" class="username">jayn23</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=36239&amp;sr=posts">250</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jul 17, 2011 9:30 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="36239"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/true">61 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="36239"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/false">241 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact jayn23">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact jayn23</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=160001" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content160001">

					<h3 >
						<a href="./viewtopic.php?p=160001#p160001">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/160001/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=160001" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post160001' href="./viewtopic.php?f=16&amp;p=160001&amp;thanks=160001&amp;to_id=36239&amp;from_id=123876" title="Say Thanks to the author of the post: jayn23"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=160001#p160001" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/36239.html" class="username">jayn23</a></strong> &raquo; </span><time datetime="2020-02-15T21:31:51+00:00">Sat Feb 15, 2020 10:31 pm</time>
			</p>
			
			
			
			<div class="content">So the animation i am getting is horrible so its incorrect.<br>
<br>
<strong class="text-strong">edit:</strong><br>
didn't think about it until now, but animation matrix in noesis is assumed to be in local space while the matrix in the bonelist and possibly the animation as well are in world space. so they need to be converted before we apply them, that is probably at least 1 part of the problem.<br>
<br>
ill post my code, but to be clear the animation is a mess  <img class="smilies" src="./images/smilies/%5Bcolon%5D%28.gif" width="15" height="15" alt=":(" title="Sad"> <br>
(no conversion world to local done)
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code># load animation -------------------------------------------------------------------
     anims = rapi.loadPairedFile("JX2 ani", ".min")
     aniF = NoeBitStream(anims)
     signature = aniF.readBytes(8)
     numAnims = aniF.readUInt()
     print('numAnims: ', numAnims)
     frameRate = aniF.readUInt()
     print('frameRate: ', frameRate)
     #animName may not be read correctly since it is Chinese string when using ascii or utf-8,
     animName = aniF.readBytes(30).decode('ascii', 'ignore').replace('\x00','').replace('\xCD','')
     print('animName: ', animName)
     numBones = aniF.readUInt()
     print('numBones: ', numBones)
     numFrames = aniF.readUInt()
     print('numFrames: ', numFrames)
     unk6 = aniF.readBytes(4)
     
     animBones = []
     animFrameMats = []
     
     MatIndex = []  
     MatIndex2 = []
     
     for i in range(numBones):    
        animBoneName = aniF.readBytes(30).decode('ascii', 'ignore').replace('\x00','').replace('\xCD','')
        #print(animBoneName)
        for j in range(len(boneList)):
            if animBoneName == boneList[j].name:
                MatIndex.append(j)
                MatIndex2.append(i)
                #print(boneList[j].name)
                #print("boneList[j].index",boneList[j].index)
                break

     for i in range(numFrames):
     
        TempMat = []
        
        for j in range(len(boneList)):
            TempMat.append(boneList[j].getMatrix()) 
            
        for k in range(len(MatIndex)):
            frameMat44 = NoeMat44.fromBytes(aniF.readBytes(64))
            frameMat43 = frameMat44.toMat43() 
            frameMat43 = frameMat43.inverse()
            if k in MatIndex2:
                print(k)
                TempMat[MatIndex[k]] = frameMat43
            
        animFrameMats += TempMat

     anim = NoeAnim(animName, boneList, numFrames, animFrameMats, frameRate)
     #print(anim.__repr__())
     animList = []
     animList.append(anim)</code></pre></div></div>

			
			
									
						<div id='list_thanks160001'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/36239.html" class="username">jayn23</a> for the post: </dt>
			<dd><span title="Sun Feb 16, 2020 5:40 am"><a href="../Users/83419.html" class="username">srbvn</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput160001'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p160007" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile160007">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=160007" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content160007">

					<h3 >
						<a href="./viewtopic.php?p=160007#p160007">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/160007/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=160007" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post160007' href="./viewtopic.php?f=16&amp;p=160007&amp;thanks=160007&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=160007#p160007" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-16T09:33:49+00:00">Sun Feb 16, 2020 10:33 am</time>
			</p>
			
			
			
			<div class="content"><blockquote cite="./viewtopic.php?p=160001#p160001"><div><cite><a href="../Users/36239.html">jayn23</a> wrote: <a href="./viewtopic.php?p=160001#p160001" data-post-id="160001" onclick="if(document.getElementById(hash.substr(1)))href=hash">↑</a><span class="responsive-hide">Sat Feb 15, 2020 10:31 pm</span></cite>
didn't think about it until now, but animation matrix in noesis is assumed to be in local space while the matrix in the bonelist and possibly the animation as well are in world space. so they need to be converted before we apply them, that is probably at least 1 part of the problem.
</div></blockquote>
In the model file (.ksw), there is another matrix below every bone matrix, do you think it will be useful in our case? We are currently not using it but somehow the skeleton still looks ok  <img class="smilies" src="./images/smilies/%5Bcolon%5Dp.gif" width="15" height="15" alt=":P" title="Razz"> 
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>        # read 4x4 bone matrix
        boneMat = NoeMat44.fromBytes( bs.readBytes(0x40), NOE_LITTLEENDIAN )
        # convert and inverse to 4x3 matrix
        boneMat43 = boneMat.toMat43().inverse()
        # read 4x4 parent bone matrix
        parentMat = NoeMat44.fromBytes( bs.readBytes(0x40), NOE_LITTLEENDIAN )
        # convert and inverse to 4x3 matrix
        parentMat43 = parentMat.toMat43().inverse()</code></pre></div>
I am not clear about converting from world space to local space. Do you mean we need to convert both matrices in boneList and animation, or only the animation?<br>
If trying to reconstruct matrices of boneList: boneMat43 = boneMat43.__mul__(parentMat43.inverse()) or boneMat43 = boneMat43.__mul__(parentMat43), the skeleton is so weird as images below.<br>
<img src="https://www.upsieutoc.com/images/2020/02/16/aaae1ca2d0412ae6023.png" class="postimage" alt="Image"><br>
<br>
Hope to hear interesting hints from you.</div>

			
			
									
						<div id='list_thanks160007'>
</div>
<div id='div_post_reput160007'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p160013" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile160013">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/36239.html" class="username">jayn23</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=36239&amp;sr=posts">250</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Jul 17, 2011 9:30 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="36239"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/true">61 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="36239"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/36239/false">241 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact jayn23">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact jayn23</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=160013" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content160013">

					<h3 >
						<a href="./viewtopic.php?p=160013#p160013">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/160013/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=160013" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post160013' href="./viewtopic.php?f=16&amp;p=160013&amp;thanks=160013&amp;to_id=36239&amp;from_id=123876" title="Say Thanks to the author of the post: jayn23"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=160013#p160013" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/36239.html" class="username">jayn23</a></strong> &raquo; </span><time datetime="2020-02-16T12:47:05+00:00">Sun Feb 16, 2020 1:47 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>I am not clear about converting from world space to local space. Do you mean we need to convert both matrices in boneList and animation, or only the animation?<br>
If trying to reconstruct matrices of boneList: boneMat43 = boneMat43.__mul__(parentMat43.inverse()) or boneMat43 = boneMat43.__mul__(parentMat43), the skeleton is so weird as images below.</div></blockquote>

you need to convert only the animation matrix to local space, the bonelist is expected to be in world space,<br>
here is a link to a thraed where they convert from world to local space, MrAdults is the creator of noesis so he knows what he is talking about <img class="smilies" src="./images/smilies/%5Bcolon%5Dp.gif" width="15" height="15" alt=":P" title="Razz"><br>
<a href="https://forum.xentax.com/viewtopic.php?f=16&amp;t=15065" class="postlink">viewtopic.php?f=16&amp;t=15065</a><br>

<blockquote class="uncited"><div>there is another matrix below every bone matrix, do you think it will be useful in our case? We are currently not using it but somehow the skeleton still looks ok <img class="smilies" src="./images/smilies/%5Bcolon%5Dp.gif" width="15" height="15" alt=":P" title="Razz"></div></blockquote>
i have seen some games that include both world and local space matrix, you say both matrix work without doing any conversion on either of them? hmmm</div>

			
			
									
						<div id='list_thanks160013'>
	<div class="notice">
		<dl>
			
			<dt>These users thanked the author <a href="../Users/36239.html" class="username">jayn23</a> for the post: </dt>
			<dd><span title="Sun Feb 16, 2020 2:10 pm"><a href="../Users/83419.html" class="username">srbvn</a></span></dd>
		</dl>
	</div>
</div>
<div id='div_post_reput160013'>
	<div class="notice">
		<dl>
			<dt class="small"><strong>Rating:</strong>&nbsp;1.72%</dt>
			<dd>
						<div style="width: 150px; height: 15px;" class="thanks_reput_image_back"><div style="height: 15px; width: 1.72%;" class="thanks_reput_image"></div></div>&nbsp;
						</dd>
		</dl>
	</div>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p160015" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile160015">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=160015" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content160015">

					<h3 >
						<a href="./viewtopic.php?p=160015#p160015">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/160015/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=160015" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post160015' href="./viewtopic.php?f=16&amp;p=160015&amp;thanks=160015&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=160015#p160015" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-16T13:09:56+00:00">Sun Feb 16, 2020 2:09 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>
you need to convert only the animation matrix to local space, the bonelist is expected to be in world space,<br>
here is a link to a thraed where they convert from world to local space, MrAdults is the creator of noesis so he knows what he is talking about <img class="smilies" src="./images/smilies/%5Bcolon%5Dp.gif" width="15" height="15" alt=":P" title="Razz"><br>
<a href="https://forum.xentax.com/viewtopic.php?f=16&amp;t=15065" class="postlink">viewtopic.php?f=16&amp;t=15065</a>
</div></blockquote>
Thanks, I will spend time for this thread. <img class="smilies" src="./images/smilies/%5Bcolon%5DD.gif" width="15" height="15" alt=":D" title="Very Happy"> 
<blockquote class="uncited"><div>
i have seen some games that include both world and local space matrix, you say both matrix work without doing any conversion on either of them? hmmm
</div></blockquote>
No, as you see in the script, I mean we append only the <strong class="text-strong">boneMat43</strong> to the boneList while there is nothing to do with <strong class="text-strong">parentMat43</strong>. The latter is named "parentMat43" just because I guess so (and not sure  <img class="smilies" src="./images/smilies/%5Bcolon%5DD.gif" width="15" height="15" alt=":D" title="Very Happy"> ). I wonder how could we check if <strong class="text-strong">boneMat43 </strong>is the worldspace matrix and <strong class="text-strong">parentMat43 </strong> is the localspace matrix (and not the matrix of parent bone like I guess)? Anyway, I could not thank enough for your help, and I will update here soon about my work.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>	# read 4x4 bone matrix
        boneMat = NoeMat44.fromBytes( bs.readBytes(0x40), NOE_LITTLEENDIAN )
        # convert and inverse to 4x3 matrix
        boneMat43 = boneMat.toMat43().inverse()
        # read 4x4 parent bone matrix
        parentMat = NoeMat44.fromBytes( bs.readBytes(0x40), NOE_LITTLEENDIAN )
        # convert and inverse to 4x3 matrix
        parentMat43 = parentMat.toMat43().inverse()</code></pre></div></div>

			
			
									
						<div id='list_thanks160015'>
</div>
<div id='div_post_reput160015'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p160018" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile160018">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="../Users/83419.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=83419_1581702244.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="../Users/83419.html" class="username">srbvn</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=83419&amp;sr=posts">17</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Thu Oct 03, 2019 11:10 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="83419"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/true">15 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="83419"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/83419/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact srbvn">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact srbvn</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=160018" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content160018">

					<h3 >
						<a href="./viewtopic.php?p=160018#p160018">Re: [Help] Weights issue in Noesis script</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/160018/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=160018" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post160018' href="./viewtopic.php?f=16&amp;p=160018&amp;thanks=160018&amp;to_id=83419&amp;from_id=123876" title="Say Thanks to the author of the post: srbvn"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=160018#p160018" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/83419.html" class="username">srbvn</a></strong> &raquo; </span><time datetime="2020-02-16T14:14:34+00:00">Sun Feb 16, 2020 3:14 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote class="uncited"><div>
you need to convert only the animation matrix to local space, the bonelist is expected to be in world space,<br>
here is a link to a thraed where they convert from world to local space, MrAdults is the creator of noesis so he knows what he is talking about <img class="smilies" src="./images/smilies/%5Bcolon%5Dp.gif" width="15" height="15" alt=":P" title="Razz"><br>
viewtopic.php?f=16&amp;t=15065
</div></blockquote>
I try to mimic the script in the thread provided. Unfortunately, the result is still a mess  <img class="smilies" src="./images/smilies/%5Bcolon%5D%5B.gif" width="15" height="15" alt=":[" title="Unhappy"> . Could you help to take a glance if I need to modify something? Here is the full version: <a href="https://pastebin.com/eWxmzYZj" class="postlink">https://pastebin.com/eWxmzYZj</a>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>     for i in range(numFrames):
        TempMat = []
            
        for j in range(len(boneList)):
            TempMat.append(boneList[j].getMatrix()) 
            
        for k in range(len(MatIndex)):
            frameMat44 = NoeMat44.fromBytes(aniF.readBytes(64))
            frameMat43 = frameMat44.toMat43() 
            frameMat43 = frameMat43.inverse()
            if k in MatIndex2:
                # print(k)
                TempMat[MatIndex[k]] =  TempMat[MatIndex[k]] * frameMat43
                # check if current bone have parent
                if boneList[MatIndex[k]].parentName != 'Scene Root':
                    # get index of the parentBone in boneList 
                    x = [boneList[y].name for y in range(boneCount)].index(boneList[MatIndex[k]].parentName)
                    TempMat[MatIndex[k]] = TempMat[MatIndex[k]] * TempMat[x].inverse()
            
        animFrameMats += TempMat

     anim = NoeAnim(animName, boneList, numFrames, animFrameMats, frameRate)
     animList = []
     animList.append(anim)</code></pre></div></div>

			
			
									
						<div id='list_thanks160018'>
</div>
<div id='div_post_reput160018'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=21731" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=16&amp;t=21731&amp;watch=topic&amp;start=0&amp;hash=eb4b93cd" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=16&amp;t=21731&amp;unwatch=topic&amp;start=0&amp;hash=eb4b93cd" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=21731&amp;bookmark=1&amp;hash=eb4b93cd" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=21731" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=21731&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=21731">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			19 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./21731 (1).html" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./21731 (1).html" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=16" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “3D/2D models”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Bing [Bot]</span>, <a href="../Users/123876.html" class="username">escape209</a> and 4 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="../Navigation/index.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
