<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Skeletal animations from .anm file (renderware ps2) - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=24912">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="./ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="./index.php" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="./index.php" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="http://forum.xentax.com/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="./memberlist.php?mode=viewprofile&u=123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=959ea14a0771cc2de19d1bba114b7679" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="./index.php" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="16"><a itemprop="item" href="./viewforum.php?f=16"><span itemprop="name">3D/2D models</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./24912.html">Skeletal animations from .anm file (renderware ps2)</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">Post questions about game models here, or help out others!<br /></div>

	<div class="rules rules-link">
		<div class="inner">

					<a href="http://forum.xentax.com/viewtopic.php?f=28&amp;t=1270">Forum rules</a>
		
		</div>
	</div>

<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=24912" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=16&amp;t=24912&amp;watch=topic&amp;start=0&amp;hash=c550f9e9" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=16&amp;t=24912&amp;unwatch=topic&amp;start=0&amp;hash=c550f9e9" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=24912&amp;bookmark=1&amp;hash=c550f9e9" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=24912" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=24912&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topicâ€¦" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="24912" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			6 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
		</div>




			<div id="p181003" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile181003">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=58360&amp;sr=posts">8</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 10, 2016 8:49 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="58360"></dd>
    <dd class="profile-posts" data-user-receive-id="58360"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/58360/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact alecss131">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact alecss131</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=181003" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content181003">

					<h3 class="first">
							<img src="./images/icons/smile/question.gif" width="16" height="16" alt="" title="">
						<a href="./viewtopic.php?p=181003#p181003">Skeletal animations from .anm file (renderware ps2)</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/181003/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=181003" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post181003' href="./viewtopic.php?f=16&amp;p=181003&amp;thanks=181003&amp;to_id=58360&amp;from_id=123876" title="Say Thanks to the author of the post: alecss131"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=181003#p181003" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a></strong> &raquo; </span><time datetime="2022-01-03T10:27:49+00:00">Mon Jan 03, 2022 11:27 am</time>
			</p>
			
			
			
			<div class="content">I found this description
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>RpHAnimAnimation	.anm

HAnimAnimation chunk header (0x1B)
	RwInt32                     0x100
	RwInt32                     interpolation type id (1 = RpHAnimStd)
	RwInt32                     numFrames
	RwInt32                     flags
	RwReal                      duration
	numFrames*sizeof(keyFrame)  key frames

serialized format of RpHAnimStdKeyFrame:
	RwReal      time
	RtQuat      q     // quaternion describing rotation
	RwV3d       t     // position
	RwInt32     prev  // should be offset of previous key frame from beginning of frame data but appears to be junk

PS2 .ska (skeletal animation) are almost the same format.
They have no chunk header nor the first two ints (so a file starts at numFrames directly).
In key frames the time comes after t, not before q.</code></pre></div>
But this wrong.<br>
My data is
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>1B 00 00 00 3C 09 00 00 65 00 02 1C 00 01 00 00 
03 11 00 00 74 00 00 00 00 00 00 00 89 88 88 3D 
C6 B4 96 BE 8D 33 DD BE 27 D1 91 BD 00 00 80 3F 
4E 4E 11 40 00 00 80 3F ...</code></pre></div>
where
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>1B 00 00 00 - chunk id (Anim Animation)
3C 09 00 00 - size (without this header, after version) - 2364
65 00 02 1C - engine version 3.7.0.1
00 01 00 00 - Version: animation's version format (in all GTAs - 1.0 (0x100))
03 11 00 00 - Type: defines the frame format, 0x01 - normal,  0x02 - compressed, but what this (03 11) means?
74 00 00 00 - Frames: number of frames defined in the container - 116
00 00 00 00 - Flags</code></pre></div>
after follow 7 floats (28 bytes), unknown and numframes of char[8] + numframes of char[12] (you can clearly see the different structure of bytes in these 2 parts, and therefore divided), or just numframes of char[20].<br>
if type 0x01 then 36 bytes per frame, if 0x02 then 22 bytes per frame, but i have only 20<br>
File example in attachment</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=21497">PC_TG_LockOn_Idle.7z</a></dt>
						<dd>(937 Bytes) Downloaded 9 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks181003'>
</div>
<div id='div_post_reput181003'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p181144" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile181144">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=58360&amp;sr=posts">8</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 10, 2016 8:49 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="58360"></dd>
    <dd class="profile-posts" data-user-receive-id="58360"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/58360/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact alecss131">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact alecss131</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=181144" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content181144">

					<h3 >
						<a href="./viewtopic.php?p=181144#p181144">Re: Skeletal animations from .anm file (renderware ps2)</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/181144/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=181144" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post181144' href="./viewtopic.php?f=16&amp;p=181144&amp;thanks=181144&amp;to_id=58360&amp;from_id=123876" title="Say Thanks to the author of the post: alecss131"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=181144#p181144" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a></strong> &raquo; </span><time datetime="2022-01-06T20:18:36+00:00">Thu Jan 06, 2022 9:18 pm</time>
			</p>
			
			
			
			<div class="content">I have completed the mesh exporter. <a href="https://www19.zippyshare.com/v/itwpBmjY/file.html" class="postlink">This</a> mesh for animation (with skin and skeleton). Have 53 bones.<br>
<br>
Found a pattern in anm files. After 7 unknown floats follow this struct
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct ver1{
    int8_t un[4];
    float time;
};</code></pre></div>
always with zero float (time?) and their number equal to the number of bones. in all files
<div class="inline-attachment">
			
		
				<dl class="file">
			<dt class="attach-image"><img src="./download/file.php?id=21543" class="postimage" alt="Screenshot_35.png" onclick="viewableArea(this);" /></dt>
						<dd>Screenshot_35.png (66.92 KiB) Viewed 170 times</dd>
		</dl>
		
		
			</div></div>

			
			
									
						<div id='list_thanks181144'>
</div>
<div id='div_post_reput181144'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p181193" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile181193">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=58360&amp;sr=posts">8</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 10, 2016 8:49 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="58360"></dd>
    <dd class="profile-posts" data-user-receive-id="58360"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/58360/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact alecss131">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact alecss131</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=181193" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content181193">

					<h3 >
						<a href="./viewtopic.php?p=181193#p181193">Re: Skeletal animations from .anm file (renderware ps2)</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/181193/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=181193" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post181193' href="./viewtopic.php?f=16&amp;p=181193&amp;thanks=181193&amp;to_id=58360&amp;from_id=123876" title="Say Thanks to the author of the post: alecss131"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=181193#p181193" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a></strong> &raquo; </span><time datetime="2022-01-08T11:46:41+00:00">Sat Jan 08, 2022 12:46 pm</time>
			</p>
			
			
			
			<div class="content">Some new information.<br>
Standard header, with new unknown field
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct Head {
    uint32_t version; //always 0x100, gta
    uint32_t type; //always 0x1103
    uint32_t count; //number of "packets"
    uint32_t flags; //always 0
    float length; //time length of animation
    float unknown[6];
};</code></pre></div>
Then 2 structures follow with number of number of packets each
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct Data0{ 
    int8_t unknown[4];
    float time;
};
struct Data1{
    int8_t unknown[12];
};</code></pre></div>
Together
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>struct File{
    uint32_t type; //0x1B anim animation
    uint32_t size;
    uint32_t version; //engine version 3.7.0.1
    Head head;
    Data0 data0[head.count];
    Data1 data1[head.count];
};</code></pre></div>
For now trying to understand the structure of data0. Unknown 4 bytes, then time goes by. First comes the number of structures with zero time equal to the number of bones. Then there are packets with other times, and there are as many packets with a finite time as there are bones, and there are no more intermediate ones than bones.<br>
A few words about the unknown 4 bytes. Packets with zero time of the last bit always have 0x83 and one common penultimate, and all the others packets have two last bytes 0. At the same time, there are a lot of repetes.<br>
Judging by the timestamps and the total animation time, the frame rate is always 30 fps. Time step always 0.0333.<br>
I attach a longer and more understandable walk animation. <br>
It is necessary to understand the sequence of packets for each bone, to which bone these sequences belong and what information is in them. Although usually there should be translations (for skeletal I think it is not necessary) and rotations (usually in the form of quaternions)<br>
<strong class="text-strong">PC</strong> in file names is <strong class="text-strong">P</strong>layable <strong class="text-strong">C</strong>haracter</div>

			
							<dl class="attachbox">
					<dt>
						Attachments
					</dt>
											<dd>
			
		
		
				<dl class="file">
			<dt><span class="imageset icon_topic_attach"></span> <a class="postlink" href="./download/file.php?id=21551">PC_TG_Walk.7z</a></dt>
						<dd>(3.88 KiB) Downloaded 7 times</dd>
		</dl>
		
			</dd>
									</dl>
			
									
						<div id='list_thanks181193'>
</div>
<div id='div_post_reput181193'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p181229" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile181229">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=58360&amp;sr=posts">8</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 10, 2016 8:49 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="58360"></dd>
    <dd class="profile-posts" data-user-receive-id="58360"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/58360/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact alecss131">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact alecss131</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=181229" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content181229">

					<h3 >
						<a href="./viewtopic.php?p=181229#p181229">Re: Skeletal animations from .anm file (renderware ps2)</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/181229/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=181229" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post181229' href="./viewtopic.php?f=16&amp;p=181229&amp;thanks=181229&amp;to_id=58360&amp;from_id=123876" title="Say Thanks to the author of the post: alecss131"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=181229#p181229" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a></strong> &raquo; </span><time datetime="2022-01-09T12:11:06+00:00">Sun Jan 09, 2022 1:11 pm</time>
			</p>
			
			
			
			<div class="content">Found in the documentation words about the order of frames.<br>

<blockquote class="uncited"><div>The keyframe data does not contain an explicit link to the node it will be applied to. Instead, it is determined implicitly from the ordering of the keyframes in the array. For data cache coherence, the keyframes are sorted in time order.<br>
Each and every node has a keyframe at the beginning and end of the<br>
animation. Then there are optional additional keyframes in-between. The first keyframe is stored for each node in turn, then the second for each node in turn. These are used to initialize the first interpolation for each node.<br>
<br>
An unordered array of keyframes may be sorted in a conventional way<br>
using the following as primary and secondary sort keys:<br>
1. The time of the previous keyframe for the node<br>
2. The node index</div></blockquote>

I have 53 bones (nodes) and frames (packets) ordered by this (hopefully right ) for PC_TG_LockOn_Idle.anm<br>
format string: data0.unknown * data1.unknown  #  data0.unknown * data1.unknown  #
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>B8 41 38 83 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  
CC 41 38 83 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  
E0 41 38 83 * 7E EB A6 7D EB DF B3 49 90 9C 5C 18  #  24 04 00 00 * 7E EB A6 7D EB DF B3 49 90 9C 5C 18  #  
F4 41 38 83 * 80 00 88 7C FE 0F 5A 4B DE 2B 89 12  #  24 04 00 00 * 80 00 88 7C FE 0F 5A 4B DE 2B 89 12  #  
08 42 38 83 * 8D C6 78 6A CC 2F 21 64 5C 2C 3E 0F  #  24 04 00 00 * 8D C6 78 6A CC 2F 21 64 5C 2C 3E 0F  #  
1C 42 38 83 * 7E 14 D8 9D C6 CF 41 51 00 00 C2 15  #  24 04 00 00 * 7E 14 D8 9D C6 CF 41 51 00 00 C2 15  #  
30 42 38 83 * 79 F3 F7 7E FB 2F 41 50 7E 02 00 00  #  24 04 00 00 * 79 F3 F7 7E FB 2F 41 50 7E 02 00 00  #  
44 42 38 83 * 80 00 08 80 FF 0F 5A 4B EC 25 38 2E  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B EC 25 38 2E  #  
58 42 38 83 * 72 E8 45 84 AA CF 92 32 5C 2C 3E 0F  #  24 04 00 00 * 72 E8 45 84 AA CF 92 32 5C 2C 3E 0F  #  
6C 42 38 83 * 80 EF B7 97 DB FF 73 45 00 00 C2 15  #  24 04 00 00 * 80 EF B7 97 DB FF 73 45 00 00 C2 15  #  
80 42 38 83 * 8E 8B D7 6D D9 4F 72 46 7E 02 00 00  #  24 04 00 00 * 8E 8B D7 6D D9 4F 72 46 7E 02 00 00  #  
94 42 38 83 * 80 00 08 80 FF 0F 5A 4B EC 25 38 2E  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B EC 25 38 2E  #  
A8 42 38 83 * 7A 37 87 7E F3 DF 5A 4B EC 37 15 11  #  24 04 00 00 * 7A 37 87 7E F3 DF 5A 4B EC 37 15 11  #  
BC 42 38 83 * 7F 2B B7 8A EC CF 5A 4B C4 3E 52 10  #  24 04 00 00 * 7F 2B B7 8A EC CF 5A 4B C4 3E 52 10  #  20 03 00 00 * 7F 2B B7 8A EC CF 5A 4B C4 3E 52 10  #  
D0 42 38 83 * 80 2C 97 88 EF DF 5A 4B 73 42 0B 10  #  24 04 00 00 * 80 2C 97 88 EF DF 5A 4B 73 42 0B 10  #  20 03 00 00 * 80 2C 97 88 EF DF 5A 4B 73 42 0B 10  #  
E4 42 38 83 * 81 AC C7 85 FB 7F 5A 4B F2 3F 2E 0B  #  24 04 00 00 * 81 AC B7 85 FB 7F 5A 4B F2 3F 2E 0B  #  20 03 00 00 * 81 AC C7 85 FB 7F 5A 4B F2 3F 2E 0B  #  
F8 42 38 83 * 7E 94 E9 79 D4 CF C8 5D DD 32 A6 25  #  24 04 00 00 * 7E 94 E9 79 D4 DF C8 5D DD 32 A6 25  #  20 03 00 00 * 7E 94 E9 79 D4 CF C8 5D DD 32 A6 25  #  
0C 43 38 83 * 4E 06 18 5A F7 1E 1E 6C B1 30 33 04  #  24 04 00 00 * 4E 06 18 5A F7 1E 1E 6C B1 30 33 04  #  
20 43 38 83 * 73 89 31 7F A1 0C 08 96 D2 2F 63 0D  #  24 04 00 00 * 73 89 31 7F A1 0C 08 96 D2 2F 63 0D  #  
34 43 38 83 * 7B D1 97 7A FB BF D8 92 D0 2F FF 1B  #  24 04 00 00 * 7B D1 97 7A FB BF D8 92 D0 2F FF 1B  #  
48 43 38 83 * 58 8A 36 A5 15 3F 39 54 51 2F 39 1B  #  24 04 00 00 * 58 8A 36 A5 15 3F 39 54 51 2F 39 1B  #  
5C 43 38 83 * 8C 11 9A 8F 9E FF D0 57 05 32 03 10  #  24 04 00 00 * 8C 11 9A 8F 9E FF D0 57 05 32 03 10  #  
70 43 38 83 * 8B 00 08 80 F7 3F 16 5C B6 30 C3 10  #  24 04 00 00 * 8B 00 08 80 F7 3F 16 5C B6 30 C3 10  #  
84 43 38 83 * 7C 26 04 F0 21 B8 B0 55 27 31 58 17  #  24 04 00 00 * 7C 26 04 F0 21 B8 B0 55 27 31 58 17  #  
98 43 38 83 * 82 78 AA F9 F4 07 0A 54 B6 30 3A 12  #  24 04 00 00 * 82 78 AA F9 F4 07 0A 54 B6 30 3A 12  #  
AC 43 38 83 * 7C 30 64 F0 01 F8 26 53 B6 30 3A 12  #  24 04 00 00 * 7C 30 64 F0 01 F8 26 53 B6 30 3A 12  #  
C0 43 38 83 * 38 00 08 80 A0 6E AB 57 11 30 20 11  #  24 04 00 00 * 28 00 08 80 CF 3D AB 57 11 30 20 11  #  6C 02 00 00 * 1A 00 08 80 D8 4C AB 57 11 30 20 11  #  
D4 43 38 83 * 26 88 67 85 A8 2D DB 57 69 2F 21 11  #  24 04 00 00 * 2E 82 A7 81 27 BE DB 57 69 2F 21 11  #  6C 02 00 00 * 38 6F 17 7E 94 0E DB 57 69 2F 21 11  #  
E8 43 38 83 * 80 00 38 91 EC 0F 5A 4B FA 3D EB 18  #  24 04 00 00 * 80 00 38 91 EC 0F 5A 4B FA 3D EB 18  #  6C 02 00 00 * 80 00 38 91 EC 0F 5A 4B FA 3D EB 18  #  
FC 43 38 83 * 6D 77 7B 6F 0A FF 5A 4B 15 38 3E 16  #  24 04 00 00 * 6D 77 7B 6F 0A FF 5A 4B 15 38 3E 16  #  
10 44 38 83 * 7E 14 18 7E FE FF 6B 52 29 3A F7 26  #  24 04 00 00 * 7E 14 18 7E FE FF 6B 52 29 3A F7 26  #  
24 44 38 83 * 7E 14 18 7E FE FF 7F 42 DF 39 F2 26  #  24 04 00 00 * 7E 14 18 7E FE FF 7F 42 DF 39 F2 26  #  
38 44 38 83 * 6B 15 38 FE BA 87 EB 38 D0 32 AB 25  #  24 04 00 00 * 6B 13 38 FE BB 87 EB 38 D0 32 AB 25  #  30 02 00 00 * 6B 15 38 FE BA 87 EB 38 D0 32 AB 25  #  
4C 44 38 83 * 4A 85 75 8B CA AE 95 2A AF 30 37 20  #  24 04 00 00 * 4A 85 75 8B CA AE 95 2A AF 30 37 20  #  
60 44 38 83 * 88 9E 81 73 B9 1C 00 00 9A 31 11 17  #  24 04 00 00 * 88 9E 81 73 B9 1C 00 00 9A 31 11 17  #  
74 44 38 83 * 7C 52 67 7C F5 8F DB 03 9D 31 75 08  #  24 04 00 00 * 7C 52 67 7C F5 8F DB 03 9D 31 75 08  #  
88 44 38 83 * 9B 66 4F A4 0E 49 3D 44 0E 32 93 0A  #  24 04 00 00 * 9B 66 4F A4 0E 49 3D 44 0E 32 93 0A  #  
9C 44 38 83 * A7 49 B9 64 4B AF 5C 58 F7 31 A5 15  #  24 04 00 00 * A7 49 B9 64 4B AF 5C 58 F7 31 A5 15  #  E0 01 00 00 * A7 49 B9 64 4B AF 5C 58 F7 31 A5 15  #  
B0 44 38 83 * 67 00 08 80 D9 BF 9D 3A B6 30 B0 13  #  24 04 00 00 * 67 00 08 80 D9 BF 9D 3A B6 30 B0 13  #  
C4 44 38 83 * 8C 8D FE C6 2A D7 54 42 17 32 13 0C  #  24 04 00 00 * 8C 8D FE C6 2A D7 54 42 17 32 13 0C  #  
D8 44 38 83 * E2 3A 88 66 E1 0C D9 54 B8 30 BA 14  #  24 04 00 00 * E2 3A 88 66 E1 0C D9 54 B8 30 BA 14  #  
EC 44 38 83 * CB 47 28 66 3D 8E 88 52 B8 30 2F 14  #  24 04 00 00 * CB 47 28 66 3D 8E 88 52 B8 30 2F 14  #  
00 45 38 83 * 5D 49 59 F9 7B E8 76 45 59 36 6F 10  #  24 04 00 00 * 5D 49 59 F9 7B E8 76 45 59 36 6F 10  #  
14 45 38 83 * 31 7D 18 76 42 7E 08 3F 5C 31 53 13  #  24 04 00 00 * 2C 3E D8 7B 0A 6E 08 3F 5C 31 53 13  #  7C 01 00 00 * 27 F8 27 81 C9 CD 08 3F 5C 31 53 13  #  
28 45 38 83 * 2D 00 08 80 20 DE D8 3E 03 32 52 13  #  24 04 00 00 * 1E 00 08 80 2E 9D D8 3E 03 32 52 13  #  
3C 45 38 83 * 80 00 38 96 DF 0F 95 6A 0B 29 56 4C  #  24 04 00 00 * 80 00 38 96 DF 0F 95 6A 0B 29 56 4C  #  
50 45 38 83 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  
64 45 38 83 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  
78 45 38 83 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  
8C 45 38 83 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B B6 30 3A 12  #  
A0 45 38 83 * 80 00 08 80 FF 0F 5A 4B FE FF EA 17  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B FE FF EA 17  #  
B4 45 38 83 * 80 00 08 80 FF 0F 5A 4B BB 3B 9E 12  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B BB 3B 9E 12  #  
C8 45 38 83 * 80 00 08 80 FF 0F 5A 4B 3A EC A4 14  #  24 04 00 00 * 80 00 08 80 FF 0F 5A 4B 3A EC A4 14  # </code></pre></div>
it turns out 12 bytes per frame, not counting the first 4. it remains to understand how to decrypt them</div>

			
			
									
						<div id='list_thanks181229'>
</div>
<div id='div_post_reput181229'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p181230" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile181230">
			<dt class="has-profile-rank has-avatar">
				<div class="avatar-container">
																<a href="./memberlist.php?mode=viewprofile&u=41194.html" class="avatar"><img class="avatar" src="./download/file.php?avatar=41194_1430129462.jpg" width="120" height="120" alt="User avatar" /></a>														</div>
								<a href="./memberlist.php?mode=viewprofile&u=41194.html" class="username">shakotay2</a>							</dt>

						<dd class="profile-rank">MEGAVETERAN<br /><img src="./images/ranks/vip-2.png" alt="MEGAVETERAN" title="MEGAVETERAN" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=41194&amp;sr=posts">4293</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Fri Apr 20, 2012 9:24 am</dd>		
		
											<dd class="profile-custom-field profile-phpbb_location"><strong>Location:</strong> Nexus, searching for Jim Kirk</dd>
							    <dd class="profile-posts" data-user-give-id="41194"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/41194/true">1152 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="41194"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/41194/false">2245 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact shakotay2">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact shakotay2</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=181230" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content181230">

					<h3 >
						<a href="./viewtopic.php?p=181230#p181230">Re: Skeletal animations from .anm file (renderware ps2)</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/181230/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=181230" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post181230' href="./viewtopic.php?f=16&amp;p=181230&amp;thanks=181230&amp;to_id=41194&amp;from_id=123876" title="Say Thanks to the author of the post: shakotay2"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=181230#p181230" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=41194.html" class="username">shakotay2</a></strong> &raquo; </span><time datetime="2022-01-09T12:35:32+00:00">Sun Jan 09, 2022 1:35 pm</time>
			</p>
			
			
			
			<div class="content">If you have 6 bytes for translation and 6 bytes for rotation "League of legends" comes into my mind<br>
and fatduck's quatDecompress(). Just as a thought, not checked...</div>

			
			
									
						<div id='list_thanks181230'>
</div>
<div id='div_post_reput181230'>
</div>

							<div id="sig181230" class="signature">Tuts: a) Bigchillghost, <a href="https://forum.xentax.com/viewtopic.php?f=29&amp;t=17889" class="postlink">viewtopic.php?f=29&amp;t=17889</a><br>
b) Extracting simple models: <a href="http://forum.xentax.com/viewtopic.php?f=29&amp;t=10894" class="postlink">http://forum.xentax.com/viewtopic.php?f=29&amp;t=10894</a><br>
"Quoting the whole thing. Would u ever stop this nonsense?"</div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p181258" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile181258">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a>							</dt>

						<dd class="profile-rank">ultra-n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=58360&amp;sr=posts">8</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Wed Aug 10, 2016 8:49 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="58360"></dd>
    <dd class="profile-posts" data-user-receive-id="58360"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/58360/false">1 time</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact alecss131">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact alecss131</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=181258" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content181258">

					<h3 >
						<a href="./viewtopic.php?p=181258#p181258">Re: Skeletal animations from .anm file (renderware ps2)</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/181258/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=181258" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post181258' href="./viewtopic.php?f=16&amp;p=181258&amp;thanks=181258&amp;to_id=58360&amp;from_id=123876" title="Say Thanks to the author of the post: alecss131"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=181258#p181258" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=58360.html" class="username">alecss131</a></strong> &raquo; </span><time datetime="2022-01-10T07:35:28+00:00">Mon Jan 10, 2022 8:35 am</time>
			</p>
			
			
			
			<div class="content">This code?
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>def quatDecompress(s0,s1,s2):  
  tmp0= s0&gt;&gt;15 
  tmp1= (s1*2+tmp0) &amp; 0x7FFF
  s0= s0 &amp; 0x7FFF ;
  tmp2= s2*4 ;
  tmp2= (s2*4+ (s1&gt;&gt;14)) &amp; 0x7FFF ;
  s1= tmp1 ;
  AxisFlag= s2&gt;&gt;13 ;
  s2= tmp2 ;
  f0 = 1.41421*(s0-0x3FFF)/0x7FFF ;
  f1 = 1.41421*(s1-0x3FFF)/0x7FFF ;
  f2 = 1.41421*(s2-0x3FFF)/0x7FFF ;  
  f3 = sqrt(1.0-(f0*f0+f1*f1+f2*f2))
  if AxisFlag==3:x= f2;y= f1;z= f0;w= f3
  if AxisFlag==2:x= f2;y= f1;z= f3;w= f0
  if AxisFlag==1:x= f2;y= f3;z= f1;w= f0
  if AxisFlag==0:x= f3;y= f2;z= f1;w= f0
  return x,y,z,w  </code></pre></div>
I got weird numbers, none of the bones have zero rotations.<br>
And I also donâ€™t understand why skeletal animation have tranlation when bones can only rotate.<br>
The engine has compressed floats, to uint16. My founded code (from maxscript), and not work for me
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>    private fn DecompressFloat compressed =
    (
        local floatInt = bit.shift (bit.and compressed 0x8000) 16
        if ((bit.and compressed 0x7fff) != 0) then
        (
            floatInt = bit.or floatInt ((bit.shift (bit.and compressed 0x7800) 12) + 0x38000000)
            floatInt = bit.or floatInt (bit.shift (bit.and compressed 0x07ff) 12)
        )

        bit.intasfloat floatInt
    ),</code></pre></div>
The engine is highly modifiable and can have anything. For example, bone indices were packed into their respective weights (uint8 into float). Code for unpack
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>uint8_t extractIndex(float in) {
    uint32_t tmp{bit_cast&lt;uint32_t&gt;(in)};
    uint8_t out{static_cast&lt;uint8_t&gt;(tmp &gt;&gt; 2)};
    if (out &gt; 0) out--;
    return out;
}</code></pre></div>
Another finding of a pattern. The first byte in data0.unknown usually has the form X0, X4, X8 or XC, that is, the last 2 bits are always 0. But this numbers with &gt;&gt;2 bigger then number of bones.<br>
Indices in delta morph has RLE compression. Or some files in Sonic Heroes have PRS compression. In my game files in archive use zlib compression.</div>

			
			
									
						<div id='list_thanks181258'>
</div>
<div id='div_post_reput181258'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=24912" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=16&amp;t=24912&amp;watch=topic&amp;start=0&amp;hash=c550f9e9" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=16&amp;t=24912&amp;unwatch=topic&amp;start=0&amp;hash=c550f9e9" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=24912&amp;bookmark=1&amp;hash=c550f9e9" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=24912" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=24912&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=24912">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			6 posts
							&bull; Page <strong>1</strong> of <strong>1</strong>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=16" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to â€œ3D/2D modelsâ€</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Ahrefs [Bot]</span>, <span style="color: #9E8DA7;" class="username-coloured">Bing [Bot]</span>, <a href="./memberlist.php?mode=viewprofile&u=36806.html" class="username">Casedey</a>, <a href="./memberlist.php?mode=viewprofile&u=119893.html" class="username">DataKeeper</a>, <a href="./memberlist.php?mode=viewprofile&u=123876.html" class="username">escape209</a> and 4 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="./index.php" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
