<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Kornet's Format Information - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=1280">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="./assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="./styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="./styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="./ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="./ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="./index.php" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="./index.php" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="http://forum.xentax.com/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="./memberlist.php?mode=viewprofile&u=123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=9c649842ae48bcd04444257bd025d4a2" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="./index.php" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="10"><a itemprop="item" href="./viewforum.php?f=10"><span itemprop="name">Game Archive</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./1280.html">Kornet's Format Information</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">The Original Forum. Game archives, full of resources. How to open them? Get help here.<br /></div>

	<div class="rules rules-link">
		<div class="inner">

					<a href="http://forum.xentax.com/viewtopic.php?f=28&amp;t=1270">Forum rules</a>
		
		</div>
	</div>

<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=1280" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=10&amp;t=1280&amp;watch=topic&amp;start=0&amp;hash=a0e387e5" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=10&amp;t=1280&amp;unwatch=topic&amp;start=0&amp;hash=a0e387e5" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=1280&amp;bookmark=1&amp;hash=a0e387e5" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=1280" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=1280&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topic…" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="1280" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			21 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./viewtopic.php?t=1280&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./viewtopic.php?t=1280&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




			<div id="p8655" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8655">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8655" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8655">

					<h3 class="first">
						<a href="./viewtopic.php?p=8655#p8655"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8655/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8655" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8655' href="./viewtopic.php?f=10&amp;p=8655&amp;thanks=8655&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8655#p8655" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:30:16+00:00">Thu May 26, 2005 12:30 am</time>
			</p>
			
			
			
			<div class="content">FlatOut BFS format <br>
P.S - Pascal (Delphi) code <img class="smilies" src="./images/smilies/%5Bcolon%5DD.gif" width="15" height="15" alt=":D" title="Very Happy"> <br>
<br>
<strong class="text-strong">unit</strong> BfsReader;<br>
<br>
<strong class="text-strong">interface</strong><br>
<br>
<strong class="text-strong">uses</strong><br>
  Classes, SysUtils, ZLib;<br>
<br>
<strong class="text-strong">type</strong><br>
  TBfsHeader = record<br>
    Marker: Cardinal;<br>
    Version: Cardinal;<br>
    DataOffset: Cardinal;<br>
    NumEntries: Cardinal;<br>
  <strong class="text-strong">end;</strong><br>
<br>
  TBfsEntry = packed record<br>
    Info: packed record<br>
      CompMethod: Cardinal; // 4 = raw, 5 = zlib<br>
      DataOffs: Cardinal;<br>
      Size: Cardinal;<br>
      CompSize: Cardinal;<br>
      CheckSum: Integer; // Checksum of compressed data. read as signed int, remove the sign and - 1 and you have the crc32. I.E checksum = -165278610 crc32 = 165278609<br>
      NameLen: Word;<br>
    <strong class="text-strong">end;</strong><br>
    Name: packed array of Char;<br>
  <strong class="text-strong">end;</strong><br>
<br>
  TBfsReader = class<br>
  <strong class="text-strong">private</strong><br>
    <strong class="text-strong">function</strong> GetCount: Integer;<br>
    <strong class="text-strong">function</strong> GetEntry(Index: Integer): TBfsEntry;<br>
  <strong class="text-strong">protected</strong><br>
    FEntries: array of TBfsEntry;<br>
    FHeader: TBfsHeader;<br>
    FStream: TStream;<br>
  <strong class="text-strong">public</strong><br>
    <strong class="text-strong">constructor</strong> Create(FileName: string);<br>
    <strong class="text-strong">destructor</strong> Destroy; override;<br>
    <strong class="text-strong">function</strong> Extract(Index: Integer; Dest: TStream): Integer;<br>
    <strong class="text-strong">property</strong> Entries[Index: Integer]: TBfsEntry read GetEntry;<br>
    <strong class="text-strong">property</strong> Count: Integer read GetCount;<br>
  <strong class="text-strong">end;</strong><br>
<br>
<strong class="text-strong">implementation</strong><br>
<br>
{ TBfsReader }<br>
<br>
<strong class="text-strong">constructor</strong> TBfsReader.Create(FileName: string);<br>
<strong class="text-strong">var</strong><br>
  i: Integer;<br>
  Offsets: array of Cardinal;<br>
<strong class="text-strong">begin</strong><br>
  inherited Create;<br>
  FStream := TFileStream.Create(FileName, fmOpenRead + fmShareCompat);<br>
<br>
  // Read header<br>
  FStream.Read(FHeader, SizeOf(FHeader));<br>
<br>
  SetLength(Offsets, FHeader.NumEntries);<br>
  SetLength(FEntries, FHeader.NumEntries);<br>
<br>
  // Read File entry offfsets<br>
  FStream.Read(Offsets[0], FHeader.NumEntries * SizeOf(Cardinal));<br>
<br>
  // Skip unknown (parent/child/sibbling structure or something?) Two words for<br>
  // each entry<br>
  FStream.Read(i, SizeOf(Cardinal));<br>
  FStream.Seek(i * (SizeOf(Word)*2), soFromCurrent);<br>
<br>
  // Read entries<br>
  <strong class="text-strong">for </strong> i := 0 <strong class="text-strong">to</strong> FHeader.NumEntries -1 <strong class="text-strong">do</strong><br>
  <strong class="text-strong">begin</strong><br>
    FStream.Seek(Offsets<em class="text-italics">, soFromBeginning);<br>
    FStream.Read(FEntries<em class="text-italics">.Info, SizeOf(FEntries<em class="text-italics">.Info));<br>
    SetLength(FEntries<em class="text-italics">.Name, FEntries<em class="text-italics">.Info.NameLen +1);<br>
    FStream.Read(FEntries<em class="text-italics">.Name[0], FEntries<em class="text-italics">.Info.NameLen);<br>
    FEntries<em class="text-italics">.Name[FEntries<em class="text-italics">.Info.NameLen] := #0;<br>
<strong class="text-strong">  end;<br>
end;</strong><br>
<br>
<strong class="text-strong">destructor</strong> TBfsReader.Destroy;<br>
<strong class="text-strong">begin</strong><br>
  FreeAndNil(FStream);<br>
  inherited;<br>
<strong class="text-strong">end;</strong><br>
<br>
<strong class="text-strong">function</strong> TBfsReader.Extract(Index: Integer; Dest: TStream): Integer;<br>
<strong class="text-strong">var</strong><br>
  DecompStream: TDecompressionStream;<br>
<strong class="text-strong">begin</strong><br>
  Result := 0;<br>
  if FEntries[Index].Info.Size = 0 then Exit;<br>
  FStream.Seek(FEntries[Index].Info.DataOffs, soFromBeginning);<br>
<br>
  <strong class="text-strong">case</strong> FEntries[Index].Info.CompMethod of<br>
    // Raw data, just copy<br>
    4: Result := Dest.CopyFrom(FStream, FEntries[Index].Info.Size);<br>
    // ZLib compressed data, decompress<br>
    5: <strong class="text-strong">begin</strong><br>
         DecompStream := TDecompressionStream.Create(FStream);<br>
         <strong class="text-strong">try</strong><br>
           Result := Dest.CopyFrom(DecompStream, FEntries[Index].Info.Size);<br>
         finally<br>
           FreeAndNil(DecompStream);<br>
         <strong class="text-strong">end;</strong><br>
       <strong class="text-strong">end;</strong><br>
  <strong class="text-strong">else</strong><br>
    raise Exception.Create('Unknown compression format');<br>
  <strong class="text-strong">end</strong><br>
<strong class="text-strong">end;</strong><br>
<br>
<strong class="text-strong">function</strong> TBfsReader.GetCount: Integer;<br>
begin<br>
  Result := Length(FEntries);<br>
end;<br>
<br>
<strong class="text-strong">function</strong> TBfsReader.GetEntry(Index: Integer): TBfsEntry;<br>
<strong class="text-strong">begin</strong><br>
  Result := FEntries[Index];<br>
<strong class="text-strong">end;</strong><br>
<br>
<strong class="text-strong">end.</strong><br>
 <img class="smilies" src="./images/smilies/%5Bcolon%5DD.gif" width="15" height="15" alt=":D" title="Very Happy"> [/b]</em></em></em></em></em></em></em></em></em></div>

			
			
									
						<div id='list_thanks8655'>
</div>
<div id='div_post_reput8655'>
</div>

							<div id="sig8655" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8657" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8657">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8657" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8657">

					<h3 >
						<a href="./viewtopic.php?p=8657#p8657"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8657/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8657" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8657' href="./viewtopic.php?f=10&amp;p=8657&amp;thanks=8657&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8657#p8657" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:38:03+00:00">Thu May 26, 2005 12:38 am</time>
			</p>
			
			
			
			<div class="content">James Bond NightFire 007 (Delphi - Pascal code)<br>
<br>
<strong class="text-strong">type</strong> N007Header = <strong class="text-strong">packed record</strong><br>
       Magic: Integer;   // Always 1 ?<br>
       Version: Integer; // 1 = Used in Nightfire Demo<br>
                                // 3 = Used in Nightfire Retail<br>
       Magic2: Integer;<br>
       ID: array[0..3] of char;<br>
       NumRootDirs: Integer;<br>
     <strong class="text-strong">end;</strong><br>
     // If version = 3 then following the header is an integer giving the number of entries<br>
     // Get32 filename<br>
     N007Entry = <strong class="text-strong">packed record</strong><br>
       Compressed: byte;<br>
       Size: integer;<br>
       CompSize: integer;<br>
     <strong class="text-strong">end;</strong><br>
     // If version = 1 then follows Size bytes of data (if Compressed = 0) or CompSize (if Compressed = 1)[/b]</div>

			
			
									
						<div id='list_thanks8657'>
</div>
<div id='div_post_reput8657'>
</div>

							<div id="sig8657" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8658" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8658">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8658" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8658">

					<h3 >
						<a href="./viewtopic.php?p=8658#p8658"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8658/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8658" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8658' href="./viewtopic.php?f=10&amp;p=8658&amp;thanks=8658&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8658#p8658" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:40:48+00:00">Thu May 26, 2005 12:40 am</time>
			</p>
			
			
			
			<div class="content">Spelforce PAK file (Delphi - Pascal code)<br>
<br>
<strong class="text-strong">type</strong> MFHeader = <strong class="text-strong">packed record</strong><br>
        VersionNum: integer;<br>
        ID: array[0..23] of char;  // 'MASSIVE PAKFILE V 4.0'<br>
        Unknown: array[0..43] of byte;<br>
        Unknown2: integer;<br>
        NbFatEntry: integer;<br>
        Unknown3: integer;<br>
        DataOffset: integer;<br>
        FileSize: integer;<br>
     <strong class="text-strong">end;</strong><br>
     MFEntry = <strong class="text-strong">packed record</strong><br>
        Size: integer;<br>
        RelOffset: integer;<br>
        NameOffset: integer;<br>
        Unknown: integer;<br>
     <strong class="text-strong">end;</strong></div>

			
			
									
						<div id='list_thanks8658'>
</div>
<div id='div_post_reput8658'>
</div>

							<div id="sig8658" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8659" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8659">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8659" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8659">

					<h3 >
						<a href="./viewtopic.php?p=8659#p8659"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8659/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8659" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8659' href="./viewtopic.php?f=10&amp;p=8659&amp;thanks=8659&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8659#p8659" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:42:51+00:00">Thu May 26, 2005 12:42 am</time>
			</p>
			
			
			
			<div class="content">Heroes of Might &amp; Magic 4 H4R file (Delphi - Pascal code) <br>
<br>
<strong class="text-strong">type</strong> H4R_Header = <strong class="text-strong">packed record</strong><br>
       ID: array[0..3] of char;<br>
       DirOffset: integer;<br>
     <strong class="text-strong">end;</strong><br>
     H4R_Index = <strong class="text-strong">packed record</strong><br>
       Offset: integer;<br>
       Size: integer;<br>
       DSize: integer;<br>
       Unk: integer;  // Always 9C 73 86 3C<br>
     <strong class="text-strong">end;</strong><br>
     // get16 filenameID<br>
     // get16 source directory<br>
     // 2 bytes 00 00<br>
     // Integer (Storage/Compression?)</div>

			
			
									
						<div id='list_thanks8659'>
</div>
<div id='div_post_reput8659'>
</div>

							<div id="sig8659" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8660" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8660">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8660" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8660">

					<h3 >
						<a href="./viewtopic.php?p=8660#p8660"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8660/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8660" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8660' href="./viewtopic.php?f=10&amp;p=8660&amp;thanks=8660&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8660#p8660" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:45:38+00:00">Thu May 26, 2005 12:45 am</time>
			</p>
			
			
			
			<div class="content">The 11th Hour GJD file (Delphi - Pascal code)<br>
<br>
<strong class="text-strong">type</strong> GJD_Entry = <strong class="text-strong">packed record</strong>         // 32 Bytes<br>
    Unknown: integer;<br>
    Offset: longword;<br>
    Size: longword;<br>
    Index: word;<br>
    Filename: array[1..18] of char;<br>
  <strong class="text-strong">end;</strong><br>
<br>
<strong class="text-strong">type</strong> GJD_Entry_7 = <strong class="text-strong">packed record</strong>       // 20 Bytes<br>
    Filename: array[1..12] of char;<br>
    Offset: longword;<br>
    Size: longword;<br>
  <strong class="text-strong">end;</strong></div>

			
			
									
						<div id='list_thanks8660'>
</div>
<div id='div_post_reput8660'>
</div>

							<div id="sig8660" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8661" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8661">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8661" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8661">

					<h3 >
						<a href="./viewtopic.php?p=8661#p8661"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8661/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8661" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8661' href="./viewtopic.php?f=10&amp;p=8661&amp;thanks=8661&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8661#p8661" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:52:10+00:00">Thu May 26, 2005 12:52 am</time>
			</p>
			
			
			
			<div class="content">DreamWorks BLB file (C++ code)<br>
<br>
struct BLBHeader<br>
{<br>
  char	szID[4];<br>
  BYTE	bID;<br>
  BYTE	bUnknown;<br>
  WORD	wDataSize;<br>
  DWORD dwFileSize;<br>
  DWORD dwNumber;<br>
};<br>
<br>
szID -- string ID is always "\x40\x49\x00\x02".<br>
<br>
bID -- byte ID is always 0x07.<br>
<br>
wDataSize -- the size of data section of BLB file (see below).<br>
<br>
dwFileSize -- the size of BLB file.<br>
<br>
dwNumber -- the number of files stored in BLB file.<br>
<br>
After the header comes the array of (dwNumber) file IDs. Each file ID is a<br>
DWORD identifying a file in BLB archive.<br>
<br>
After the file IDs array comes the array of (dwNumber) directory entries.<br>
Each directory entry contains the info on a file in BLB archive. Each such<br>
entry has the following format:<br>
<br>
struct BLBDirEntry<br>
{<br>
  BYTE	bType;<br>
  BYTE	bAction;<br>
  WORD	wDataIndex;<br>
  DWORD dwUnknown;<br>
  DWORD dwStart;<br>
  DWORD dwFileID;<br>
  DWORD dwOutSize;<br>
};<br>
<br>
bType -- the type of the file:<br>
0x07 -- sound effect,<br>
0x08 -- music,<br>
0x0A -- video file (SMK -- Smacker video, <a href="http://www.smacker.com" class="postlink">http://www.smacker.com</a>),<br>
there're some more types, but their purpose is not so evident (e.g. 0x02<br>
seems to be graphic file type).<br>
<br>
bAction -- defines the action which should be performed for the file:<br>
0x01 -- none: the file is non-compressed, no additional actions are required,<br>
0x03 -- decompress: the file is PKWARE-compressed (see below),<br>
0x65 -- fake: the file is fake, that is no file is really present (see below).<br>
<br>
wDataIndex -- the index into file data array (see below) for the byte<br>
correspondent to the file.<br>
<br>
dwStart -- the starting position of the file relative to the beginning of the<br>
BLB archive.<br>
<br>
dwFileID -- this field is only relevant for fake files: fake files directory<br>
entries are just placeholders, there's no real file in the archive for the<br>
fake file directory entry, but such entry points to some other file (perhaps,<br>
in other BLB archive) with the file ID equal to (dwFileID) which should be<br>
used instead of the correspondent fake file. So, fake file is a kind of alias<br>
for other (non-fake) file. Note, that, in principle, fake file may be an<br>
alias for another fake file, etc., but finally there should be non-fake file<br>
in the chain of such redirections.<br>
<br>
dwOutSize -- the output size of the file:<br>
for non-compressed files that's just the size of the file,<br>
for PKWARE-compressed files that's the size of decompressed file,<br>
for fake files use the value from the directory entry of the correspondent<br>
non-fake file.<br>
<br>
After the array of directory entries comes the data section. This is the array<br>
of (wDataSize) bytes. Let's call these bytes "shifts". The shift value for<br>
the file may be obtained by getting the byte with index (wDataIndex) (see above)<br>
from the file data array (indices are zero-based). If the index value is too<br>
large (not less than data section size (wDataSize)), the shift value should<br>
be set to default (0xFF).<br>
<br>
After the file data section come files contained in BLB archive.<br>
<br>
============================================<br>
2. Decompression of PKWARE-compressed Files<br>
============================================<br>
<br>
I will not describe here the algorithm of PKWARE decompression. What I'll<br>
explain is the easy way you may use to access PKWARE-compressed files via<br>
PKWARE's library PKWARE.DLL. This library is supplied with GAP's BLB RF<br>
plug-in (see below).<br>
<br>
Here's the sample C code (using Win32 API):<br>
<br>
// decompression function -- returns zero on success<br>
DWORD (__cdecl *Uncompress)<br>
(<br>
  char	*outputBuffer,<br>
  DWORD *pOutSize,<br>
  char	*inputBuffer,<br>
  DWORD  dwSize<br>
);<br>
<br>
// first, load the library<br>
HINSTANCE hDllInst=LoadLibrary("pkware.dll");<br>
<br>
// get the decompression function address<br>
Uncompress=(DWORD (__cdecl *)(char*, DWORD*, char*, DWORD))GetProcAddress(hDllInst,"Uncompress");<br>
<br>
// decompress file -- it's assumed here that input buffer contains compressed<br>
// file loaded from BLB archive and output buffer is allocated and has proper<br>
// size (that is, (dwOutSize) value from the corresponding directory entry)<br>
Uncompress(outputBuffer,&amp;dwOutSize,inputBuffer,dwSize);<br>
<br>
// now (outputBuffer) contains decompressed file and (dwOutSize) is set to<br>
// decompressed file size (you should use directory entry value of output<br>
// size for output buffer allocation)<br>
<br>
================================<br>
3. BLBSFX Sound and Music Files<br>
================================<br>
<br>
As was pointed out above, files with type bytes 0x07 and 0x08 are sound and<br>
music files. All of them are of the same format which I refer to as BLBSFX.<br>
BLBSFX file has no header, it's just compressed (or non-compressed) waveform<br>
stream. All sound/music files in The Neverhood are 16-bit mono 22050 Hz.<br>
If the shift value for the BLBSFX file is 0xFF, the file in not compressed<br>
and in this case, it's just PCM waveform stream (signed 16-bit).<br>
Otherwise, if the shift byte differs from 0xFF, BLBSFX file is compressed<br>
using DW ADPCM compression algorithm. Refer to the following section for the<br>
description of DW ADPCM decompression scheme.<br>
Note that most of sound files in The Neverhood are PKWARE-compressed, that<br>
is you should first decompress them (e.g. using PKWARE.DLL and the approach<br>
described above) and then apply DW ADPCM decompression scheme (if needed).<br>
All music files are not PKWARE-compressed, but most of them are DW ADPCM<br>
compressed.<br>
<br>
====================================<br>
4. DW ADPCM Decompression Algorithm<br>
====================================<br>
<br>
During the decompression SHORT variable should be maintained. Decompression<br>
uses shift value, so it should be obtained first.<br>
<br>
Here's the code which decompresses DW ADPCM compressed BLBSFX file:<br>
<br>
BYTE  bShift; // shift value<br>
char *inputBuffer[dwSize];<br>
<br>
SHORT iCurValue;<br>
DWORD i;<br>
<br>
iCurValue=0x0000;<br>
<br>
for (i=0;i&lt;dwSize;i++)<br>
{<br>
  iCurValue+=(signed short)inputBuffer<em class="text-italics">;<br>
  Output(iCurValue&lt;&lt;bShift);<br>
}<br>
<br>
Output() is just a placeholder for any action you would like to perform for<br>
decompressed sample value.</em></div>

			
			
									
						<div id='list_thanks8661'>
</div>
<div id='div_post_reput8661'>
</div>

							<div id="sig8661" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8662" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8662">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8662" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8662">

					<h3 >
						<a href="./viewtopic.php?p=8662#p8662"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8662/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8662" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8662' href="./viewtopic.php?f=10&amp;p=8662&amp;thanks=8662&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8662#p8662" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:54:18+00:00">Thu May 26, 2005 12:54 am</time>
			</p>
			
			
			
			<div class="content">Atlantis: The Lost Tale;<br>
Atlantis 2;<br>
Aztec;<br>
Egypte 2;<br>
Odyssee;<br>
Chine;<br>
<br>
<span style="text-decoration:underline">Formats : APC, .HNM, .BF, .ZIK</span><br>
<br>
struct APCHeader<br>
{<br>
  char	szID[8];<br>
  char	szVersion[4];<br>
  DWORD dwOutSize;<br>
  DWORD dwSampleRate;<br>
  LONG	lSampleLeft;<br>
  LONG	lSampleRight;<br>
  DWORD dwStereo;<br>
};<br>
<br>
szID -- ID string, which is "CRYO_APC".<br>
<br>
szVersion -- version ID string, all files in the mentioned games have this<br>
set to "1.20". Note that this field may, in principle, vary.<br>
<br>
dwOutSize -- number of samples in the file. May be used for song length<br>
(in seconds) calculation.<br>
<br>
dwSampleRate -- sample rate for the file.<br>
<br>
lSampleLeft -- the initial value for the left sample (see below).<br>
<br>
lSampleRight -- the initial value for the right sample (see below).<br>
<br>
dwStereo -- this seems to be boolean stereo flag: if this is not zero, the<br>
audio stream in the file is stereo (music and partly video soundtracks),<br>
otherwise it's mono (sfx, speech).<br>
<br>
The resolution is NOT specified in the header, so the default value (16-bit)<br>
should be used.<br>
<br>
After the APCHeader IMA ADPCM compressed sound data comes. You may find<br>
IMA ADPCM decompression scheme description further in this document.<br>
<br>
=====================================<br>
2. IMA ADPCM Decompression Algorithm<br>
=====================================<br>
<br>
During the decompression four LONG variables must be maintained for stereo<br>
stream: lIndexLeft, lIndexRight, lCurSampleLeft, lCurSampleRight and two --<br>
for mono stream: lIndex, lCurSample. At the beginning of the file you must<br>
initialize lCurSampleLeft/Right variables to the values from APCHeader while<br>
lIndexLeft/Right are initialized to zeroes.<br>
Note that LONG here is signed.<br>
<br>
Here's the code which decompresses one byte of IMA ADPCM compressed<br>
stereo stream. Other bytes are processed in the same way.<br>
<br>
BYTE Input; // current byte of compressed data<br>
BYTE Code;<br>
LONG Delta;<br>
<br>
Code=HINIBBLE(Input); // get HIGHER 4-bit nibble<br>
<br>
Delta=StepTable[lIndexLeft]&gt;&gt;3;<br>
if (Code &amp; 4)<br>
   Delta+=StepTable[lIndexLeft];<br>
if (Code &amp; 2)<br>
   Delta+=StepTable[lIndexLeft]&gt;&gt;1;<br>
if (Code &amp; 1)<br>
   Delta+=StepTable[lIndexLeft]&gt;&gt;2;<br>
if (Code &amp; <img class="smilies" src="./images/smilies/%5Bcolon%5Dcool.gif" width="15" height="15" alt="8)" title="Cool"> // sign bit<br>
   lCurSampleLeft-=Delta;<br>
else<br>
   lCurSampleLeft+=Delta;<br>
<br>
// clip sample<br>
if (lCurSampleLeft&gt;32767)<br>
   lCurSampleLeft=32767;<br>
else if (lCurSampleLeft&lt;-32768)<br>
   lCurSampleLeft=-32768;<br>
<br>
lIndexLeft+=IndexAdjust<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>; // adjust index

// clip index
if (lIndexLeft&lt;0)
   lIndexLeft=0;
else if (lIndexLeft&gt;88)
   lIndexLeft=88;

Code=LONIBBLE(Input); // get LOWER 4-bit nibble

Delta=StepTable[lIndexRight]&gt;&gt;3;
if (Code &amp; 4)
   Delta+=StepTable[lIndexRight];
if (Code &amp; 2)
   Delta+=StepTable[lIndexRight]&gt;&gt;1;
if (Code &amp; 1)
   Delta+=StepTable[lIndexRight]&gt;&gt;2;
if (Code &amp; 8) // sign bit
   lCurSampleRight-=Delta;
else
   lCurSampleRight+=Delta;

// clip sample
if (lCurSampleRight&gt;32767)
   lCurSampleRight=32767;
else if (lCurSampleRight&lt;-32768)
   lCurSampleRight=-32768;

lIndexRight+=IndexAdjust[Code]; // adjust index

// clip index
if (lIndexRight&lt;0)
   lIndexRight=0;
else if (lIndexRight&gt;88)
   lIndexRight=88;

// Now we've got lCurSampleLeft and lCurSampleRight which form one stereo
// sample and all is set for the next input byte...
Output((SHORT)lCurSampleLeft,(SHORT)lCurSampleRight); // send the sample to output

HINIBBLE and LONIBBLE are higher and lower 4-bit nibbles:
#define HINIBBLE(byte) ((byte) &gt;&gt; 4)
#define LONIBBLE(byte) ((byte) &amp; 0x0F)
Note that depending on your compiler you may need to use additional nibble
separation in these defines, e.g. (((byte) &gt;&gt; 4) &amp; 0x0F).

StepTable and IndexAdjust are the tables given in the next section of
this document.

Output() is just a placeholder for any action you would like to perform for
decompressed sample value.

Of course, this decompression routine may be greatly optimized.

As to mono sound, it's just analoguous:

Code=HINIBBLE(Input); // get HIGHER 4-bit nibble

Delta=StepTable[lIndex]&gt;&gt;3;
if (Code &amp; 4)
   Delta+=StepTable[lIndex];
if (Code &amp; 2)
   Delta+=StepTable[lIndex]&gt;&gt;1;
if (Code &amp; 1)
   Delta+=StepTable[lIndex]&gt;&gt;2;
if (Code &amp; 8) // sign bit
   lCurSample-=Delta;
else
   lCurSample+=Delta;

// clip sample
if (lCurSample&gt;32767)
   lCurSample=32767;
else if (lCurSample&lt;-32768)
   lCurSample=-32768;

lIndex+=IndexAdjust[Code]; // adjust index

// clip index
if (lIndex&lt;0)
   lIndex=0;
else if (lIndex&gt;88)
   lIndex=88;

Output((SHORT)lCurSample); // send the sample to output

Code=LONIBBLE(Input); // get LOWER 4-bit nibble
// ...just the same as above for lower nibble

Note that HIGHER nibble is processed first for mono sound and corresponds to
LEFT channel for stereo.

====================
3. IMA ADPCM Tables
====================

LONG IndexAdjust[]=
{
    -1,
    -1,
    -1,
    -1,
     2,
     4,
     6,
     8,
    -1,
    -1,
    -1,
    -1,
     2,
     4,
     6,
     8
};

LONG StepTable[]=
{
    7,	   8,	  9,	 10,	11,    12,     13,    14,    16,
    17,    19,	  21,	 23,	25,    28,     31,    34,    37,
    41,    45,	  50,	 55,	60,    66,     73,    80,    88,
    97,    107,   118,	 130,	143,   157,    173,   190,   209,
    230,   253,   279,	 307,	337,   371,    408,   449,   494,
    544,   598,   658,	 724,	796,   876,    963,   1060,  1166,
    1282,  1411,  1552,  1707,	1878,  2066,   2272,  2499,  2749,
    3024,  3327,  3660,  4026,	4428,  4871,   5358,  5894,  6484,
    7132,  7845,  8630,  9493,	10442, 11487,  12635, 13899, 15289,
    16818, 18500, 20350, 22385, 24623, 27086,  29794, 32767
};

=========================
4. HNM Movie Soundtracks
=========================

.HNM movie hasn't got soundtrack inside the HNM movie file itself.
However the soundtrack for HNM movie is a stand-alone APC file, as a rule,
with the same file title. The format of such APC soundtracks is just the
same as described above.

==================================
5. APC Audio Files in BF Archives
==================================

When stored in .BF resources, APC audio files are stored "as is", without
compression or encryption. That means if you want to play/extract APC
file from the BF resource you just need to search for (szID) id-string
("CRYO_APC") and read APC header starting at the beginning position of
found id-string. This will give you starting point of the file and the size
of the file will be the sum of APCHeader size and the compressed audio stream
size correspondent to (dwOutSize) header field (that is, (dwOutSize) for
stereo stream and (dwOutSize)/2 for mono stream).

===================
6. ZIK Audio Files
===================

In the game Chine music is in ZIK files. Most of them are simple RAW files:
16-bit signed stereo 22050 Hz (no header), except for only one which is a
regular WAV file. So, you can just load and play those ZIKs as RAWs (except
for one which is WAV).[/u]</code></pre></div></div>

			
			
									
						<div id='list_thanks8662'>
</div>
<div id='div_post_reput8662'>
</div>

							<div id="sig8662" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8663" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8663">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8663" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8663">

					<h3 >
						<a href="./viewtopic.php?p=8663#p8663"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8663/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8663" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8663' href="./viewtopic.php?f=10&amp;p=8663&amp;thanks=8663&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8663#p8663" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:55:59+00:00">Thu May 26, 2005 12:55 am</time>
			</p>
			
			
			
			<div class="content">EA Games formats : ASF, AS4, KSF, EAS, SPH, BNK, CRD, TGV<br>
<br>
=======================<br>
1. ASF/AS4 Music Files<br>
=======================<br>
<br>
The music in many Electronic Arts games is in .ASF/.AS4 stand-alone files.<br>
These files have the block structure analoguous to RIFF. Namely, these files<br>
are divided into blocks (without any global file header like RIFFs have).<br>
Each block has the following header:<br>
<br>
struct ASFBlockHeader<br>
{<br>
  char	szBlockID[4];<br>
  DWORD dwSize;<br>
};<br>
<br>
szBlockID -- string ID for the block.<br>
<br>
dwSize -- size of the block (in bytes) INCLUDING this header.<br>
<br>
Further I'll describe the contents of blocks of all block types in ASF/AS4<br>
files. When I say "block begins with..." that means "the contents of that<br>
block (which begin just after ASFBlockHeader) begin with...".<br>
Quoted strings are block IDs.<br>
<br>
"1SNh": header block. This is the first block in ASF/AS4.<br>
This block begins with the structure describing the audio stream:<br>
<br>
struct EACSHeader<br>
{<br>
  char	szID[4];<br>
  DWORD dwSampleRate;<br>
  BYTE	bBits;<br>
  BYTE	bChannels;<br>
  BYTE	bCompression;<br>
  BYTE	bType;<br>
  DWORD dwNumSamples;<br>
  DWORD dwLoopStart;<br>
  DWORD dwLoopLength;<br>
  DWORD dwDataStart;<br>
  DWORD dwUnknown;<br>
};<br>
<br>
szID -- ID string, always "EACS".<br>
<br>
dwSampleRate -- sample rate for the file.<br>
<br>
bBits -- if multiplied by 8 gives the resolution of (decompressed) sound<br>
data, that is 1 means 8-bit and 2 means 16-bit.<br>
<br>
bChannels -- channels number: 1 for mono, 2 for stereo.<br>
<br>
bCompression -- if 0x00, the data in the file is not compressed: signed 8-bit<br>
PCM or signed 16-bit PCM. If this byte is 0x02, the audio data is compressed<br>
with IMA ADPCM. Note that non-compressed 8-bit files use SIGNED format!<br>
Signed 16-bit data may be sent to the wave output without any additional<br>
conversions, while signed 8-bit data should be converted to unsigned format.<br>
For example you can do that so: unsigned8Bit=signed8Bit+0x80<br>
or, just the same: unsigned8Bit=signed8Bit^0x80 (this's a bit faster).<br>
<br>
bType -- type of file: always 0x00 for ASF/AS4 (multi-block) files.<br>
<br>
dwNumSamples -- number of samples in the file. May be used for song length<br>
(in seconds) calculation.<br>
<br>
dwLoopStart -- beginning of the repeat loop (in samples). 0xFFFFFFFF means<br>
no loop.<br>
<br>
dwLoopLength -- length of the repeat loop (in samples). Zero for no loop.<br>
<br>
dwDataStart -- in ASF/AS4 files this is not used (equal to 0).<br>
<br>
After the EACSHeader the first chunk of sound data comes. If the data isn't<br>
compressed, it's just signed 8/16-bit PCM. If the data is compressed, it<br>
starts with a small chunk header:<br>
<br>
struct ASFChunkHeader<br>
{<br>
  DWORD dwOutSize;<br>
  LONG	lIndexLeft;<br>
  LONG	lIndexRight;<br>
  LONG	lCurSampleLeft;<br>
  LONG	lCurSampleRight;<br>
};<br>
<br>
dwOutSize -- size of uncompressed audio data in this chunk (in samples).<br>
<br>
lIndexLeft, lIndexRight, lCurSampleLeft, lCurSampleRight are initial<br>
values for IMA ADPCM decompression routine for this chunk (for left and right<br>
channels respectively). I'll describe the usage of these further when I get to<br>
IMA ADPCM decompression scheme.<br>
<br>
Note that the structure above is ONLY for stereo files. For mono there're<br>
just no lIndexRight and lCurSampleRight fields.<br>
<br>
After this chunk header the compressed data comes. You may find IMA ADPCM<br>
decompression scheme description further in this document.<br>
<br>
Hereafter by "chunk" I mean the audio data in the "1SNd" data block, that is,<br>
compressed data which starts after ASFChunkHeader.<br>
<br>
"1SNd": data block. If no compression is used these blocks contain just<br>
signed 8/16-bit PCM audio data. Otherwise the data in each of these blocks<br>
begins with the same ASFChunkHeader described above and after that comes<br>
compressed data.<br>
Note that the first chunk of audio data is in "1SNh" block, along with the<br>
global EACS header!<br>
<br>
"1SNl": loop block. This block defines looping point for the song. It<br>
contains only DWORD value, which is the looping jump position (in samples)<br>
relative to the start of the song. Note that you should make the jump NOT<br>
when you encounter this block but when you come across the "1SNe" block<br>
which may appear some "1SNd" data blocks after this block!<br>
<br>
"1SNe": end block. This block indicate the end of audio stream. Make looping<br>
jump when you encounter it. It contains no data and its size is 8 bytes that<br>
is the size of ASFBlockHeader.<br>
Interesting that some AS4 files contain audio data beyond this block. This<br>
should be considered as non-standard feature not worth to support.<br>
<br>
===================<br>
2. KSF Music Files<br>
===================<br>
<br>
Some EA games use other format for music/speech files: .KSF.<br>
These files begin with "KWK`" ID string. Following this ID, comes PATl header.<br>
It begins with "PATl" ID string and its size is 56 bytes (always?) including<br>
its ID string. After PATl header comes TMpl header:<br>
<br>
struct TMplHeader<br>
{<br>
  char	szID[4];<br>
  BYTE	bUnknown1;<br>
  BYTE	bBits;<br>
  BYTE	bChannels;<br>
  BYTE	bCompression;<br>
  WORD	wUnknown2;<br>
  WORD	wSampleRate;<br>
  DWORD dwNumSamples; // ???<br>
  BYTE	bUnknown3[20];<br>
};<br>
<br>
szID -- string ID, always "TMpl".<br>
<br>
bBits -- resolution of sound data (0x10 for 16-bit, 0x8 for 8-bit).<br>
<br>
bChannels -- channels number: 1 for mono, 2 for stereo.<br>
<br>
bCompression -- if 0x00, the data in the file is not compressed: signed 8-bit<br>
PCM or signed 16-bit PCM. If this byte is 0x02, the audio data is compressed<br>
with IMA ADPCM. See the note for EACS header above.<br>
<br>
wSampleRate -- sample rate for the file.<br>
<br>
dwNumSamples -- number of samples in the file. May be used for song length<br>
(in seconds) calculation. Should be divided by 2 for mono sound.<br>
<br>
After TMpl header comes sound data. For compressed files, IMA ADPCM compression<br>
is used (see below).<br>
<br>
=====================================<br>
3. IMA ADPCM Decompression Algorithm<br>
=====================================<br>
<br>
During the decompression four LONG variables must be maintained for stereo<br>
stream: lIndexLeft, lIndexRight, lCurSampleLeft, lCurSampleRight and two --<br>
for mono stream: lIndex, lCurSample. At the beginning of each "1SNd" data<br>
block and at the beginning of the file -- when processing "1SNh" block --<br>
you must initialize these variables using the values in ASFChunkHeader.<br>
Note that LONG here is signed.<br>
<br>
Here's the code which decompresses one byte of IMA ADPCM compressed<br>
stereo stream. Other bytes are processed in the same way.<br>
<br>
BYTE Input; // current byte of compressed data<br>
BYTE Code;<br>
LONG Delta;<br>
<br>
Code=HINIBBLE(Input); // get HIGHER 4-bit nibble<br>
<br>
Delta=StepTable[lIndexLeft]&gt;&gt;3;<br>
if (Code &amp; 4)<br>
   Delta+=StepTable[lIndexLeft];<br>
if (Code &amp; 2)<br>
   Delta+=StepTable[lIndexLeft]&gt;&gt;1;<br>
if (Code &amp; 1)<br>
   Delta+=StepTable[lIndexLeft]&gt;&gt;2;<br>
if (Code &amp; <img class="smilies" src="./images/smilies/%5Bcolon%5Dcool.gif" width="15" height="15" alt="8)" title="Cool"> // sign bit<br>
   lCurSampleLeft-=Delta;<br>
else<br>
   lCurSampleLeft+=Delta;<br>
<br>
// clip sample<br>
if (lCurSampleLeft&gt;32767)<br>
   lCurSampleLeft=32767;<br>
else if (lCurSampleLeft&lt;-32768)<br>
   lCurSampleLeft=-32768;<br>
<br>
lIndexLeft+=IndexAdjust<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>; // adjust index

// clip index
if (lIndexLeft&lt;0)
   lIndexLeft=0;
else if (lIndexLeft&gt;88)
   lIndexLeft=88;

Code=LONIBBLE(Input); // get LOWER 4-bit nibble

Delta=StepTable[lIndexRight]&gt;&gt;3;
if (Code &amp; 4)
   Delta+=StepTable[lIndexRight];
if (Code &amp; 2)
   Delta+=StepTable[lIndexRight]&gt;&gt;1;
if (Code &amp; 1)
   Delta+=StepTable[lIndexRight]&gt;&gt;2;
if (Code &amp; 8) // sign bit
   lCurSampleRight-=Delta;
else
   lCurSampleRight+=Delta;

// clip sample
if (lCurSampleRight&gt;32767)
   lCurSampleRight=32767;
else if (lCurSampleRight&lt;-32768)
   lCurSampleRight=-32768;

lIndexRight+=IndexAdjust[Code]; // adjust index

// clip index
if (lIndexRight&lt;0)
   lIndexRight=0;
else if (lIndexRight&gt;88)
   lIndexRight=88;

// Now we've got lCurSampleLeft and lCurSampleRight which form one stereo
// sample and all is set for the next input byte...
Output((SHORT)lCurSampleLeft,(SHORT)lCurSampleRight); // send the sample to output

HINIBBLE and LONIBBLE are higher and lower 4-bit nibbles:
#define HINIBBLE(byte) ((byte) &gt;&gt; 4)
#define LONIBBLE(byte) ((byte) &amp; 0x0F)
Note that depending on your compiler you may need to use additional nibble
separation in these defines, e.g. (((byte) &gt;&gt; 4) &amp; 0x0F).

StepTable and IndexAdjust are the tables given in the next section of
this document.

Output() is just a placeholder for any action you would like to perform for
decompressed sample value.

Of course, this decompression routine may be greatly optimized.

As to mono sound, it's just analoguous:

Code=HINIBBLE(Input); // get HIGHER 4-bit nibble

Delta=StepTable[lIndex]&gt;&gt;3;
if (Code &amp; 4)
   Delta+=StepTable[lIndex];
if (Code &amp; 2)
   Delta+=StepTable[lIndex]&gt;&gt;1;
if (Code &amp; 1)
   Delta+=StepTable[lIndex]&gt;&gt;2;
if (Code &amp; 8) // sign bit
   lCurSample-=Delta;
else
   lCurSample+=Delta;

// clip sample
if (lCurSample&gt;32767)
   lCurSample=32767;
else if (lCurSample&lt;-32768)
   lCurSample=-32768;

lIndex+=IndexAdjust[Code]; // adjust index

// clip index
if (lIndex&lt;0)
   lIndex=0;
else if (lIndex&gt;88)
   lIndex=88;

Output((SHORT)lCurSample); // send the sample to output

Code=LONIBBLE(Input); // get LOWER 4-bit nibble
// ...just the same as above for lower nibble

Note that HIGHER nibble is processed first for mono sound and corresponds to
LEFT channel for stereo.

====================
4. IMA ADPCM Tables
====================

LONG IndexAdjust[]=
{
    -1,
    -1,
    -1,
    -1,
     2,
     4,
     6,
     8,
    -1,
    -1,
    -1,
    -1,
     2,
     4,
     6,
     8
};

LONG StepTable[]=
{
    7,	   8,	  9,	 10,	11,    12,     13,    14,    16,
    17,    19,	  21,	 23,	25,    28,     31,    34,    37,
    41,    45,	  50,	 55,	60,    66,     73,    80,    88,
    97,    107,   118,	 130,	143,   157,    173,   190,   209,
    230,   253,   279,	 307,	337,   371,    408,   449,   494,
    544,   598,   658,	 724,	796,   876,    963,   1060,  1166,
    1282,  1411,  1552,  1707,	1878,  2066,   2272,  2499,  2749,
    3024,  3327,  3660,  4026,	4428,  4871,   5358,  5894,  6484,
    7132,  7845,  8630,  9493,	10442, 11487,  12635, 13899, 15289,
    16818, 18500, 20350, 22385, 24623, 27086,  29794, 32767
};

=========================
5. TGV Movie Soundtracks
=========================

.TGV movies have the block structure analoguous to that of ASF/AS4.
Video-related data is in "kVGT" and "fVGT" (or "TGVk" and "TGVf") blocks and
sound-related data is just in the same blocks as in ASF/AS4: "1SNh", "1SNd",
"1SNl", "1SNe".
So, to play TGV movie soundtrack, just walk blocks chain, skip video blocks
and process sound blocks.

==================================
6. Sound/Speech Files: .EAS, .SPH
==================================

Some sounds and all speech are usually in .EAS and .SPH files.
These files have the header which is just the same as EACSHeader structure
described above with two additions:
(bType) is always 0xFF for sound/speech files,
(dwDataStart) is the starting position of audio data relative to the beginning
of the file.
After the header, starting at (dwDataStart), comes audio data, up to the end of
the file. The data is either non-compressed or IMA ADPCM compressed depending
on the (bCompression) byte in the header. If it's IMA ADPCM compressed, there're
no initial values for samples and indices at the beginning of the audio data.
Just initialize them all to zeroes and start decompression at (dwDataStart).

====================================
7. Sound Effects in .BNK/.CRD Files
====================================

Most of sound effects are stored in .BNK and .CRD resource files. Those .BNKs
and .CRDs may contain several sounds. They begin with some seemingly
meaningless data, but after some junk of that data (typically starting at
position 0x228, but not necessarily) come several EACS headers describing
all sounds in .BNK/.CRD. Each EACS header has almost the same format as
described above with some minor changes (some fields have different placement):

struct EACSHeader
{
  char	szID[4];
  DWORD dwSampleRate;
  BYTE	bBits;
  BYTE	bChannels;
  BYTE	bCompression;
  BYTE	bType;
  DWORD dwLoopStart;
  DWORD dwLoopLength;
  DWORD dwNumSamples;
  DWORD dwDataStart;
  DWORD dwUnknown;
};

and with the same two additions just as for .EAS/.SPH speech/sound:
(bType) is always 0xFF,
(dwDataStart) is the starting position of sound data relative to the beginning
of the .BNK/.CRD file containing that sound.
So, what you need to do is just search in .BNK/.CRD for "EACS" ID string and
read EACSHeader from the position where you found "EACS". And the same for
all sounds contained within .BNK/.CRD.
The sound data itself (for each EACS header describing it) starts at
(dwDataStart) and its size may be computed using (dwNumSamples) EACSHeader
field (for example) with the following formula:
Size=dwNumSamples*SampleSize/CompressionRatio,
where:
CompressionRatio=1 for non-compressed sounds,
		 2 for 8-bit IMA ADPCM compressed sounds,
		 4 for 16-bit IMA ADPCM compressed sounds,
SampleSize=bChannels*bBits (1 for mono 8-bit, 2 for mono 16-bit, etc.).
So, starting at (dwDataStart) comes just either PCM audio data (as described
above for .EAS/.SPH files) or IMA ADPCM compressed data (without initial
sample/index values, just as in .EAS/.SPH). Set CurSample(Left/Right) and
Index(Left/Right) to zeroes and start the decompression.</code></pre></div></div>

			
			
									
						<div id='list_thanks8663'>
</div>
<div id='div_post_reput8663'>
</div>

							<div id="sig8663" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8664" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8664">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8664" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8664">

					<h3 >
						<a href="./viewtopic.php?p=8664#p8664"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8664/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8664" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8664' href="./viewtopic.php?f=10&amp;p=8664&amp;thanks=8664&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8664#p8664" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-25T23:57:12+00:00">Thu May 26, 2005 12:57 am</time>
			</p>
			
			
			
			<div class="content">Westwood formats : AUD, PAK, TLK, VQA<br>
<br>
=============<br>
1. AUD Files<br>
=============<br>
<br>
Malcolm's AUD files have the same format as C&amp;C's AUDs (which is described<br>
in AUD3.TXT) with only one exception: there's no OutSize field in their header.<br>
So it looks like the following:<br>
<br>
struct AUDHeaderOld<br>
{<br>
    WORD  wSampleRate;<br>
    DWORD dwSize;<br>
    BYTE  bFlags;<br>
    BYTE  bType;<br>
};<br>
<br>
bType is equal to 0x01 for WS ADPCM compressed AUDs.<br>
All WS ADPCM compressed sounds I've ever encountered are 8-bit.<br>
<br>
The meanings of the other fields in AUD header are the same as for C&amp;C AUDs.<br>
These AUDs are divided in chunks with the chunk header being the same as for<br>
C&amp;C, but those chunks have variable size (may be NOT 512 bytes) unlike C&amp;C<br>
AUDs!<br>
<br>
Note that WS ADPCM compressed AUDs in C&amp;C (death screams) have just the same<br>
format as other AUDs in this game, i.e. with OutSize field.<br>
<br>
====================================<br>
2. WS ADPCM Decompression Algorithm<br>
====================================<br>
<br>
Each AUD chunk may be decompressed independently of others. This lets you<br>
implement the seeking for WS ADPCM AUDs (unlike IMA ADPCM ones).<br>
But during the decompression of the given chunk a variable (CurSample) should<br>
be maintained for this whole chunk:<br>
<br>
SHORT CurSample;<br>
BYTE  InputBuffer[InputBufferSize]; // input buffer containing the whole chunk<br>
WORD  wSize, wOutSize; // Size and OutSize values from this chunk's header<br>
BYTE  code;<br>
CHAR  count; // this is a signed char!<br>
WORD  i; // index into InputBuffer<br>
WORD  input; // shifted input<br>
<br>
if (wSize==wOutSize) // such chunks are NOT compressed<br>
{<br>
  for (i=0;i&lt;wOutSize;i++)<br>
      Output(InputBuffer<em class="text-italics">); // send to output stream<br>
  return; // chunk is done!<br>
}<br>
<br>
// otherwise we need to decompress chunk<br>
<br>
CurSample=0x80; // unsigned 8-bit<br>
i=0;<br>
<br>
// note that wOutSize value is crucial for decompression!<br>
<br>
while (wOutSize&gt;0) // until wOutSize is exhausted!<br>
{<br>
  input=InputBuffer[i++];<br>
  input&lt;&lt;=2;<br>
  code=HIBYTE(input);<br>
  count=LOBYTE(input)&gt;&gt;2;<br>
  switch (code) // parse code<br>
  {<br>
    case 2: // no compression...<br>
	 if (count &amp; 0x20)<br>
	 {<br>
	   count&lt;&lt;=3;		// here it's significant that (count) is signed:<br>
	   CurSample+=count&gt;&gt;3; // the sign bit will be copied by these shifts!<br>
<br>
	   Output((BYTE)CurSample);<br>
<br>
	   wOutSize--; // one byte added to output<br>
	 }<br>
	 else // copy (count+1) bytes from input to output<br>
	 {<br>
	   for (count++;count&gt;0;count--,wOutSize--,i++)<br>
	       Output(InputBuffer<em class="text-italics">);<br>
	   CurSample=InputBuffer[i-1]; // set (CurSample) to the last byte sent to output<br>
	 }<br>
	 break;<br>
    case 1: // ADPCM 8-bit -&gt; 4-bit<br>
	 for (count++;count&gt;0;count--) // decode (count+1) bytes<br>
	 {<br>
	   code=InputBuffer[i++];<br>
<br>
	   CurSample+=WSTable4bit[(code &amp; 0x0F)]; // lower nibble<br>
<br>
	   CurSample=Clip8BitSample(CurSample);<br>
	   Output((BYTE)CurSample);<br>
<br>
	   CurSample+=WSTable4bit[(code &gt;&gt; 4)]; // higher nibble<br>
<br>
	   CurSample=Clip8BitSample(CurSample);<br>
	   Output((BYTE)CurSample);<br>
<br>
	   wOutSize-=2; // two bytes added to output<br>
	 }<br>
	 break;<br>
    case 0: // ADPCM 8-bit -&gt; 2-bit<br>
	 for (count++;count&gt;0;count--) // decode (count+1) bytes<br>
	 {<br>
	   code=InputBuffer[i++];<br>
<br>
	   CurSample+=WSTable2bit[(code &amp; 0x03)]; // lower 2 bits<br>
<br>
	   CurSample=Clip8BitSample(CurSample);<br>
	   Output((BYTE)CurSample);<br>
<br>
	   CurSample+=WSTable2bit[((code&gt;&gt;2) &amp; 0x03)]; // lower middle 2 bits<br>
<br>
	   CurSample=Clip8BitSample(CurSample);<br>
	   Output((BYTE)CurSample);<br>
<br>
	   CurSample+=WSTable2bit[((code&gt;&gt;4) &amp; 0x03)]; // higher middle 2 bits<br>
<br>
	   CurSample=Clip8BitSample(CurSample);<br>
	   Output((BYTE)CurSample);<br>
<br>
	   CurSample+=WSTable2bit[((code&gt;&gt;6) &amp; 0x03)]; // higher 2 bits<br>
<br>
	   CurSample=Clip8BitSample(CurSample);<br>
	   Output((BYTE)CurSample);<br>
<br>
	   wOutSize-=4; // 4 bytes sent to output<br>
	 }<br>
	 break;<br>
    default: // just copy (CurSample) (count+1) times to output<br>
	 for (count++;count&gt;0;count--,wOutSize--)<br>
	     Output((BYTE)CurSample);<br>
  }<br>
}<br>
<br>
HIBYTE and LOBYTE are just higher and lower bytes of WORD:<br>
#define HIBYTE(word) ((word) &gt;&gt; <img class="smilies" src="./images/smilies/%5Bcolon%5Dcool.gif" width="15" height="15" alt="8)" title="Cool"><br>
#define LOBYTE(word) ((word) &amp; 0xFF)<br>
Note that depending on your compiler you may need to use additional byte<br>
separation in these defines, e.g. (((byte) &gt;&gt; <img class="smilies" src="./images/smilies/%5Bcolon%5Dcool.gif" width="15" height="15" alt="8)" title="Cool"> &amp; 0xFF). The same holds for<br>
4-bit and 2-bit nibble separation in the code above.<br>
<br>
WSTable4bit and WSTable2bit are the delta tables given in the next section.<br>
<br>
Output() is just a placeholder for any action you would like to perform for<br>
decompressed sample value.<br>
<br>
Clip8BitSample is quite evident:<br>
<br>
SHORT Clip8BitSample(SHORT sample)<br>
{<br>
  if (sample&gt;255)<br>
     return 255;<br>
  else if (sample&lt;0)<br>
     return 0;<br>
  else<br>
     return sample;<br>
}<br>
<br>
This algorithm is ONLY for mono 8-bit unsigned sound, as I've never seen any<br>
other sound format used with WS ADPCM compression.<br>
<br>
Of course, the decompression routine described above may be greatly<br>
optimized.<br>
<br>
===================<br>
3. WS ADPCM Tables<br>
===================<br>
<br>
CHAR WSTable2bit[]=<br>
{<br>
    -2,<br>
    -1,<br>
     0,<br>
     1<br>
};<br>
<br>
CHAR WSTable4bit[]=<br>
{<br>
    -9, -8, -6, -5, -4, -3, -2, -1,<br>
     0,  1,  2,  3,  4,  5,  6,  8<br>
};<br>
<br>
=====================================================<br>
4. AUDs in Legend Of Kyrandia III: Malcolm's Revenge<br>
=====================================================<br>
<br>
The WS ADPCM compression described above is used for all audio in this game:<br>
<br>
Music is stand-alone .AUD files.<br>
Speech is AUDs in .TLK resource files.<br>
Sounds are AUDs in .PAK resource files.<br>
<br>
These .TLKs and .PAKs do not use any compression or encryption for AUDs, so<br>
AUDs are stored "as is" in them. If you want to extract/play an AUD from<br>
PAK or TLK you just need to search the PAK or TLK for the AUD id, that is,<br>
DWORD value equal to 0x0000DEAF (or, in other words, string "\xAF\xDE\0\0").<br>
Refer to Vladan Bato's AUD3.TXT for more details on AUD file structure.<br>
<br>
=========================<br>
5. VQA Movie Soundtracks<br>
=========================<br>
<br>
Soundtrack of VQA movie in Malcolm, C&amp;C, Red Alert and C&amp;C: Tiberian Sun is<br>
stored in SND0, SND1 or SND2 blocks. Refer to VQA_FRMT.TXT by Aaron Glover for<br>
details on the structure of VQA files. Here I only describe the contents of<br>
VQA sound blocks and VQHD (header) block.<br>
<br>
VQHD block contains header for VQA. To the best of my knowledge, it has the<br>
following format:<br>
<br>
struct VQAHeader<br>
{<br>
    WORD  wVersion;<br>
    WORD  unknown1;<br>
    WORD  wNumFrames;<br>
    WORD  wWidth;<br>
    WORD  wHeight;<br>
    WORD  unknown2;<br>
    WORD  unknown3;<br>
    WORD  unknown4;<br>
    WORD  unknown5;<br>
    DWORD unknown6;<br>
    WORD  unknown7;<br>
    WORD  wSampleRate;<br>
    BYTE  bChannels;<br>
    BYTE  bResolution;<br>
    char  unknown8[14];<br>
};<br>
<br>
wVersion -- version of VQA: 1 -- oldest Malcolm's VQAs, 2 -- C&amp;C, Red Alert,<br>
3 -- C&amp;C: Tiberian Sun.<br>
<br>
wNumFrames -- number of frames in VQA. Note that number of sound blocks is<br>
(wNumFrames+1) for VQAs of version 2 (C&amp;C, Red Alert), and (wNumFrames) for<br>
versions 1 and 3. But Dune2000 VQAs have also (wNumFrames) sound blocks<br>
while they're version 2 VQAs.<br>
<br>
wSampleRate -- sample rate for soundtrack. Note that version 1 (Malcolm's)<br>
VQAs may have this value set to 0x0000! Use 22050 Hz in such cases.<br>
<br>
bChannels -- number of channels (1 -- mono, 2 -- stereo). Note that version 1<br>
VQAs may have this set to 0x00, so use 1 (mono) for such files.<br>
<br>
bResolution -- resolution of soundtrack (0x10 -- 16-bit, 0x8 -- 8-bit). Note<br>
that version 1 VQAs may have this set to 0x00, so use 0x8 for such files.<br>
<br>
All VQAs in Malcolm have their sound in either SND0 or SND1 blocks.<br>
SND0 blocks contain non-compressed PCM data.<br>
SND1 blocks contain small header and WS ADPCM compressed sound data.<br>
The header is the following:<br>
<br>
struct SND1Header<br>
{<br>
  WORD wOutSize;<br>
  WORD wSize;<br>
};<br>
<br>
Following the header comes WS ADPCM compressed sound data.<br>
Each SND1 sound block may be decompressed, just like a chunk of AUD file,<br>
independently of the others and the routine described above may be used for<br>
its decompression without any changes, provided you use wOutSize from the<br>
SND1Header.<br>
<br>
As to VQAs in C&amp;C and Red Alert their sound is in the SND2 blocks and<br>
compressed with IMA ADPCM algorithm, described in Vladan Bato's AUD3.TXT.<br>
The contents of SND2 block is just compressed data, without any headers and<br>
those blocks should be decompressed in their turn just like chunks of IMA ADPCM<br>
compressed AUD file as it's described in AUD3.TXT. This holds only for mono<br>
soundtracks.<br>
<br>
But there're also stereo soundtracks in C&amp;C and C&amp;C: Tiberian Sun. They have<br>
different left/right channel nibbles layout.<br>
<br>
For C&amp;C (version 2) VQAs the layout is the following:<br>
LL RR LL RR ...<br>
That is, first byte contains two nibbles for two left channel values, next<br>
byte contains nibbles for right channel, etc. Note that lower nibble should<br>
be processed first and then higher one (see AUD3.TXT).<br>
<br>
For C&amp;C: Tiberian Sun (version 3) VQAs the layout is different: in SND2 block<br>
first go all nibbles for left channel, then all nibbles for right channel:<br>
LL LL LL ... LL RR RR RR ... RR<br>
Note that nibbles should be processed in the same turn: lower nibble first.<br>
So, when decoding SND2 block, just decompress first half of the block data<br>
for left channel, then second half -- for right channel.</em></em></div>

			
			
									
						<div id='list_thanks8664'>
</div>
<div id='div_post_reput8664'>
</div>

							<div id="sig8664" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8665" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8665">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8665" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8665">

					<h3 >
						<a href="./viewtopic.php?p=8665#p8665"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8665/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8665" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8665' href="./viewtopic.php?f=10&amp;p=8665&amp;thanks=8665&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8665#p8665" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-26T00:00:24+00:00">Thu May 26, 2005 1:00 am</time>
			</p>
			
			
			
			<div class="content">Need For Speed FSH format <br>
<br>
These store the different bitmaps that make up the dashboard.<br>
The 16-byte header format is the following :<br>
<br>
<br>
offset len data<br>
------ --- ----<br>
00      4  'SHPI'<br>
04      4  length of the file in bytes<br>
08      4  number of objects in the directory<br>
0C      4  directory identifier string<br>
    The directory identifier is 'GIMX' in .FSH dashboard files.<br>
<br>
    This header is followed by the directory entries, each consisting of a 4-byte identifier string, and a 4-byte offset inside the file pointing to the beginning of the corresponding data.<br>
<br>
    Each entry in the directory represents a piece of the dashboard. There are gaps between the directory and the first bitmap, and between consecutive bitmaps (significance unknown).<br>
<br>
    Each directory entry points to a bitmap block with the following structure :<br>
<br>
<br>
offset len data<br>
------ --- ----<br>
00      1  7Bh<br>
01      3  size of the block (= width x length + 10h)<br>
04      2  width of the bitmap in pixels<br>
06      2  heigth of the bitmap in pixels<br>
08      4  ?<br>
0C      2  x position to display the bitmap<br>
0E      2  y position to display the bitmap<br>
10     w.h bitmap data : 1 byte per pixel<br>
    Note that the object called 'dash' in the directory takes the whole screen (320x200 or 640x480, at position x=0, y=0)."<br>
<br>
    The various objects, depending on their 4-letter identifier, represent : the dashboard itself, the steering wheel in various positions, the radar detector lights, the gauges, and also pieces of the steering wheel to redraw over the gauges when necessary. Note that value FF in the bitmaps stands for the background : this is useful when a bitmap is drawn on top of another one.<br>
<br>
    Also note that some SHPI bitmap directories contain entries that actually describe the palette to be used with the bitmaps. Typically, entries with names like '!PAL', and with bitmap dimension 256x3, correspond to palettes. The palette data consists of 256 3-byte records, each record containing the red, green and blue components of the corresponding color (1 byte each).</div>

			
			
									
						<div id='list_thanks8665'>
</div>
<div id='div_post_reput8665'>
</div>

							<div id="sig8665" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8666" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8666">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8666" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8666">

					<h3 >
						<a href="./viewtopic.php?p=8666#p8666"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8666/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8666" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8666' href="./viewtopic.php?f=10&amp;p=8666&amp;thanks=8666&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8666#p8666" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-26T00:01:30+00:00">Thu May 26, 2005 1:01 am</time>
			</p>
			
			
			
			<div class="content">Operation Flashpoint RTM format <br>
<br>
Types: <br>
<br>
integer - 32-bit signed integer<br>
float32 - 32-bit floatnumber (single precision)<br>
zstring32 - zero-terminated string with fixed length = 32 (padding), so max. string length = 31<br>
<br>
File Structure: <br>
<br>
<br>
Size (Type)            Explanation <br>
---------------------------------- <br>
4    (integer)         Signature (0x5f4d5452 = 'RTM_') <br>
4    (integer)         Version (0x31303130 = '0101' = 1.1) <br>
12   (Vertex)          Total Moving for [x,y,z] (apply to all<br>
                       components, all frames - see below) <br>
4    (integer)         Frames Count <br>
4    (integer)         Components Count (named selections) <br>
-    (zstring32 Array) Component Names Table, elemetns<br>
                       count = Components Count <br>
-    (Frame Array)     Frames Table, elemetns count = Frames Count <br>
Vertex: <br>
<br>
<br>
Size (Type)    Explanation<br>
--------------------------<br>
4    (float32) X value<br>
4    (float32) Y value<br>
4    (float32) Z value<br>
Frame: <br>
<br>
<br>
Size (Type)                  Explanation<br>
----------------------------------------<br>
4    (float32)               KeyFrame Time (valid values: 0.0 .. 1.0)<br>
32   (zstring32)             Component Name<br>
48   (Transformation Matrix) Component Transformation Matrix<br>
Transformation Matrix: <br>
<br>
<br>
Size (Type)    Explanation<br>
--------------------------<br>
4    (float32) M11<br>
4    (float32) M12<br>
4    (float32) M13<br>
4    (float32) M21<br>
4    (float32) M22<br>
4    (float32) M23<br>
4    (float32) M31<br>
4    (float32) M32<br>
4    (float32) M33<br>
4    (float32) M41<br>
4    (float32) M42<br>
4    (float32) M43<br>
So final 4x4 matrix looks like:<br>
<br>
<br>
M11 M12 M13 0.0<br>
M21 M22 M23 0.0<br>
M31 M32 M33 0.0<br>
M41 M42 M43 1.0<br>
If Total Moving (TM) field used:<br>
<br>
<br>
M11        M12        M13        0.0<br>
M21        M22        M23        0.0<br>
M31        M32        M33        0.0<br>
(M41+TM.X) (M42+TM.Y) (M43+TM.Z) 1.0<br>
i.e. if you not applyed TM then character (soldier) will be running at the same place.<br>
<br>
Notes:<br>
1. Most of animations have TM = (0, 0, 0).<br>
2. The same transform matrix used also for wrp-file inserted objects.<br>
3. For applying animation to characters models (soldiers) you must first to center model.<br>
<br>
So new vertex position will be:<br>
(LC- LandContact)<br>
x' = x - LC.x;<br>
y' = y - LC.y;<br>
z' = z - LC.z;<br>
x'' = M11 * x' + M21 * y' + M31 * z' + M41 + TM.X<br>
y'' = M12 * x' + M22 * y' + M32 * z' + M42 + TM.Y<br>
z'' = M13 * x' + M23 * y' + M33 * z' + M43 + TM.Z</div>

			
			
									
						<div id='list_thanks8666'>
</div>
<div id='div_post_reput8666'>
</div>

							<div id="sig8666" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8667" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8667">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8667" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8667">

					<h3 >
						<a href="./viewtopic.php?p=8667#p8667"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8667/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8667" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8667' href="./viewtopic.php?f=10&amp;p=8667&amp;thanks=8667&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8667#p8667" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-26T00:03:38+00:00">Thu May 26, 2005 1:03 am</time>
			</p>
			
			
			
			<div class="content">Total Annihilation GAF <br>
<br>
I'm also a big believer in examples, so I'll be walking you through a GAF<br>
file (Archipelago.GAF) as I explain.<br>
<br>
The first part of the file is the header, which looks like this:<br>
<br>
typedef struct _GAFHEADER {<br>
  long IDVersion;  /* Version stamp - always 0x00010100 */<br>
  long Entries;    /* Number of items contained in this file */<br>
  long Unknown1;   /* Always 0 */<br>
} GAFHEADER;<br>
<br>
Let's look at a sample header:<br>
00000000  00 01 01 00 39 00 00 00 00 00 00 00<br>
<br>
IDVersion is 0x00010100 like we expect.  Entries is 0x39, indicating that<br>
there are 57 items contained in this file.<br>
<br>
Immediately following the header is a list of pointers, one for each entry.<br>
<br>
The list of pointers here looks like:<br>
00000000                                      68 EA 04 00<br>
00000010  98 EA 04 00 C8 EA 04 00 F8 EA 04 00 78 EB 04 00<br>
00000020  A0 EB 04 00 C0 ED 04 00 40 EE 04 00 68 EE 04 00<br>
00000030  98 EE 04 00 C8 EE 04 00 F8 EE 04 00 78 EF 04 00<br>
00000040  A8 EF 04 00 C8 F1 04 00 48 F2 04 00 78 F2 04 00<br>
00000050  A8 F2 04 00 D8 F2 04 00 08 F3 04 00 88 F3 04 00<br>
00000060  A8 F5 04 00 28 F6 04 00 58 F6 04 00 88 F6 04 00<br>
00000070  B8 F6 04 00 E8 F6 04 00 18 F7 04 00 B8 F7 04 00<br>
00000080  E8 F7 04 00 20 FB 04 00 C0 FB 04 00 F0 FB 04 00<br>
00000090  20 FC 04 00 50 FC 04 00 80 FC 04 00 20 FD 04 00<br>
000000A0  68 00 05 00 08 01 05 00 38 01 05 00 68 01 05 00<br>
000000B0  98 01 05 00 C8 01 05 00 68 02 05 00 98 02 05 00<br>
000000C0  F0 05 05 00 90 06 05 00 C0 06 05 00 F0 06 05 00<br>
000000D0  68 07 05 00 28 08 05 00 58 08 05 00 88 08 05 00<br>
000000E0  B8 08 05 00 E8 08 05 00 18 09 05 00 48 09 05 00<br>
<br>
The next byte after the pointer list is at offset F0.  Remember this.<br>
<br>
Each pointer points to a structure that looks like this:<br>
<br>
typedef struct _GAFENTRY {<br>
  short Frames;    /* Number of frames in this entry */<br>
  short Unknown1;  /* Unknown - always 1 */<br>
  long Unknown2;   /* Unknown - always 0 */<br>
  char Name[32];   /* Name of the entry */<br>
} GAFENTRY;<br>
<br>
The first pointer is directs us to location 0x04EA68.  Going<br>
there, we find:<br>
<br>
0004EA60                          01 00 01 00 00 00 00 00   t...............<br>
0004EA70  46 72 6F 6E 64 30 31 00 00 00 00 00 00 00 00 00   Frond01.........<br>
0004EA80  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................<br>
<br>
This entry has 1 frame, and is called 'Frond01'.<br>
<br>
Following each entry is another list of structures, one for each frame.<br>
<br>
typedef struct _GAFFRAMEENTRY {<br>
  long PtrFrameTable;  /* Pointer to frame data */<br>
  long Unknown1;       /* Unknown - varies */<br>
} GAFFRAMEENTRY;<br>
<br>
The frame entry looks like this:<br>
<br>
0004EA90  78 D5 03 00 02 00 00 00<br>
<br>
PtrFrameTable is 0x03D578.  This points us to a structure containing data<br>
about the first frame in this entry.  It looks like this:<br>
<br>
typedef struct _GAFFRAMEDATA {<br>
  short Width;         /* Width of the frame */<br>
  short Height;        /* Height of the frame */<br>
  short XPos;          /* X offset */<br>
  short YPos;          /* Y offset */<br>
  char Unknown1;       /* Unknown - always 9 */<br>
  char Compressed;     /* Compression flag */<br>
  short FramePointers;  /* Count of subframes */<br>
  long Unknown2;       /* Unknown - always 0 */<br>
  long PtrFrameData;   /* Pointer to pixels or subframes */<br>
  long Unknown3;       /* Unknown - value varies */<br>
} GAFFRAMEDATA;<br>
<br>
Here's the data:<br>
<br>
0003D570                          31 00 1F 00 15 00 0F 00<br>
0003D580  09 01 00 00 00 00 00 00 F0 00 00 00 00 00 00 00<br>
<br>
Width and height are (duh) the width and height of the frame.  This frame is<br>
0x31 by 0x1F pixels (49 x 31).<br>
<br>
XPos and YPos are actually offsets that give the displacement of the frame<br>
from the entry's actual position on the map.  So if the entry itself was<br>
placed at position 100,100, the frame would be at position<br>
100-XPos,100-YPos. These offset can be negative.  Here, they place the frame<br>
at 21 pixels left, and 15 pixels above the initial placement of the item on<br>
the map.<br>
<br>
Unknown1 is always 9.  No idea what it really means.<br>
<br>
Compressed is the compression flag.  If it's 0, the image is not compressed.<br>
This image is compressed. More on this in a bit.<br>
<br>
FramePointers.  This is where it gets a little weird.  If FramePointers is<br>
0, then PtrFrameData points to pixel data.  If it isn't, then PtrFrameData<br>
points to a list of that many more pointers to GAFFRAMEDATA structures. <br>
Each of these subframes is collectively treated as one frame.  More in this<br>
in a bit.<br>
<br>
Unknown2 is always 0.<br>
<br>
PtrFrameData points to the pixel data or to more GAFFRAMEDATA structures,<br>
depending on the value of FramePointers.  Here it's pointing to offset 0xF0.<br>
If you remember, this is the first byte after the list of entry pointers way<br>
back at the start of the file.<br>
<br>
Unknown3 is a mystery.  Sometimes the value is 0.  Sometimes it isn't.  No<br>
idea what it means or how to calculate it.<br>
<br>
Ok.  Now we have this frame entry.  Since FramePointers is 0, PtrFrameData<br>
points to pixel data.  If the frame were not compressed, it'd just be the<br>
raw pixels, 31 chunks of 49 bytes each, corresponding to each line.  This<br>
frame is compressed, so things are a little different.<br>
<br>
Let's look at the data:<br>
<br>
000000F0  07 00 29 00 44 17 00 45 21 0E 00 1B 00 44 17 04 <br>
00000100  44 B3 07 00 45 09 00 44 1B 10 00 1B 00 A3 0D 00<br>
00000110  44 07 00 A2 03 00 A2 0F 00 44 1D 16 00 13 00 45<br>
00000120  07 00 44 03 00 45 13 00 44 03 00 45 09 00 45 03<br>
00000130  00 A3 1D 1F 00 15 00 45 07 04 44 A3 07 00 45 03<br>
00000140  00 44 03 00 44 03 00 A3 03 00 45 03 00 45 03 08<br>
00000150  44 B3 A2 1F 1D 00 09 04 45 44 0B 04 44 45 07 08<br>
00000160  44 A3 44 03 00 A2 03 04 A2 B3 05 00 45 05 08 44<br>
00000170  A3 B3 23 25 00 0D 00 45 03 04 B3 44 05 00 45 07<br>
00000180  08 A3 44 B3 03 04 44 5B 05 06 45 05 00 44 03 04<br>
00000190  A2 45 09 04 44 45 07 00 44 0F 2B 00 0F 00 A2 03<br>
000001A0  00 45 03 00 45 03 00 44 03 00 45 03 04 B4 35 03<br>
000001B0  00 B3 05 08 45 B3 44 03 04 A2 46 03 08 B4 44 A2<br>
000001C0  05 00 44 0D 00 44 0D 2B 00 09 00 45 05 34 45 44 <br>
000001D0  A3 45 A2 44 B4 45 45 B3 36 45 45 35 03 0C A2 46<br>
000001E0  A3 45 03 04 45 46 03 00 A2 03 04 B3 45 03 00 45<br>
000001F0  0B 00 44 0F 28 00 0B 04 45 A2 05 38 B2 A3 B4 A2<br>
00000200  A2 B4 45 A2 45 45 A3 46 44 46 44 03 14 A2 46 46<br>
00000210  44 B3 37 03 00 35 03 04 A2 45 05 06 45 13 2B 00 <br>
00000220  04 A3 44 03 00 44 07 34 B4 A2 44 45 46 45 46 A2<br>
00000230  A2 46 A2 B4 46 A2 03 04 B3 44 03 24 B2 A2 44 A2<br>
00000240  36 A2 45 B4 A2 46 03 04 46 44 17 2A 00 09 08 44<br>
00000250  A3 44 05 08 A3 45 36 03 60 A2 45 B2 45 45 A2 A2<br>
00000260  B4 44 A3 35 45 A3 44 B4 A2 46 B2 45 A2 A2 B2 46<br>
00000270  44 A3 07 04 A2 45 0D 29 00 0B 10 44 45 45 B3 45<br>
00000280  03 60 46 44 45 46 A2 45 B3 45 B2 35 A3 44 B3 A3<br>
00000290  B4 A1 46 45 45 A2 46 A2 B4 45 45 03 0C 46 44 A2<br>
000002A0  45 11 2F 00 00 44 03 0C 44 A3 45 B3 03 04 45 35<br>
000002B0  03 00 44 03 0C 45 B4 45 B4 03 58 46 A2 45 B3 44<br>
000002C0  A3 44 45 A2 46 44 45 45 46 44 44 45 A2 44 45 B4<br>
000002D0  A2 46 13 28 00 00 A3 05 00 45 07 00 46 03 00 45<br>
000002E0  03 04 45 A3 0E 45 48 A2 46 45 A2 46 B4 A2 45 46<br>
000002F0  B3 46 45 46 46 45 A2 A2 B4 A3 0A 45 15 31 00 0B<br>
00000300  20 A2 45 45 35 B3 44 46 45 45 03 06 45 00 46 03<br>
00000310  5C A2 46 44 A2 45 B3 45 45 46 36 B3 A1 A3 44 B2<br>
00000320  A2 45 B4 A2 A2 B3 45 44 45 03 04 A3 44 05 00 44<br>
00000330  2F 00 07 00 45 03 04 45 A3 03 14 B3 36 A3 B2 45<br>
00000340  45 03 70 45 A3 B3 36 45 46 B3 A2 44 A3 45 A3 44<br>
00000350  46 35 B4 45 B3 35 46 A2 36 45 B4 36 A2 A3 B2 45<br>
00000360  0B 2C 00 09 00 45 07 0C A3 45 45 36 03 06 45 20<br>
00000370  B4 45 A2 5B 46 36 45 B4 45 03 24 46 44 46 B3 A2<br>
00000380  45 45 A3 A1 B4 05 0C 46 A2 B4 5A 07 00 45 09 2A<br>
00000390  00 07 00 45 03 04 44 45 03 3C 45 B3 A2 45 45 38<br>
000003A0  A2 45 44 45 45 46 45 45 A2 45 03 28 37 B4 45 A2<br>
000003B0  46 44 46 45 46 45 45 07 00 45 13 26 00 09 28 A3<br>
000003C0  45 B3 A2 46 45 A2 B2 A3 44 38 03 04 B3 45 03 00<br>
000003D0  45 03 00 45 09 18 45 46 A1 36 B4 A2 46 05 08 B3<br>
000003E0  45 45 17 27 00 0F 00 46 0A 45 08 A3 45 46 03 06<br>
000003F0  5B 00 A3 03 0C 5B 45 45 37 05 04 45 A2 03 04 45<br>
00000400  B4 03 04 45 A2 07 00 45 05 00 45 13 24 00 09 06<br>
00000410  45 14 46 44 A3 44 B3 45 03 00 38 05 00 5A 05 04<br>
00000420  44 A3 07 14 46 45 B2 35 45 A2 05 04 44 45 0D 06<br>
00000430  45 0F 23 00 07 00 45 09 04 B3 37 03 00 45 05 00<br>
00000440  36 03 00 44 03 04 45 B3 05 20 45 44 A2 46 44 A3<br>
00000450  B3 44 45 0B 00 44 19 1B 00 0D 0C 45 A2 5A 37 0B<br>
00000460  04 44 A3 03 04 46 A3 03 08 35 B3 45 07 04 B3 45<br>
00000470  0F 00 A3 19 1C 00 0B 04 44 A2 07 00 46 07 08 44<br>
00000480  46 44 07 06 45 03 00 45 03 00 45 03 00 35 03 00<br>
00000490  A2 27 15 00 09 00 45 11 08 44 45 A3 09 00 44 05<br>
000004A0  00 A2 0B 00 46 0F 00 44 17 0B 00 1B 00 A3 11 04<br>
000004B0  B3 44 0D 00 44 25 08 00 19 04 B3 44 0B 00 44 3B<br>
000004C0  07 00 19 00 36 0D 00 45 3B 07 00 27 00 A2 05 00<br>
000004D0  A2 35 04 00 2B 00 44 37 <br>
<br>
PtrFrameData points to a short integer that is a count of bytes for the<br>
first line. Skip ahead that many bytes, and you get to a count for the<br>
second line, etc, etc.  The first line is 7 bytes long, and consists of 29<br>
00 44 17 00 45 21. The Height parameter tells you how many lines there are,<br>
in this case, 31. Broken into lines, minus the length data, we get:<br>
<br>
Line   0 29 00 44 17 00 45 21<br>
Line   1 1B 00 44 17 04 44 B3 07 00 45 09 00 44 1B<br>
Line   2 1B 00 A3 0D 00 44 07 00 A2 03 00 A2 0F 00 44 1D<br>
Line   3 13 00 45 07 00 44 03 00 45 13 00 44 03 00 45 09 00 45 03 00 A3 1D<br>
Line   4 15 00 45 07 04 44 A3 07 00 45 03 00 44 03 00 44 03 00 A3 03 00 45 03 00 45 03 08 44 B3 A2 1F<br>
Line   5 09 04 45 44 0B 04 44 45 07 08 44 A3 44 03 00 A2 03 04 A2 B3 05 00 45 05 08 44 A3 B3 23<br>
Line   6 0D 00 45 03 04 B3 44 05 00 45 07 08 A3 44 B3 03 04 44 5B 05 06 45 05 00 44 03 04 A2 45 09 04 44 45 07 00 44 0F<br>
Line   7 0F 00 A2 03 00 45 03 00 45 03 00 44 03 00 45 03 04 B4 35 03 00 B3 05 08 45 B3 44 03 04 A2 46 03 08 B4 44 A2 05 00 44 0D 00 44 0D<br>
Line   8 09 00 45 05 34 45 44 A3 45 A2 44 B4 45 45 B3 36 45 45 35 03 0C A2 46 A3 45 03 04 45 46 03 00 A2 03 04 B3 45 03 00 45 0B 00 44 0F<br>
Line   9 0B 04 45 A2 05 38 B2 A3 B4 A2 A2 B4 45 A2 45 45 A3 46 44 46 44 03 14 A2 46 46 44 B3 37 03 00 35 03 04 A2 45 05 06 45 13<br>
Line  10 04 A3 44 03 00 44 07 34 B4 A2 44 45 46 45 46 A2 A2 46 A2 B4 46 A2 03 04 B3 44 03 24 B2 A2 44 A2 36 A2 45 B4 A2 46 03 04 46 44 17<br>
Line  11 09 08 44 A3 44 05 08 A3 45 36 03 60 A2 45 B2 45 45 A2 A2 B4 44 A3 35 45 A3 44 B4 A2 46 B2 45 A2 A2 B2 46 44 A3 07 04 A2 45 0D<br>
Line  12 0B 10 44 45 45 B3 45 03 60 46 44 45 46 A2 45 B3 45 B2 35 A3 44 B3 A3 B4 A1 46 45 45 A2 46 A2 B4 45 45 03 0C 46 44 A2 45 11<br>
Line  13 00 44 03 0C 44 A3 45 B3 03 04 45 35 03 00 44 03 0C 45 B4 45 B4 03 58 46 A2 45 B3 44 A3 44 45 A2 46 44 45 45 46 44 44 45 A2 44 45 B4 A2 46 13<br>
Line  14 00 A3 05 00 45 07 00 46 03 00 45 03 04 45 A3 0E 45 48 A2 46 45 A2 46 B4 A2 45 46 B3 46 45 46 46 45 A2 A2 B4 A3 0A 45 15<br>
Line  15 0B 20 A2 45 45 35 B3 44 46 45 45 03 06 45 00 46 03 5C A2 46 44 A2 45 B3 45 45 46 36 B3 A1 A3 44 B2 A2 45 B4 A2 A2 B3 45 44 45 03 04 A3 44 05 00 44<br>
Line  16 07 00 45 03 04 45 A3 03 14 B3 36 A3 B2 45 45 03 70 45 A3 B3 36 45 46 B3 A2 44 A3 45 A3 44 46 35 B4 45 B3 35 46 A2 36 45 B4 36 A2 A3 B2 45 0B<br>
Line  17 09 00 45 07 0C A3 45 45 36 03 06 45 20 B4 45 A2 5B 46 36 45 B4 45 03 24 46 44 46 B3 A2 45 45 A3 A1 B4 05 0C 46 A2 B4 5A 07 00 45 09<br>
Line  18 07 00 45 03 04 44 45 03 3C 45 B3 A2 45 45 38 A2 45 44 45 45 46 45 45 A2 45 03 28 37 B4 45 A2 46 44 46 45 46 45 45 07 00 45 13<br>
Line  19 09 28 A3 45 B3 A2 46 45 A2 B2 A3 44 38 03 04 B3 45 03 00 45 03 00 45 09 18 45 46 A1 36 B4 A2 46 05 08 B3 45 45 17<br>
Line  20 0F 00 46 0A 45 08 A3 45 46 03 06 5B 00 A3 03 0C 5B 45 45 37 05 04 45 A2 03 04 45 B4 03 04 45 A2 07 00 45 05 00 45 13<br>
Line  21 09 06 45 14 46 44 A3 44 B3 45 03 00 38 05 00 5A 05 04 44 A3 07 14 46 45 B2 35 45 A2 05 04 44 45 0D 06 45 0F<br>
Line  22 07 00 45 09 04 B3 37 03 00 45 05 00 36 03 00 44 03 04 45 B3 05 20 45 44 A2 46 44 A3 B3 44 45 0B 00 44 19<br>
Line  23 0D 0C 45 A2 5A 37 0B 04 44 A3 03 04 46 A3 03 08 35 B3 45 07 04 B3 45 0F 00 A3 19<br>
Line  24 0B 04 44 A2 07 00 46 07 08 44 46 44 07 06 45 03 00 45 03 00 45 03 00 35 03 00 A2 27<br>
Line  25 09 00 45 11 08 44 45 A3 09 00 44 05 00 A2 0B 00 46 0F 00 44 17<br>
Line  26 1B 00 A3 11 04 B3 44 0D 00 44 25<br>
Line  27 19 04 B3 44 0B 00 44 3B<br>
Line  28 19 00 36 0D 00 45 3B<br>
Line  29 27 00 A2 05 00 A2 35<br>
Line  30 2B 00 44 37<br>
<br>
To decode the line, to the following:<br>
<br>
1. Read a byte.  This is a mask.<br>
2. If (mask &amp; 0x01) = 0x01<br>
     skip ahead (mask &gt;&gt; 1) pixels.  This is transparency, allowing whatever<br>
        was under the frame to show through.<br>
   else if (mask &amp; 0x02) = 0x02<br>
     copy the next byte (mask &gt;&gt; 2)+1 times to output.<br>
   else <br>
     copy the next (mask &amp; 0x02)+1 bytes to output.<br>
3. go back to 1, until there are no more bytes left in the line.<br>
<br>
A C code fragment to do this is:<br>
<br>
  char *data;  // points to pixel data<br>
<br>
for (y = 0; y &lt; FrameData.Height; y++) {<br>
  bytes = *((short *) data);<br>
  data += sizeof(short);<br>
  count = 0;<br>
  x = 0;<br>
  while (count &lt; bytes) {<br>
    mask = (unsigned char) data[count++];<br>
    if ((mask &amp; 0x01) == 0x01) {<br>
      // transparent<br>
      x += (mask &gt;&gt; 1);<br>
    else if ((mask &amp; 0x02) == 0x02) {<br>
      // repeat next byte<br>
      repeat = (mask &gt;&gt; 2) + 1;<br>
      while (repeat--)<br>
        putpixel(x++, y, data[count]);<br>
      count++;<br>
    }<br>
    else {<br>
      repeat = (mask &gt;&gt; 2) + 1;<br>
      while (repeat--)<br>
        putpixel(x++, y, data[count++]);<br>
    }<br>
  }<br>
  data += bytes;  // point to next line<br>
}<br>
<br>
We do this to the above mess of data, and we get:<br>
<br>
Line   0                                                             44                                  45                                                *<br>
Line   1                                        44                                  44 B3          45             44                                       *<br>
Line   2                                        A3                   44          A2    A2                      44                                          *<br>
Line   3                            45          44    45                            44    45             45    A3                                          *<br>
Line   4                               45          44 A3          45    44    44    A3    45    45    44 B3 A2                                             *<br>
Line   5             45 44                44 45          44 A3 44    A2    A2 B3       45       44 A3 B3                                                   *<br>
Line   6                   45    B3 44       45          A3 44 B3    44 5B       45 45       44    A2 45             44 45          44                     *<br>
Line   7                      A2    45    45    44    45    B4 35    B3       45 B3 44    A2 46    B4 44 A2       44                   44                  *<br>
Line   8             45       45 44 A3 45 A2 44 B4 45 45 B3 36 45 45 35    A2 46 A3 45    45 46    A2    B3 45    45                44                     *<br>
Line   9                45 A2       B2 A3 B4 A2 A2 B4 45 A2 45 45 A3 46 44 46 44    A2 46 46 44 B3 37    35    A2 45       45 45                           *<br>
Line  10 A3 44    44          B4 A2 44 45 46 45 46 A2 A2 46 A2 B4 46 A2    B3 44    B2 A2 44 A2 36 A2 45 B4 A2 46    46 44                                 *<br>
Line  11             44 A3 44       A3 45 36    A2 45 B2 45 45 A2 A2 B4 44 A3 35 45 A3 44 B4 A2 46 B2 45 A2 A2 B2 46 44 A3          A2 45                  *<br>
Line  12                44 45 45 B3 45    46 44 45 46 A2 45 B3 45 B2 35 A3 44 B3 A3 B4 A1 46 45 45 A2 46 A2 B4 45 45    46 44 A2 45                        *<br>
Line  13 44    44 A3 45 B3    45 35    44    45 B4 45 B4    46 A2 45 B3 44 A3 44 45 A2 46 44 45 45 46 44 44 45 A2 44 45 B4 A2 46                           *<br>
Line  14 A3       45          46    45    45 A3 45 45 45 45 A2 46 45 A2 46 B4 A2 45 46 B3 46 45 46 46 45 A2 A2 B4 A3 45 45 45                              *<br>
Line  15                A2 45 45 35 B3 44 46 45 45    45 45 46    A2 46 44 A2 45 B3 45 45 46 36 B3 A1 A3 44 B2 A2 45 B4 A2 A2 B3 45 44 45    A3 44       44*<br>
Line  16          45    45 A3    B3 36 A3 B2 45 45    45 A3 B3 36 45 46 B3 A2 44 A3 45 A3 44 46 35 B4 45 B3 35 46 A2 36 45 B4 36 A2 A3 B2 45               *<br>
Line  17             45          A3 45 45 36    45 45 B4 45 A2 5B 46 36 45 B4 45    46 44 46 B3 A2 45 45 A3 A1 B4       46 A2 B4 5A          45            *<br>
Line  18          45    44 45    45 B3 A2 45 45 38 A2 45 44 45 45 46 45 45 A2 45    37 B4 45 A2 46 44 46 45 46 45 45          45                           *<br>
Line  19             A3 45 B3 A2 46 45 A2 B2 A3 44 38    B3 45    45    45             45 46 A1 36 B4 A2 46       B3 45 45                                 *<br>
Line  20                      46 45 45 45 A3 45 46    5B 5B A3    5B 45 45 37       45 A2    45 B4    45 A2          45       45                           *<br>
Line  21             45 45 46 44 A3 44 B3 45    38       5A       44 A3          46 45 B2 35 45 A2       44 45                   45 45                     *<br>
Line  22          45             B3 37    45       36    44    45 B3       45 44 A2 46 44 A3 B3 44 45                44                                    *<br>
Line  23                   45 A2 5A 37                44 A3    46 A3    35 B3 45          B3 45                      A3                                    *<br>
Line  24                44 A2          46          44 46 44          45 45    45    45    35    A2                                                         *<br>
Line  25             45                         44 45 A3             44       A2                46                      44                                 *<br>
Line  26                                        A3                         B3 44                   44                                                      *<br>
Line  27                                     B3 44                44                                                                                       *<br>
Line  28                                     36                   45                                                                                       *<br>
Line  29                                                          A2       A2                                                                              *<br>
Line  30                                                                44                                                                                 *<br>
<br>
This is essentially a big green splat, used to represent a patch of<br>
reclaimable foliage.</div>

			
			
									
						<div id='list_thanks8667'>
</div>
<div id='div_post_reput8667'>
</div>

							<div id="sig8667" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8668" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8668">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8668" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8668">

					<h3 >
						<a href="./viewtopic.php?p=8668#p8668"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8668/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8668" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8668' href="./viewtopic.php?f=10&amp;p=8668&amp;thanks=8668&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8668#p8668" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-26T00:10:22+00:00">Thu May 26, 2005 1:10 am</time>
			</p>
			
			
			
			<div class="content">Total Annihilation HPI format<br>
<br>
HPI File Format<br>
<br>
I figured some of this stuff out by disassembling WriteHPI.  All hail<br>
Eric DeZert.<br>
<br>
I'd also like to thank Jesse Michael for his clear and concise explanation<br>
of the compression scheme (which I shamelessly incorporated into this document),<br>
and Barry Pedersen for helpful comments and miscellaneous useful info.<br>
<br>
ZLib compression and decompression by Jean-loup Gailly (compression) and <br>
Mark Adler (decompression). <br>
For more info, see the zlib Home Page at <a href="http://www.cdrom.com/pub/infozip/zlib/" class="postlink">http://www.cdrom.com/pub/infozip/zlib/</a><br>
<br>
The rest I figured out on my own by looking at the data and using<br>
a bit of common sense.<br>
<br>
Warning: This is intended for use by people that already know what<br>
they're doing.<br>
<br>
I'm a C programmer, so I'm doing things in C notation here, but<br>
I'll try to explain it so that those of you that don't speak C<br>
will be able to understand.  If you don't understand, write me<br>
at <a href="mailto:joed@cws.org">joed@cws.org</a> and I'll try to clear things up.<br>
<br>
I'm also a big believer in examples, so I'll be walking you through<br>
an HPI file as I explain.<br>
<br>
The first part of the file is a header.  Except for the copyright<br>
statement at the end, this is the only unencrypted portion of the <br>
file.  The header looks like this:<br>
<br>
typedef struct _HPIHeader {<br>
  long HPIMarker;		  /* 'HAPI' */<br>
  long SaveMarker;        /* 'BANK' if saved gamed */<br>
  long DirectorySize;     /* The size of the directory */<br>
  long HeaderKey;         /* Decrypt key */<br>
  long Start;             /* File offset of directory */<br>
} HPIHeader;<br>
<br>
Here's a hex dump of a sample header:<br>
00000000  48 41 50 49 00 00 01 00 24 02 00 00 7D 00 00 00   HAPI....$...}...<br>
00000010  14 00 00 00 <br>
<br>
Taken individually:<br>
<br>
HPIMarker<br>
<br>
This is just a marker.  The value is always HAPI in ASCII.  In <br>
hex, it's 0x49504148.<br>
<br>
SaveMarker<br>
<br>
If it's a saved game, the value is BANK in ASCII, or 0x4B4E4142 in<br>
hex.  Save game files are something of a special case, and I haven't<br>
done much to try to decode those.  The value in normal HPI files is<br>
0x00010000, but I have no idea if this means anything.  I just check<br>
for BANK, and ignore it otherwise.<br>
<br>
DirectorySize<br>
<br>
This is the size of the directory contained in the HPI file.  Here,<br>
the value is 0x224, or 548 bytes.  This includes the size of the<br>
header.<br>
<br>
HeaderKey<br>
<br>
The decryption key.  Its value is 0x0000007D.  More on this later.<br>
<br>
Start<br>
<br>
The offset in the file where the directory starts.  I have yet to<br>
see one that didn't start immediately after the header at offset<br>
0x14, but you never know.<br>
<br>
Now we know enough to read the directory.  But first, a small<br>
implementation note.  Instead of allocating a buffer of DirectorySize<br>
bytes and then reading the directory into it, allocate a buffer of<br>
DirectorySize bytes, and read DirectorySize-Start bytes into the buffer<br>
at position Start.  This is because the directory contains pointers,<br>
but the pointers are relative to the start of the file, not the start<br>
of the directory.  By moving the directory down Start bytes into the<br>
buffer, we simplify the program.  If we didn't do this, we'd have to<br>
subtract Start from every offset, and that would be a royal pain.<br>
<br>
Now some of you are undoubtedly looking at an HPI file with a hex dump<br>
program, and saying "That sure doesn't look like a directory to me!"<br>
Well, you're right.  That's because it's encrypted.<br>
<br>
To decrypt it, first calculate the decryption key from the HeaderKey<br>
variable:<br>
<br>
Key = NOT ((HeaderKey * 4) OR (HeaderKey &gt;&gt; 6))<br>
<br>
Doing this on the 0x0000007D, you get FFFFFE0A (I think).<br>
<br>
Here is the C code for the decryption routine.  Since everything in the<br>
file is encrypted, I found it easier to combine the read and decryption<br>
functions into one.<br>
<br>
int ReadAndDecrypt(int fpos, char *buff, int buffsize)<br>
/*<br>
Read "buffsize" bytes from the HPI file at position "fpos"<br>
into "buff", and then decrypt it.<br>
*/<br>
{<br>
  int count;<br>
  int tkey;<br>
  int result;<br>
<br>
  /* first, position the file */	<br>
  fseek(HPIFile, fpos, SEEK_SET);<br>
<br>
  /* read the data into buff */<br>
  result = fread(buff, 1, buffsize, HPIFile);<br>
<br>
  /* for each character in buff... */<br>
  for (count = 0; count &lt; buffsize; count++) {<br>
<br>
    /* compute tkey = (fpos + count) XOR Key */<br>
    tkey = (fpos + count) ^ Key;<br>
<br>
	/* and then decode the character:  <br>
	   buff[count] = tkey XOR (NOT buff[count]) */<br>
    buff[count] = tkey ^ ~buff[count];<br>
  }<br>
<br>
  /* result is the number of bytes actually read in, <br>
     and should be equal to buffsize */<br>
  return result;<br>
}<br>
<br>
Note that the position of the byte in the file (fpos+count) is used to<br>
decrypt.<br>
<br>
And here is a decoded directory to make it easy to follow.  Note that<br>
I loaded the actual directory starting at offset 0x14, so that the<br>
first 0x14 bytes are all zeros.  See the implementation<br>
note above.<br>
<br>
All numbers here are 32-bit integers, ie "longs".  <br>
<br>
00000000  00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00   ................<br>
00000010  00 00 00 00 08 00 00 00 1C 00 00 00 64 00 00 00   ............d...<br>
00000020  6A 00 00 00 01 97 00 00 00 A0 00 00 00 01 C6 00   j...............<br>
00000030  00 00 CF 00 00 00 01 13 01 00 00 1D 01 00 00 01   ................<br>
00000040  66 01 00 00 6E 01 00 00 01 94 01 00 00 9D 01 00   f...n...........<br>
00000050  00 01 C3 01 00 00 C9 01 00 00 01 EF 01 00 00 F7   ................<br>
00000060  01 00 00 01 61 6E 69 6D 73 00 01 00 00 00 72 00   ....anims.....r.<br>
00000070  00 00 7B 00 00 00 8E 00 00 00 00 61 72 6D 66 6C   ..{........armfl<br>
00000080  61 6B 5F 67 61 64 67 65 74 2E 67 61 66 00 24 02   ak_gadget.gaf.$.<br>
00000090  00 00 D8 2D 00 00 01 64 6F 77 6E 6C 6F 61 64 00   ...-...download.<br>
000000A0  01 00 00 00 A8 00 00 00 B1 00 00 00 BD 00 00 00   ................<br>
000000B0  00 41 52 4D 46 4C 41 4B 2E 54 44 46 00 61 28 00   .ARMFLAK.TDF.a(.<br>
000000C0  00 01 01 00 00 01 66 65 61 74 75 72 65 73 00 01   ......features..<br>
000000D0  00 00 00 D7 00 00 00 E0 00 00 00 E8 00 00 00 01   ................<br>
000000E0  63 6F 72 70 73 65 73 00 01 00 00 00 F0 00 00 00   corpses.........<br>
000000F0  F9 00 00 00 0A 01 00 00 00 61 72 6D 66 6C 61 6B   .........armflak<br>
00000100  5F 64 65 61 64 2E 74 64 66 00 E3 28 00 00 68 02   _dead.tdf..(..h.<br>
00000110  00 00 01 6F 62 6A 65 63 74 73 33 64 00 02 00 00   ...objects3d....<br>
00000120  00 25 01 00 00 37 01 00 00 43 01 00 00 00 4C 01   .%...7...C....L.<br>
00000130  00 00 5D 01 00 00 00 61 72 6D 66 6C 61 6B 2E 33   ..]....armflak.3<br>
00000140  64 6F 00 39 2A 00 00 7B 14 00 00 01 61 72 6D 66   do.9*..{....armf<br>
00000150  6C 61 6B 5F 64 65 61 64 2E 33 64 6F 00 C9 34 00   lak_dead.3do..4.<br>
00000160  00 1A 11 00 00 01 73 63 72 69 70 74 73 00 01 00   ......scripts...<br>
00000170  00 00 76 01 00 00 7F 01 00 00 8B 01 00 00 00 41   ..v............A<br>
00000180  52 4D 46 4C 41 4B 2E 43 4F 42 00 67 3F 00 00 E4   RMFLAK.COB.g?...<br>
00000190  09 00 00 01 75 6E 69 74 70 69 63 73 00 01 00 00   ....unitpics....<br>
000001A0  00 A5 01 00 00 AE 01 00 00 BA 01 00 00 00 41 52   ..............AR<br>
000001B0  4D 46 4C 41 4B 2E 50 43 58 00 B4 42 00 00 91 25   MFLAK.PCX..B...%<br>
000001C0  00 00 01 75 6E 69 74 73 00 01 00 00 00 D1 01 00   ...units........<br>
000001D0  00 DA 01 00 00 E6 01 00 00 00 41 52 4D 46 4C 41   ..........ARMFLA<br>
000001E0  4B 2E 46 42 49 00 89 63 00 00 39 05 00 00 01 77   K.FBI..c..9....w<br>
000001F0  65 61 70 6F 6E 73 00 01 00 00 00 FF 01 00 00 08   eapons..........<br>
00000200  02 00 00 1B 02 00 00 00 61 72 6D 66 6C 61 6B 5F   ........armflak_<br>
00000210  77 65 61 70 6F 6E 2E 74 64 66 00 2D 67 00 00 42   weapon.tdf.-g..B<br>
00000220  02 00 00 01 <br>
<br>
Let's get started...<br>
<br>
00000010  00 00 00 00 08 00 00 00 1C 00 00 00 64 00 00 00   ............d...<br>
                      ^^^^^^^^^^^ ^^^^^^^^^^^<br>
<br>
At offset 0x14, you see the number 0x8.  This is the number of<br>
entries in the directory.  Grabbing the next 32-bit number at<br>
offset 0x18, you get 0x1C.  This is the offset of a list of directory entries.<br>
In this case, there are 8 entries in the list.  The format of an entry is:<br>
<br>
typedef struct _HPIEntry {<br>
  long NameOffset;      /* points to the file name */<br>
  long DirDataOffset;   /* points to directory data */<br>
  char Flag;            /* file flag */<br>
} HPIEntry;<br>
<br>
NameOffset<br>
<br>
Pointer to the file name.  This is a 0-terminated string of varying length.<br>
<br>
DirDataOffset<br>
<br>
Pointer to the directory data for the file.  The actual data varies depending<br>
on whether it's a file or a subdirectory.<br>
<br>
Flag<br>
If this is 1, the entry is a subdirectory.  If it's 0, it's a file.<br>
<br>
Looking at offset 0x1C, we see:<br>
<br>
00000010                                      64 00 00 00   ............d...<br>
00000020  6A 00 00 00 01 97 00 00 00 A0 00 00 00 01 C6 00   j...............<br>
00000030  00 00 CF 00 00 00 01 13 01 00 00 1D 01 00 00 01   ................<br>
00000040  66 01 00 00 6E 01 00 00 01 94 01 00 00 9D 01 00   f...n...........<br>
00000050  00 01 C3 01 00 00 C9 01 00 00 01 EF 01 00 00 F7   ................<br>
00000060  01 00 00 01<br>
<br>
The 8 entries are:<br>
0x064, 0x06A, 1<br>
0x097, 0x0A0, 1<br>
0x0C6, 0x0CF, 1<br>
0x113, 0x11D, 1<br>
0x166, 0x16E, 1<br>
0x194, 0x19D, 1<br>
0x1C3, 0x1C9, 1<br>
0x1EF, 0x1F7, 1<br>
<br>
Let's look at the first entry.  The Flag is 1, so it's a <br>
subdirectory.  At offset 0x64, we see:<br>
<br>
00000060  01 00 00 01 61 6E 69 6D 73 00 01 00 00 00 72 00   ....anims.....r.<br>
                      ^^^^^^^^^^^^^^^^^<br>
or 'anims'.  This is the name.  Since this is a subdirectory,<br>
offset 0x6A contains the number of entries in the subdirectory,<br>
followed by a pointer to the first entry.  This is exactly like<br>
the count/pointer pair at 0x14 that got us started.  Think recursion.<br>
<br>
00000060  01 00 00 01 61 6E 69 6D 73 00 01 00 00 00 72 00   ....anims.....r.<br>
                                        ^^^^^^^^^^^ ^^^^^ <br>
00000070  00 00 7B 00 00 00 8E 00 00 00 00 61 72 6D 66 6C   ..{........armfl<br>
          ^^^^^<br>
<br>
The number at offset 0x6A is a 1, indicating that there's only 1<br>
file in this subdirectory. 0x6E contains the offset of the first<br>
(and only) entry in the subdirectory, which is:<br>
<br>
0x7B, 0x8E, 0<br>
<br>
The 0 indicates that this is a file.  Looking at offset 0x7B, we see:<br>
<br>
00000070  00 00 7B 00 00 00 8E 00 00 00 00 61 72 6D 66 6C   ..{........armfl<br>
                                           ^^^^^^^^^^^^^^<br>
00000080  61 6B 5F 67 61 64 67 65 74 2E 67 61 66 00 24 02   ak_gadget.gaf.$.<br>
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^<br>
<br>
or 'armflak_gadget.gaf'.  This is the name of the first (and only) file<br>
in the 'anims' subdirectory.  Since this is a file, the data at offset<br>
0x8E is a little different.					   <br>
<br>
There are 3 items here instead if one:<br>
<br>
typedef struct _HPIFileData {<br>
  long DataOffset;      /* starting offset of the file */<br>
  long FileSize;        /* size of the decompressed file */<br>
  char Flag;            /* file flag */<br>
} HPIEntry;<br>
<br>
DataOffset<br>
<br>
This is the offset in the HPI file that this file starts at.<br>
<br>
FileSize<br>
<br>
This is the decompressed file size.  When you extract the file, it<br>
should be this many bytes long.<br>
<br>
Flag<br>
<br>
If this is 1, the file is compressed with LZ77 compression.<br>
If it's 2, it's compressed with ZLIb compression.<br>
If it's 0, it's not compressed at all.  This is the format used by the<br>
unit viewer.<br>
<br>
00000080  61 6B 5F 67 61 64 67 65 74 2E 67 61 66 00 24 02   ak_gadget.gaf.$.<br>
                                                    ^^^^^<br>
00000090  00 00 D8 2D 00 00 01 64 6F 77 6E 6C 6F 61 64 00   ...-...download.<br>
          ^^^^^ ^^^^^^^^^^^ ^^<br>
<br>
Looking at offset 0x8E, we see that the three items are:<br>
<br>
0x224, 0x2DD8, 1<br>
<br>
If you recall, the directory size was 0x224 bytes.  This says the file<br>
starts at the first offset after the directory, which makes sense and means<br>
we're interpreting things correctly.  This also says that the extracted <br>
file should be 0x2DD8 (or 11,736) bytes long.<br>
<br>
At this point, we know enough to actually traverse the directory tree in the<br>
HPI file.  Here's a recursive pseudocode function to do it.  The initial call<br>
to it would be 'TraverseTree(".", Header.Start)'.<br>
<br>
TraverseTree(string ParentName, int offset)<br>
<br>
Entries = Directory[offset]<br>
EntryOffset = Directory[offset+4]<br>
<br>
for count = 1 to Entries<br>
   NameOffset = Directory[EntryOffset]<br>
   DataOffset = Directory[EntryOffset+4]<br>
   Flag = Directory[EntryOffset+8]<br>
<br>
   Name = ParentName+"\"+Directory[NameOffset]<br>
<br>
   print "Processing ",Name<br>
<br>
   if Flag = 1<br>
     TraverseTree(Name, DataOffset) &lt;- recursion!<br>
   else<br>
     ProcessFile(Name, DataOffset)<br>
   End If<br>
   <br>
   EntryOffset = EntryOffset + 9<br>
Next Count<br>
<br>
If you code this up in your language of choice and run it, it<br>
should print something like this: (if you haven't guessed already,<br>
the file I'm using as an example is the "Arm Flakker" unit's<br>
aflakker.ufo file)<br>
<br>
.\anims<br>
.\anims\armflak_gadget.gaf<br>
.\download<br>
.\download\ARMFLAK.TDF<br>
.\features<br>
.\features\corpses<br>
.\features\corpses\armflak_dead.tdf<br>
.\objects3d<br>
.\objects3d\armflak.3do<br>
.\objects3d\armflak_dead.3do<br>
.\scripts<br>
.\scripts\ARMFLAK.COB<br>
.\unitpics<br>
.\unitpics\ARMFLAK.PCX<br>
.\units<br>
.\units\ARMFLAK.FBI<br>
.\weapons<br>
.\weapons\armflak_weapon.tdf<br>
<br>
At this point, I urge you to go look at that directory hex dump and<br>
traverse the thing by hand until it makes sense.<br>
<br>
I can hear you now.  "What the heck is that 'ProcessFile' function?"<br>
It decodes the file.  I'll explain in a bit.<br>
<br>
But first, here's a list of the various files in this HPI file, and<br>
their starting offsets.<br>
<br>
If you don't understand where I got the starting offsets,<br>
go reread the directory hex dump until you do.<br>
<br>
anims\armflak_gadget.gaf             0x0224<br>
download\ARMFLAK.TDF                 0x2861<br>
features\corpses\armflak_dead.tdf    0x28E3<br>
objects3d\armflak.3do                0x2A39<br>
objects3d\armflak_dead.3do           0x34C9<br>
scripts\ARMFLAK.COB                  0x3F67<br>
unitpics\ARMFLAK.PCX                 0x42B4<br>
units\ARMFLAK.FBI                    0x6389<br>
weapons\armflak_weapon.tdf           0x672D<br>
<br>
Because it's a short file, and because it decodes to readable<br>
text, I'm going to use the ARMFLAK.TDF file as the example.<br>
<br>
If the file was not compressed at all, then the file is just inserted<br>
into the HPI file as one big chunk.<br>
<br>
But if it is...<br>
<br>
This is where the -REAL- fun begins.  I'm going to take it slow<br>
here because I'm still half figuring it out myself (writing this<br>
has actually made me realize some things that I hadn't before).<br>
<br>
When the file was compressed, it was broken up into chunks of 64K (65536)<br>
bytes each, plus one more chunk to hold anything left over.  Each chunk<br>
was then compressed.  Note that some chunks are larger when compressed<br>
than decompressed, which means that some compressed chunks can be larger<br>
than 64K.<br>
<br>
The total number of chunks in the file can be obtained by<br>
the following formula:<br>
<br>
chunks = Entry.FileSize / 65536<br>
if (Entry.FileSize mod 65536) &lt;&gt; 0<br>
  chunks = chunks + 1<br>
<br>
The offset in the directory points to a list of 32-bit numbers<br>
that are the compressed sizes of each compressed chunk of data.<br>
<br>
Following the list of sizes are the actual compressed chunks<br>
of data.<br>
<br>
In this HPI file, each file has only one chunk, but the totala1.hpi file <br>
contains some files with a dozen or so, and the hpi files on the CDs have <br>
files in them with over a hundred.<br>
<br>
Going to offset 0x2861, we read in a chunk o'data and decrypt it<br>
to find this:<br>
<br>
00002860     7E 00 00 00 53 51 53 48 02 01 01 6B 00 00 00   .~...SQSH...k...<br>
00002870  01 01 00 00 FE 36 00 00 20 5B 51 49 4E 55 3C 0E   .....6.. [QINU&lt;.<br>
00002880  64 64 94 5D 49 5D 11 14 29 7B D5 26 18 55 6E 75   dd.]I]..){.&amp;.Unu<br>
00002890  64 54 34 41 79 6C 9C 71 81 83 8B 3B 59 49 CB 4D   dT4Ayl.q...;YI.M<br>
000028A0  43 D1 42 54 9A A5 A8 AA AF B0 B8 64 61 AC 6D B0   C.BT.......da.m.<br>
000028B0  B1 82 72 34 79 B8 B0 BD DD A3 82 81 E8 86 AC 89   ..r4y...........<br>
000028C0  98 92 C2 CF 98 EB 9D E0 56 BF A2 6F AB 5F A8 96   ........V..o._..<br>
000028D0  B5 C3 9F B8 EB B9 BE 7D 4F C7 5F CE 2F D1 4C D1   .......}O._./.L.<br>
000028E0  D0 D2 90 <br>
<br>
The decompressed file size of ARMFLAK.TDF is 257 bytes.  This<br>
tells us that there's only one chunk.  The size of this chunk<br>
is 0x7E bytes.  The chunk itself immediately follows.<br>
<br>
Each chunk looks like this:<br>
<br>
typedef struct _HPIChunk {<br>
  long Marker;            /* always 0x48535153 (SQSH) */<br>
  char Unknown1;<br>
  char CompMethod;        /* 1=LZ77, 2=ZLib */<br>
  char Encrypt;           /* is the block encrypted? */          <br>
  long CompressedSize;    /* the length of the compressed data */<br>
  long DecompressedSize;  /* the length of the decompressed data */<br>
  long Checksum;          /* Checksum */<br>
  char data[];            /* 'CompressedSize' bytes of data */<br>
} HPIChunk;<br>
<br>
Marker<br>
<br>
This is the start-of-chunk marker, and is always 0x48535153 (ASCII 'SQSH').<br>
<br>
Unknown1<br>
I know not what this is for.  It's always 0x02.<br>
Maybe some sort of version number?<br>
<br>
CompMethod<br>
This is the compression method.  It's 1 for LZ77, 2 for ZLib.<br>
<br>
Encrypt<br>
This tells whether the block is encrypted a second time.  See below.<br>
<br>
CompressedSize<br>
<br>
This is the size of the compressed data in the chunk.  0x6B bytes.<br>
<br>
DecompressedSize<br>
<br>
This is the size of the decompressed data in the chunk.  0x101 bytes.<br>
<br>
Checksum<br>
<br>
This is a checksum of the data.  It's merely the sum of all the bytes of<br>
data (treated as unsigned numbers) added together.<br>
<br>
data<br>
<br>
The actual compressed data in the chunk.  CompressedSize (0x6B) bytes of it.<br>
<br>
Let's look at the data.<br>
<br>
00002870                          20 5B 51 49 4E 55 3C 0E   .....6.. [QINU&lt;.<br>
00002880  64 64 94 5D 49 5D 11 14 29 7B D5 26 18 55 6E 75   dd.]I]..){.&amp;.Unu<br>
00002890  64 54 34 41 79 6C 9C 71 81 83 8B 3B 59 49 CB 4D   dT4Ayl.q...;YI.M<br>
000028A0  43 D1 42 54 9A A5 A8 AA AF B0 B8 64 61 AC 6D B0   C.BT.......da.m.<br>
000028B0  B1 82 72 34 79 B8 B0 BD DD A3 82 81 E8 86 AC 89   ..r4y...........<br>
000028C0  98 92 C2 CF 98 EB 9D E0 56 BF A2 6F AB 5F A8 96   ........V..o._..<br>
000028D0  B5 C3 9F B8 EB B9 BE 7D 4F C7 5F CE 2F D1 4C D1   .......}O._./.L.<br>
000028E0  D0 D2 90 <br>
<br>
Doesn't look like much, does it.  That's because (YOU GUESSED IT!) it's<br>
encrypted yet again!  Note: the checksum is calculated BEFORE this <br>
decryption.  <br>
<br>
The 'Encrypt' field in the HPIChunk header is set to 1 to indicate<br>
that this decryption needs to be done.<br>
<br>
To decrypt, do this (more pseudocode):<br>
<br>
for x = 0 to CompressedSize-1<br>
  data[x] = (data[x] - x) XOR x<br>
next x<br>
<br>
This gives us:<br>
<br>
00002870                          20 5B 4D 45 4E 55 30 00            [MENU0.<br>
00002880  54 52 80 59 31 5D 0D 0A 09 7B D1 00 10 55 4E 49   TR.Y1]...{...UNI<br>
00002890  54 22 00 3D 41 52 60 4D 41 43 4B 3B 11 01 83 01   T".=AR`MACK;....<br>
000028A0  33 81 32 02 42 55 54 54 4F 4E B4 02 19 42 01 4E   3.2.BUTTON...B.N<br>
000028B0  41 70 02 C2 01 46 4C 41 DD 23 02 7D E0 04 20 05   Ap...FLA.#.}.. .<br>
000028C0  18 00 32 CF 00 D3 01 DE 56 3F 02 4F 03 5F 04 68   ..2.....V?.O._.h<br>
000028D0  05 33 1F 06 D3 01 3E 41 8F 07 9F 08 AF 09 80 0D   .3....&gt;A........<br>
000028E0  00 00 4C                                          ..L<br>
     <br>
Woohoo!  Look!  Readable word fragments!  But remember, the chunk is still<br>
compressed.<br>
<br>
In this case, the block is compressed with LZ77, since CompMethod is 1.<br>
<br>
The compression algorithm is a very basic sliding window compression scheme<br>
from the LZ77 family using a 4095 byte history and matches from 2 to 17<br>
bytes long.<br>
<br>
The first byte is kind of a "tag" byte which determines if the next eight<br>
pieces of data are literal bytes or history matches.  Starting with the<br>
least-significant bit, this tag byte is scanned to figure out what to do.<br>
<br>
When the current bit is a zero, the next byte of the input is transfered<br>
directly to the output and added to end of the history buffer.<br>
<br>
When the current bit is a one, the next two bytes taken from the input are<br>
used as a offset/length pair.  The upper 12 bits are the offset into the<br>
history buffer and the lower 4 bits are the length.  If the offset is<br>
zero, the end of the input data has been reached and the decompressor<br>
simply exits.<br>
<br>
Since we can assume that there will be no matches with a length of zero<br>
or only one byte, any match is a mimimum of two bytes so we just add two<br>
to the length which extends our range from 0-15 to 2-17 bytes.<br>
<br>
The match is then copied from the history buffer to the output and also added<br>
onto the end of the history buffer to keep it in sync with the output.<br>
<br>
When all eight bits of the tag byte have been used, the mask is reset and<br>
the next tag byte is loaded.<br>
<br>
Here is some decompress code:<br>
<br>
<br>
int Decompress(char *out, char *in, int len)<br>
{<br>
/*<br>
 Decompress buffer "in" of size "len" into buffer "out" (previously <br>
 allocated) returns the number of decompressed bytes.<br>
*/<br>
<br>
  int x;<br>
  int outbufptr;<br>
  int mask;<br>
  int tag;<br>
  int inptr;<br>
  int outptr;<br>
  int count;<br>
  int done;<br>
  char Window[4096];<br>
  int inbufptr;<br>
<br>
  for (x = 0; x &lt; len; x++) {<br>
    in[x] = (in[x] - x) ^ x;<br>
  }<br>
<br>
  done = FALSE;<br>
<br>
  inptr = 0;<br>
  outptr = 0;<br>
  outbufptr = 1;<br>
  mask = 1;<br>
  tag = in[inptr++];<br>
	<br>
  while (!done) {<br>
    if ((mask &amp; tag) == 0) {<br>
      out[outptr++] = in[inptr];<br>
      Window[outbufptr] = in[inptr];<br>
      outbufptr = (outbufptr + 1) &amp; 0xFFF;<br>
      inptr++;<br>
    }<br>
    else {<br>
      count = *((unsigned short *) (in+inptr));<br>
      inptr += 2;<br>
      inbufptr = count &gt;&gt; 4;<br>
      if (inbufptr == 0)<br>
        return outptr;<br>
      else {<br>
        count = (count &amp; 0x0f) + 2;<br>
        if (count &gt;= 0) {<br>
          for (x = 0; x &lt; count; x++) {<br>
            out[outptr++] = Window[inbufptr];<br>
            Window[outbufptr] = Window[inbufptr];<br>
            inbufptr = (inbufptr + 1) &amp; 0xFFF;<br>
            outbufptr = (outbufptr + 1) &amp; 0xFFF;<br>
          }<br>
        }<br>
      }<br>
    }<br>
    mask *= 2;<br>
    if (mask &amp; 0x0100) {<br>
      mask = 1;<br>
      tag = in[inptr++];<br>
    }<br>
  }<br>
  return outptr;<br>
}<br>
<br>
When fed the data, the routine spits out:<br>
<br>
00000000  5B 4D 45 4E 55 45 4E 54 52 59 31 5D 0D 0A 09 7B   [MENUENTRY1]...{<br>
00000010  0D 0A 09 55 4E 49 54 4D 45 4E 55 3D 41 52 4D 41   ...UNITMENU=ARMA<br>
00000020  43 4B 3B 0D 0A 09 4D 45 4E 55 3D 33 3B 0D 0A 09   CK;...MENU=3;...<br>
00000030  42 55 54 54 4F 4E 3D 33 3B 0D 0A 09 55 4E 49 54   BUTTON=3;...UNIT<br>
00000040  4E 41 4D 45 3D 41 52 4D 46 4C 41 4B 3B 0D 0A 09   NAME=ARMFLAK;...<br>
00000050  7D 0D 0A 0D 0A 5B 4D 45 4E 55 45 4E 54 52 59 32   }....[MENUENTRY2<br>
00000060  5D 0D 0A 09 7B 0D 0A 09 55 4E 49 54 4D 45 4E 55   ]...{...UNITMENU<br>
00000070  3D 41 52 4D 41 43 56 3B 0D 0A 09 4D 45 4E 55 3D   =ARMACV;...MENU=<br>
00000080  33 3B 0D 0A 09 42 55 54 54 4F 4E 3D 33 3B 0D 0A   3;...BUTTON=3;..<br>
00000090  09 55 4E 49 54 4E 41 4D 45 3D 41 52 4D 46 4C 41   .UNITNAME=ARMFLA<br>
000000A0  4B 3B 0D 0A 09 7D 0D 0A 0D 0A 5B 4D 45 4E 55 45   K;...}....[MENUE<br>
000000B0  4E 54 52 59 33 5D 0D 0A 09 7B 0D 0A 09 55 4E 49   NTRY3]...{...UNI<br>
000000C0  54 4D 45 4E 55 3D 41 52 4D 41 43 41 3B 0D 0A 09   TMENU=ARMACA;...<br>
000000D0  4D 45 4E 55 3D 33 3B 0D 0A 09 42 55 54 54 4F 4E   MENU=3;...BUTTON<br>
000000E0  3D 33 3B 0D 0A 09 55 4E 49 54 4E 41 4D 45 3D 41   =3;...UNITNAME=A<br>
000000F0  52 4D 46 4C 41 4B 3B 0D 0A 09 7D 0D 0A 0D 0A 0D   RMFLAK;...}..... <br>
00000100  0A                                                .               <br>
<br>
Yay!  Clear decoded text.  Write this chunk out, and go get the next one.<br>
When there are no more chunks, close the file, and go process the next one.<br>
<br>
To recompress, do something like the following:<br>
<br>
       WHILE look ahead buffer is not empty<br>
             find a match in the window to previously output data<br>
             IF match length &gt; minimum match length<br>
                     output reference pair<br>
                     move the window match length to the right<br>
             ELSE<br>
                     output window first data item<br>
                     move the window one to the right<br>
             ENDIF<br>
       END<br>
<br>
If CompMethod is 2, use ZLib compression to decompress the block.  You can get the zlib<br>
source code from the zlib home page at <a href="http://www.cdrom.com/pub/infozip/zlib/" class="postlink">http://www.cdrom.com/pub/infozip/zlib/</a> <br>
<br>
From here, you've got enough data to proceed on your own.  Good luck!<br>
<br>
Like I said, if you have any questions, let me know.</div>

			
			
									
						<div id='list_thanks8668'>
</div>
<div id='div_post_reput8668'>
</div>

							<div id="sig8668" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8669" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile8669">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8669" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8669">

					<h3 >
						<a href="./viewtopic.php?p=8669#p8669"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8669/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8669" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8669' href="./viewtopic.php?f=10&amp;p=8669&amp;thanks=8669&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8669#p8669" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-26T00:12:07+00:00">Thu May 26, 2005 1:12 am</time>
			</p>
			
			
			
			<div class="content">Heretic 2 image M8 file format<br>
<br>
BYTES     NAME           DESCRIPTION<br>
==============================================<br>
4         Version        version 2 is Heretic2<br>
32        File Name byte string of directory and file name<br>
4[16]     Width          width of images<br>
4[16]     Height         height of images<br>
4[16]     Offset         file image offsets for image data<br>
32        Animation Name name of next frame in animation chain<br>
768       Palette        bpp RGB (palette format is the same as pcx ver 5)<br>
4         Flags          texture flags<br>
4         Contents       I don't know :O<br>
4         Value          I don't know <img class="smilies" src="./images/smilies/%5Bcolon%5Dp.gif" width="15" height="15" alt=":P" title="Razz"><br>
==============================================<br>
Image data starts at offset 1040<br>
<br>
I'm not sure but I think it may be possible to create animated skins for<br>
Heretic2 skins. Just make the "Animation Name" equal the next skins name.<br>
At the end of the animation just make the "Animation Name" equal the<br>
first skin name of the animation. Then again maybe not. I know that<br>
Quake textures are treated like that. Just a thought. <img class="smilies" src="./images/smilies/%5Bcolon%5D%29.gif" width="15" height="15" alt=":)" title="Smile"></div>

			
			
									
						<div id='list_thanks8669'>
</div>
<div id='div_post_reput8669'>
</div>

							<div id="sig8669" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p8670" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile8670">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a>							</dt>

						<dd class="profile-rank">VVIP member<br /><img src="./images/ranks/vip-3.png" alt="VVIP member" title="VVIP member" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=465&amp;sr=posts">444</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Tue Apr 12, 2005 11:36 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="465"></dd>
    <dd class="profile-posts" data-user-receive-id="465"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/465/false">4 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact KorNet">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact KorNet</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=8670" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content8670">

					<h3 >
						<a href="./viewtopic.php?p=8670#p8670"></a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/8670/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=8670" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post8670' href="./viewtopic.php?f=10&amp;p=8670&amp;thanks=8670&amp;to_id=465&amp;from_id=123876" title="Say Thanks to the author of the post: KorNet"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=8670#p8670" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="./memberlist.php?mode=viewprofile&u=465.html" class="username">KorNet</a></strong> &raquo; </span><time datetime="2005-05-26T00:15:03+00:00">Thu May 26, 2005 1:15 am</time>
			</p>
			
			
			
			<div class="content">Carmageddon 2: Carpocalyse Now TWT file format<br>
<br>
NOTE: All values are in hexadecimal (0 to F).<br>
<br>
Main header<br>
-----------<br>
<br>
Offset	Type		Description<br>
---------------------------------------------------------------<br>
   0    DWORD		Size of the entire TWT file<br>
   4    DWORD		The number of files in this TWT file<br>
Now you get the file definition headers.<br>
<br>
File definition headers<br>
-----------------------<br>
The file definition headers are 38h bytes long. A + means<br>
from the beginning for the file header (this is not the<br>
absolute offset)<br>
<br>
Offset	Type		Description<br>
--------------------------------------------------------------<br>
  +0	DWORD		This is the size of the file<br>
  +4	34h x Char	This is the filename. Unused characters<br>
			have a value of CDh<br>
Now you get data of the files.<br>
<br>
NOTE: altought the sizes of the files (TWT and the files inside)<br>
are defined in the TWT file, Carmageddon sometimes doesn't allow<br>
the file to have a diffirent size (this is case with the <br>
"data.twt" file)</div>

			
			
									
						<div id='list_thanks8670'>
</div>
<div id='div_post_reput8670'>
</div>

							<div id="sig8670" class="signature"><a href="http://wiki.xentax.com" class="postlink">Game Extraction Central</a><br>
<a href="http://watto.org/extract" class="postlink">Game Extractor  Version 1.5507</a><br>
<a href="http://www.xentax.com/downloads/multiex/mcsetup_xp98.exe" class="postlink">MultiEx Commander Full Version v4.3.0</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=1280" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=10&amp;t=1280&amp;watch=topic&amp;start=0&amp;hash=a0e387e5" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=10&amp;t=1280&amp;unwatch=topic&amp;start=0&amp;hash=a0e387e5" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=1280&amp;bookmark=1&amp;hash=a0e387e5" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=1280" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=1280&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=1280">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			21 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./viewtopic.php?t=1280&amp;start=15" role="button">2</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./viewtopic.php?t=1280&amp;start=15" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=10" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to “Game Archive”</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <span style="color: #9E8DA7;" class="username-coloured">Bing [Bot]</span>, <a href="./memberlist.php?mode=viewprofile&u=123876.html" class="username">escape209</a> and 2 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="./index.php" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
