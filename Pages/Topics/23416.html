<!DOCTYPE html>
<html dir="ltr" lang="en-gb">
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1" />

<title>Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header - XeNTaX</title>


	<link rel="canonical" href="https://forum.xentax.com/viewtopic.php?t=23416">

<!--
	phpBB style name: prosilver
	Based on style:   prosilver (this is the default phpBB3 style)
	Original author:  Tom Beddard ( http://www.subBlue.com/ )
	Modified by:
-->

<link href="../../Source/assets/css/font-awesome.min.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/stylesheet.css?assets_version=11" rel="stylesheet">
<link href="../../Source/styles/prosilver/theme/en/stylesheet.css?assets_version=11" rel="stylesheet">




<!--[if lte IE 9]>
	<link href="../../Source/styles/prosilver/theme/tweaks.css?assets_version=11" rel="stylesheet">
<![endif]-->


<link href="../../Source/ext/gfksx/thanksforposts/styles/prosilver/theme/thanks.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/hifikabin/headerbanner/styles/prosilver/theme/headerbanner_background.css?assets_version=11" rel="stylesheet" media="screen" />
<link href="../../Source/ext/phpbb/boardannouncements/styles/all/theme/boardannouncements.css?assets_version=11" rel="stylesheet" media="screen" />



</head>
<body id="phpbb" class="nojs notouch section-viewtopic ltr ">


<div id="wrap" class="wrap">
	<a id="top" class="top-anchor" accesskey="t"></a>
	<div id="page-header">
		<div class="headerbar" role="banner">
					<div class="inner">

			<div id="site-description" class="site-description">
		<a id="logo" class="logo" href="../Navigation/index.html" title="Board index">
					<span class="site_logo"></span>
				</a>
				<h1>XeNTaX</h1>
				<p>Game Research Forum</p>
				<p class="skiplink"><a href="#start_here">Skip to content</a></p>
			</div>

									<div class="banner-header">
	<div style="position:absolute; z-index:-100;">
	<h1>XeNTaX</h1>
	<p>Game Research Forum</p>
	<p class="skiplink"><a href="#start_here">Skip to content</a></p>
</div>
<div class="header-banner">
	<a href="../Navigation/index.html" title="Board index"><img class="header-banner" style="border-radius:0px; width:1500px;" src="../Source/images/gameresforum_logo_1.png" alt="Board index" ></a>
</div>
</div>

			</div>
					</div>
				<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-main" class="nav-main linklist" role="menubar">

		<li id="quick-links" class="quick-links dropdown-container responsive-menu" data-skip-responsive="true">
			<a href="#" class="dropdown-trigger">
				<i class="icon fa-bars fa-fw" aria-hidden="true"></i><span>Quick links</span>
			</a>
			<div class="dropdown">
				<div class="pointer"><div class="pointer-inner"></div></div>
				<ul class="dropdown-contents" role="menu">
					
											<li class="separator"></li>
													<li>
								<a href="./search.php?search_id=egosearch" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Your posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=newposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>New posts</span>
								</a>
							</li>
																			<li>
								<a href="./search.php?search_id=unreadposts" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-red" aria-hidden="true"></i><span>Unread posts</span>
								</a>
							</li>
													<li>
								<a href="./search.php?search_id=unanswered" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-gray" aria-hidden="true"></i><span>Unanswered topics</span>
								</a>
							</li>
							<li>
								<a href="./search.php?search_id=active_topics" role="menuitem">
									<i class="icon fa-file-o fa-fw icon-blue" aria-hidden="true"></i><span>Active topics</span>
								</a>
							</li>
							<li class="separator"></li>
							<li>
								<a href="./search.php" role="menuitem">
									<i class="icon fa-search fa-fw" aria-hidden="true"></i><span>Search</span>
								</a>
							</li>
					
											<li class="separator"></li>
													<li>
								<a href="./memberlist.php" role="menuitem">
									<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
								</a>
							</li>
																			<li>
								<a href="./memberlist.php?mode=team" role="menuitem">
									<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
								</a>
							</li>
																<li class="separator"></li>

						<li>
		<a href="/app.php/toplist"  role="menuitem">
			<i class="icon fa-star-o fa-fw" aria-hidden="true"></i><span>Posts toplist</span>
		</a>
	</li>
	<li>
		<a href="/app.php/thankslist"  role="menuitem">
			<i class="icon fa-thumbs-o-up fa-fw" aria-hidden="true"></i><span>Thanks list</span>
		</a>
	</li>
				</ul>
			</div>
		</li>

				<li data-last-responsive="true">
			<a href="/app.php/help/faq" rel="help" title="Frequently Asked Questions" role="menuitem">
				<i class="icon fa-question-circle fa-fw" aria-hidden="true"></i><span>FAQ</span>
			</a>
		</li>
						
					<li id="username_logged_in" class="rightside " data-skip-responsive="true">
						<div class="header-profile dropdown-container">
				<a href="./ucp.php" class="header-avatar dropdown-trigger"> <span class="username">escape209</span></a>
				<div class="dropdown">
					<div class="pointer"><div class="pointer-inner"></div></div>
					<ul class="dropdown-contents" role="menu">
						
					
						<li>
							<a href="./ucp.php" title="User Control Panel" role="menuitem">
								<i class="icon fa-sliders fa-fw" aria-hidden="true"></i><span>User Control Panel</span>
							</a>
						</li>
													<li>
								<a href="../Users/123876.html" title="Profile" role="menuitem">
									<i class="icon fa-user fa-fw" aria-hidden="true"></i><span>Profile</span>
								</a>
							</li>
						
						
						<li class="separator"></li>
						<li>
							<a href="./ucp.php?mode=logout&amp;sid=959ea14a0771cc2de19d1bba114b7679" title="Logout" accesskey="x" role="menuitem">
								<i class="icon fa-power-off fa-fw" aria-hidden="true"></i><span>Logout</span>
							</a>
						</li>
					</ul>
				</div>
			</div>
					</li>
					<li class="rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=pm&amp;folder=inbox" role="menuitem">
					<i class="icon fa-inbox fa-fw" aria-hidden="true"></i><span>Private messages </span><strong class="badge hidden">0</strong>
				</a>
			</li>
							<li class="dropdown-container dropdown-right rightside" data-skip-responsive="true">
				<a href="./ucp.php?i=ucp_notifications" id="notification_list_button" class="dropdown-trigger">
					<i class="icon fa-bell fa-fw" aria-hidden="true"></i><span>Notifications </span><strong class="badge hidden">0</strong>
				</a>
				<div id="notification_list" class="dropdown dropdown-extended notification_list">
	<div class="pointer"><div class="pointer-inner"></div></div>
	<div class="dropdown-contents">
		<div class="header">
			Notifications
			<span class="header_settings">
				<a href="./ucp.php?i=ucp_notifications&amp;mode=notification_options">Settings</a>
							</span>
		</div>

		<ul>
							<li class="no_notifications">
					You have no notifications
				</li>
								</ul>

		<div class="footer">
			<a href="./ucp.php?i=ucp_notifications"><span>See All</span></a>
		</div>
	</div>
</div>
			</li>
						</ul>

	<ul id="nav-breadcrumbs" class="nav-breadcrumbs linklist navlinks" role="menubar">
				
		
		<li class="breadcrumbs" itemscope itemtype="https://schema.org/BreadcrumbList">

			
							<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope><a itemprop="item" href="../Navigation/index.html" accesskey="h" data-navbar-reference="index"><i class="icon fa-home fa-fw"></i><span itemprop="name">Board index</span></a><meta itemprop="position" content="1" /></span>

											
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="24"><a itemprop="item" href="./viewforum.php?f=24"><span itemprop="name">Game Modding</span></a><meta itemprop="position" content="2" /></span>
															
								<span class="crumb" itemtype="https://schema.org/ListItem" itemprop="itemListElement" itemscope data-forum-id="10"><a itemprop="item" href="./viewforum.php?f=10"><span itemprop="name">Game Archive</span></a><meta itemprop="position" content="3" /></span>
							
					</li>

		<li class="rightside responsive-search">
	<a href="./search.php" title="View the advanced search options" role="menuitem">
	<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
	</a>
</li>

			</ul>

	</div>
</div>
	</div>

	
	<a id="start_here" class="anchor"></a>
	<div id="page-body" class="page-body" role="main">
		
					<div id="phpbb_announcement" style="background-color:#d9efff">
				<div><strong class="text-strong"><span style="color:#00BF00"><span style="font-size:120%;line-height:116%">Important information: this site is currently <a href="https://forum.xentax.com/viewtopic.php?t=27281" class="postlink">scheduled to go offline indefinitely</a> by end of the year. </span></span></strong></div>
	</div>

<h2 class="topic-title"><a href="./23416.html">Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a></h2>
<!-- NOTE: remove the style="display: none" when you want to have the forum description on the topic body -->
<div style="display: none !important;">The Original Forum. Game archives, full of resources. How to open them? Get help here.<br /></div>

	<div class="rules rules-link">
		<div class="inner">

					<a href="http://forum.xentax.com/viewtopic.php?f=28&amp;t=1270">Forum rules</a>
		
		</div>
	</div>

<div class="action-bar bar-top">
	
			<a href="./posting.php?mode=reply&amp;t=23416" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
	
			<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=10&amp;t=23416&amp;watch=topic&amp;start=0&amp;hash=abaa381c" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=10&amp;t=23416&amp;unwatch=topic&amp;start=0&amp;hash=abaa381c" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=23416&amp;bookmark=1&amp;hash=abaa381c" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=23416" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=23416&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>
	
			<div class="search-box" role="search">
			<form method="get" id="topic-search" action="./search.php">
			<fieldset>
				<input class="inputbox search tiny"  type="search" name="keywords" id="search_keywords" size="20" placeholder="Search this topicâ€¦" />
				<button class="button button-search" type="submit" title="Search">
					<i class="icon fa-search fa-fw" aria-hidden="true"></i><span class="sr-only">Search</span>
				</button>
				<a href="./search.php" class="button button-search-end" title="Advanced search">
					<i class="icon fa-cog fa-fw" aria-hidden="true"></i><span class="sr-only">Advanced search</span>
				</a>
				<input type="hidden" name="t" value="23416" />
<input type="hidden" name="sf" value="msgonly" />

			</fieldset>
			</form>
		</div>
	
			<div class="pagination">
			32 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./23416 (1).html" role="button">2</a></li>
				<li><a class="button" href="./23416 (2).html" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./23416 (1).html" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
		</div>




			<div id="p171202" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171202">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171202" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171202">

					<h3 class="first">
						<a href="./viewtopic.php?p=171202#p171202">Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171202/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171202" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171202' href="./viewtopic.php?f=10&amp;p=171202&amp;thanks=171202&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171202#p171202" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-08T09:39:53+00:00">Mon Feb 08, 2021 10:39 am</time>
			</p>
			
			
			
			<div class="content">I posted a similar inquiry elsewhere some time last month but was not provided any solutions. I noticed this forum had a lot of similar questions regarding accessing encrypted .unity3d files and was wondering if help could be provided on this. I already had a look at the <a href="https://forum.xentax.com/viewtopic.php?f=29&amp;t=23228" class="postlink">Decrypt unity 3d files with Frida</a> tutorial, but this does not seem to be applicable to my situation due to not having a libil2cpp.so file et al.. I can provide additional information as required.<br>
<br>
---<br>
<br>
Application: <a href="https://play.google.com/store/apps/details?id=com.nexon.kart" class="postlink">KartRider Rush+</a><br>
<br>
Prior to a recent update for the game, the package files could be accessed and extracted through usual extraction tools. However, it seems like the developers have changed how the files are encoded, and now instead of all the files having a UnityFS header, they instead have an FBAU header. Attempting to access these files now simply results in no data returned.<br>
<br>
I am wondering if there are any other means to accessing the files' contents, or if this is considered custom encryption and will thus not be supported. Thank you.<br>
<br>
I have included some example files via Google Drive Links, which includes two .unity3d files pre and post update, along with a hex image example:<br>
<br>
<strong class="text-strong">Pre-Update (Works with standard tools)</strong><br>
<a href="https://drive.google.com/drive/folders/1L7dUOQrs--hf7dqi_rH3dO2mpdsO0GNq" class="postlink">Example of two .unity3d files from pre-update</a><br>
<br>
<strong class="text-strong">Post-Update (Does not work with standard tools/encrypted)</strong><br>
<a href="https://drive.google.com/drive/folders/1ygFtjj9aIaLmrKnh4yO3il0WFHuDaE61" class="postlink">Example of two .unity3d files from post-update</a></div>

			
			
									
						<div id='list_thanks171202'>
</div>
<div id='div_post_reput171202'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171207" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171207">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171207" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171207">

					<h3 >
						<a href="./viewtopic.php?p=171207#p171207">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171207/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171207" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171207' href="./viewtopic.php?f=10&amp;p=171207&amp;thanks=171207&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171207#p171207" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-08T11:06:08+00:00">Mon Feb 08, 2021 12:06 pm</time>
			</p>
			
			
			
			<div class="content">The game has that file<br>
<img src="https://i.snipboard.io/f2vox3.jpg" class="postimage" alt="Image"><br>
<br>
It looks like the first 0x1C0 bytes are encrypted.<br>
most likely xor</div>

			
			
									
						<div id='list_thanks171207'>
</div>
<div id='div_post_reput171207'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171236" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171236">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171236" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171236">

					<h3 >
						<a href="./viewtopic.php?p=171236#p171236">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171236/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171236" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171236' href="./viewtopic.php?f=10&amp;p=171236&amp;thanks=171236&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171236#p171236" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-08T22:25:30+00:00">Mon Feb 08, 2021 11:25 pm</time>
			</p>
			
			
			
			<div class="content">Thank you for the very prompt response and tips. I was looking at the wrong folders so I missed the libil2cpp.so.<br>
<br>
Just to put in some of my progress while I continue to try and figure this out:
<ul>
<li>Continuing with your tutorial, I set up everything as requested prior to Step 1. Using <a href="https://ghidra-sre.org/" class="postlink">Ghidra</a> in this scenario since IDA Pro requires payment and the free version does not seem to support this use case.
<ul>
<li> Attempting to run Analysis on <em class="text-italics">libil2cpp.so</em> in Ghidra seemed to be stuck at 0% progress even after 3 hours, so I just halted it. Not sure if it's supposed to work after a longer period of time.</li>
<li> Feeding the base <em class="text-italics">libil2cpp.so</em> and <em class="text-italics">global-metadata.dat</em> files into <a href="https://github.com/Perfare/Il2CppDumper" class="postlink">Il2CppDumper</a> results in the common error "ERROR: This file may be protected."</li>
</ul></li>
<li> Based on the repository's README, I downloaded GameGuardian on my rooted device, dumped the appropriate files, retrieved the correct .bin file based on what the com.nexon.kart-maps file listed, edited it so it only contained the <em class="text-italics">libil2cpp.so</em> data, then fed <strong class="text-strong">that</strong> file into Il2CppDumper instead, which successfully generated the <em class="text-italics">scripts.json</em> file among others.
<ul><li>The <em class="text-italics">scripts.json</em> file contained 0 instances of LoadAssetBundleSync, and 4 instances of LoadAssetBundle (1 which seems like the actual function:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>    {
      "Address": 47298720,
      "Name": "ABLoadReq$$LoadAssetBundle",
      "Signature": "UnityEngine_AssetBundle_o* ABLoadReq__LoadAssetBundle (ABLoadReq_o* __this, System_String_o* abPath, const MethodInfo* method);"
    },
</code></pre></div>
).</li></ul></li>
<li> I ran the <em class="text-italics">ghidra.py</em> script in Ghidra, which took around 10 minutes.</li>
<li> This is the result for the LoadAssetBundle function:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined4 ABLoadReq$$LoadAssetBundle(int param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  undefined4 uVar3;
  
  if (cRam084e9e5e == '\0') {
    thunk_FUN_0099be88(0x42);
    cRam084e9e5e = '\x01';
  }
  iVar1 = *(int *)(*(int *)(ABLoadReq_TypeInfo + 0x58) + 0x18);
  if (iVar1 != 0) {
    uVar2 = XLua.DelegateBridge$$__Gen_Delegate_Imp852(iVar1,param_1,param_2,0);
    return uVar2;
  }
  uVar2 = 0;
  iVar1 = System.String$$IsNullOrEmpty(param_2,0);
  if (iVar1 == 0) {
    iVar1 = ABLoadReq$$IsEncrypted(param_1,*(undefined4 *)(param_1 + 0x14));
    if (iVar1 == 0) {
      uVar2 = UnityEngine.AssetBundle$$LoadFromFile(param_2,0);
    }
    else {
      uVar2 = ABLoadReq$$LoadEncryptedAB(param_1,param_2);
    }
    if (((*(byte *)(UnityEngine.Object_TypeInfo + 0xb7) &amp; 2) != 0) &amp;&amp;
       (*(int *)(UnityEngine.Object_TypeInfo + 0x6c) == 0)) {
                    /* WARNING: Subroutine does not return */
      thunk_FUN_009afb28();
    }
    iVar1 = UnityEngine.Object$$op_Equality(uVar2,0,0);
    if (iVar1 == 1) {
      if (((*(byte *)(SimpleStringBuilder_TypeInfo + 0xb7) &amp; 2) != 0) &amp;&amp;
         (*(int *)(SimpleStringBuilder_TypeInfo + 0x6c) == 0)) {
                    /* WARNING: Subroutine does not return */
        thunk_FUN_009afb28();
      }
      uVar3 = SimpleStringBuilder$$Concat(_StringLiteral_10568,param_2,0);
      GameSystemBase$$Log(5,uVar3,0);
    }
  }
  return uVar2;
}
</code></pre></div>
I notice a LoadEncryptedAB function which may be what is required? This is its contents:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>
void ABLoadReq$$LoadEncryptedAB(undefined4 param_1,undefined4 param_2)

{
  int iVar1;
  undefined4 uVar2;
  
  if (cRam084e9e60 == '\0') {
    thunk_FUN_0099be88(0x43);
    cRam084e9e60 = '\x01';
  }
  iVar1 = *(int *)(*(int *)(ABLoadReq_TypeInfo + 0x58) + 0x20);
  if (iVar1 != 0) {
    XLua.DelegateBridge$$__Gen_Delegate_Imp852(iVar1,param_1,param_2,0);
    return;
  }
  if (((*(byte *)(Utils_TypeInfo + 0xb7) &amp; 2) != 0) &amp;&amp; (*(int *)(Utils_TypeInfo + 0x6c) == 0)) {
                    /* WARNING: Subroutine does not return */
    thunk_FUN_009afb28();
  }
  uVar2 = Utils$$ReadAllBytes(param_2,0);
  uVar2 = Utils$$TeaDecrypt(uVar2,0);
                    /* WARNING: Treating indirect jump as call */
  UnityEngine.AssetBundle$$LoadFromMemory(uVar2,0);
  return;
}
</code></pre></div></li>
<li> Similar logic expects me to look at the TeaDecrypt function:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>void Utils$$TeaDecrypt(undefined4 param_1)

{
  undefined4 uVar1;
  int iVar2;
  int iVar3;
  
  if (DAT_084e64aa == '\0') {
    FUN_0099be88(0xc0c2d6b6);
    DAT_084e64aa = '\x01';
  }
  if (((*(byte *)(Utils_TypeInfo + 0xb7) &amp; 2) != 0) &amp;&amp; (*(int *)(Utils_TypeInfo + 0x6c) == 0)) {
                    /* WARNING: Subroutine does not return */
    FUN_009afb28();
  }
  iVar2 = Utils_TypeInfo;
  if (*(int *)(*(int *)(Utils_TypeInfo + 0x58) + 0x1c) == 0) {
    uVar1 = FUN_009d8f5c(TxTEA_TypeInfo);
    TxTEA$$.ctor(uVar1,0);
    iVar2 = Utils_TypeInfo;
    if (((*(byte *)(Utils_TypeInfo + 0xb7) &amp; 2) != 0) &amp;&amp; (*(int *)(Utils_TypeInfo + 0x6c) == 0)){
                    /* WARNING: Subroutine does not return */
      FUN_009afb28();
    }
    *(undefined4 *)(*(int *)(Utils_TypeInfo + 0x58) + 0x1c) = uVar1;
  }
  if (((*(byte *)(iVar2 + 0xb7) &amp; 2) != 0) &amp;&amp; (*(int *)(iVar2 + 0x6c) == 0)) {
                    /* WARNING: Subroutine does not return */
    FUN_009afb28();
  }
  iVar3 = *(int *)(*(int *)(iVar2 + 0x58) + 0x1c);
  if (iVar3 == 0) {
                    /* WARNING: Subroutine does not return */
    FUN_009c8e34(0);
  }
  TxTEA$$decrypt(iVar3,param_1,*(undefined4 *)(*(int *)(iVar2 + 0x58) + 0x20),0);
  return;
}
</code></pre></div></li>
<li> And an image of what the software looks like at this point in time: <a href="https://prnt.sc/yrhnav" class="postlink">https://prnt.sc/yrhnav</a></li>
</ul>

Assuming your xor encryption hypothesis is correct, I presume I still need to go through this process in order to find out what the files are xor'd with. Will continue trying to work on this, but will also greatly appreciate any additional assistance if applicable. Thanks!</div>

			
			
									
						<div id='list_thanks171236'>
</div>
<div id='div_post_reput171236'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171241" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171241">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171241" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171241">

					<h3 >
						<a href="./viewtopic.php?p=171241#p171241">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171241/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171241" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171241' href="./viewtopic.php?f=10&amp;p=171241&amp;thanks=171241&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171241#p171241" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-09T01:13:59+00:00">Tue Feb 09, 2021 2:13 am</time>
			</p>
			
			
			
			<div class="content">Good job so far.<br>
yeah you can notice<br>
UnityEngine.AssetBundle$$<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>LoadFromMemory</code></pre></div>
in your code that I mentioned in the tutorial.<br>
looks like from the code you have hear its using tea or xtea encryption.<br>
So you can hook that function and log the key then use normal programs to decrypt your files.<br>
you can also hook the result of the load asset bundle function to dump a decrypted file for reference.<br>
<br>
<a href="https://www.codeproject.com/Articles/31602/TEA-Encryption-Decryption-Made-Simple" class="postlink">https://www.codeproject.com/Articles/31 ... ade-Simple</a><br>
<br>
you can compare code in <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>TxTEA$$decrypt</code></pre></div>
to see what it is doing.</div>

			
			
									
						<div id='list_thanks171241'>
</div>
<div id='div_post_reput171241'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171249" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171249">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171249" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171249">

					<h3 >
						<a href="./viewtopic.php?p=171249#p171249">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171249/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171249" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171249' href="./viewtopic.php?f=10&amp;p=171249&amp;thanks=171249&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171249#p171249" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-09T05:39:29+00:00">Tue Feb 09, 2021 6:39 am</time>
			</p>
			
			
			
			<div class="content">Reviewing some of the relevant functions and their corresponding addresses:<br>

<ul>
<li> undefined4 ABLoadReq$$LoadAssetBundle(int param_1,undefined4 param_2) - 02d2b8a0</li>
<li> void ABLoadReq$$LoadEncryptedAB(undefined4 param_1,undefined4 param_2) - 02d2bcc4</li>
<li> void Utils$$TeaDecrypt(undefined4 param_1) - 025baae0</li>
<li> UnityEngine.AssetBundle$$LoadFromMemory(uVar2,0) - 068ba44c</li>
</ul>

Cannot actually check the pseudo-code for the LoadFromMemory function in Ghidra but I assume this is normal.<br>
<br>
Going into Step 3 of the tutorial, I followed everything to the last step but ran into an error:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>./frida-server
/system/bin/sh: ./frida-server: can't execute: Is a directory</code></pre></div>

I looked around a bit but it doesn't seem like there was a proper solution to this, so I ended up installing the <a href="https://play.google.com/store/apps/details?id=me.shingle.fridaserver" class="postlink">Frida Server</a> app on the Play Store which seems to serve the same purpose.<br>
<br>
Step 4 worked as normal.<br>
<br>
Step 5 presents some issues on my end:
<ul>
<li> frida.exe -U -f com.nexon.kart</li>
<li> Replace the address in the <div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>var nativeFuncAddr = 0x00683014; //</code></pre></div> line with the TeaDecrypt address (0x025baae0)</li>
<li> %resume gets a hit for the <em class="text-italics">libil2cpp.so</em> file (the ret changes every time):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>. . .
dlopen called with: /system/lib/hw/gralloc.msm8974.so
dlopen called with: libc.so
dlopen called with: libc.so
dlopen called with: /data/app/com.nexon.kart-1/lib/arm/libil2cpp.so
ret: 0xb57f0344
dlopen called with: /vendor/lib/egl/eglsubAndroid.so
dlopen called with: /vendor/lib/egl/libGLESv2_adreno.so
dlopen called with: /vendor/lib/egl/libGLESv2S3D_adreno.so
. . .
</code></pre></div></li>
<li> However, no functions are being hooked. I have rerun the frida.exe line with 0x02d2b8a0 and 0x068ba44c for nativeFuncAddr as well, but there are still no functions being hooked; this is with letting the game run/load up to the login screen where it can't go any further. It seems like I cannot continue without getting the pointers. I also don't understand where the return address 0xaf698000 came from in the tutorial but one step at a time I suppose.</li>
</ul>

In the meantime, I tried to set up whatever I could ahead:
<ul>
<li> Searching for CreateString returns 33 functions; I just took the first result:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>
/* WARNING: Control flow encountered bad instruction data */
/* WARNING: Globals starting with '_' overlap smaller symbols at the same address */

undefined2 * System.String$$CreateString(undefined4 param_1,undefined2 param_2,int param_3)

{
  undefined2 *puVar1;
  int iVar2;
  undefined2 *puVar3;
  undefined4 uVar4;
  undefined2 *puVar5;
  
  if (cRam0845453f == '\0') {
    FUN_0099be88(0x1c101);
    cRam0845453f = '\x01';
  }
  if (param_3 &lt; 0) {
    uVar4 = FUN_009d8f5c(System.ArgumentOutOfRangeException_TypeInfo);
    System.ArgumentOutOfRangeException$$.ctor(uVar4,StringLiteral_469,0);
    FUN_009c8d88(uVar4,0,_Method$System.String.CreateString());
                    /* WARNING: Bad instruction - Truncating control flow here */
    halt_baddata();
  }
  if (param_3 == 0) {
    puVar1 = (undefined2 *)**(uint **)(string_TypeInfo + 0x58);
  }
  else {
    puVar1 = (undefined2 *)FUN_009e37e8(param_3);
    puVar3 = puVar1;
    if (puVar1 != (undefined2 *)0x0) {
      iVar2 = System.Runtime.CompilerServices.RuntimeHelpers$$get_OffsetToStringData(0);
      puVar3 = (undefined2 *)(iVar2 + (int)puVar1);
    }
    puVar5 = puVar3 + param_3;
    while (puVar3 &lt; puVar5) {
      *puVar3 = param_2;
      puVar3 = puVar3 + 1;
    }
  }
  return puVar1;
}
</code></pre></div></li>
<li> Trying to run the code that is meant to create a string (replacing com.tencent.hlfish with com.nexon.kart) results in an Error: access violation accessing 0x0. I assume this is because /storage/emulated/0/Android/data/com.nexon.kart/files/AssetBundles/ doesn't actually exist; these are the available directories in the files folder:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>ChatVoice
DecodedBanks
Ifs
Log
SyncRecords
Unity
il2cpp
</code></pre></div></li>
</ul></div>

			
			
									
						<div id='list_thanks171249'>
</div>
<div id='div_post_reput171249'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171259" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171259">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171259" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171259">

					<h3 >
						<a href="./viewtopic.php?p=171259#p171259">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171259/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171259" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171259' href="./viewtopic.php?f=10&amp;p=171259&amp;thanks=171259&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171259#p171259" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-09T11:38:44+00:00">Tue Feb 09, 2021 12:38 pm</time>
			</p>
			
			
			
			<div class="content">you need to use frida server as root.<br>
copy frida-server for arm64 to your device /data/local/tmp<br>
log into adb<br>
type su<br>
now your root<br>
change to /data/local/tmp<br>
chmod 777 ./frida-server<br>
./frida-server<br>
<br>
<a href="https://frida.re/docs/android/" class="postlink">https://frida.re/docs/android/</a></div>

			
			
									
						<div id='list_thanks171259'>
</div>
<div id='div_post_reput171259'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171272" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171272">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171272" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171272">

					<h3 >
						<a href="./viewtopic.php?p=171272#p171272">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171272/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171272" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171272' href="./viewtopic.php?f=10&amp;p=171272&amp;thanks=171272&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171272#p171272" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-09T17:29:49+00:00">Tue Feb 09, 2021 6:29 pm</time>
			</p>
			
			
			
			<div class="content">Alright, I had to change the steps around a little but I managed to do it without using the FridaServer app...sort of.<br>
<br>
Unless I am heavily misreading, my interpretation of Step 3 is as such:
<blockquote class="uncited"><div>
<ul>
<li> Install the APK onto your phone</li>
<li> Get the latest release of Frida server at <a href="https://github.com/frida/frida/releases" class="postlink">https://github.com/frida/frida/releases</a>
<ul>
<li> In this use case and time of writing, it will be for Android ARM 64, so <a href="https://github.com/frida/frida/releases/download/14.2.11/frida-server-14.2.11-android-arm64.xz" class="postlink">frida-server-14.2.11-android-arm64.xz</a></li>
</ul></li>
<li> Extract this with 7z and put the file into C:\ or wherever is accessible</li>
<li> Run the following:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>adb push c:\frida-server-14.2.11-android-arm64 /data/local/tmp/frida-server
adb shell
su
cd /data/local/tmp/frida-server
chmod 777 ./frida-server-14.2.11-android-arm64
./frida-server-14.2.11-android-arm64
</code></pre></div></li></ul>
</div></blockquote>

With that said however, that last step now gives me a "not executable: 64-bit ELF file" error. I assume this is due to the device I am using which is incompatible with that specific Frida server (Nexus 5, Android Version 6.0.1), so I downloaded <a href="https://github.com/frida/frida/releases/download/14.2.11/frida-server-14.2.11-android-arm.xz" class="postlink">frida-server-14.2.11-android-arm.xz</a> instead which works for my device. I do not know if that invalidates the rest of the tutorial, and if I'd need to switch to an emulator instead.<br>
<br>
Beyond that, I run into the same errors as I mentioned in my previous post concerning no function hooks or the lack of AssetBundles folder.</div>

			
			
									
						<div id='list_thanks171272'>
</div>
<div id='div_post_reput171272'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171279" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171279">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171279" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171279">

					<h3 >
						<a href="./viewtopic.php?p=171279#p171279">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171279/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171279" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171279' href="./viewtopic.php?f=10&amp;p=171279&amp;thanks=171279&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171279#p171279" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-09T22:46:55+00:00">Tue Feb 09, 2021 11:46 pm</time>
			</p>
			
			
			
			<div class="content">You can run the 32 bit frida server.<br>
the offset is most likely wrong from the way it was dumped would be my guess as to why your not hitting the function.<br>
or its not calling that function at all you can try a different function to hook.<br>
you can also try dumping with<br>
<a href="https://github.com/lasting-yang/frida_dump" class="postlink">https://github.com/lasting-yang/frida_dump</a><br>
<br>
you can test with the sample tutorial I did to make sure that hook is working on your device first.<br>
<br>
using adb shell you can create any directory you want also.</div>

			
			
									
						<div id='list_thanks171279'>
</div>
<div id='div_post_reput171279'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171286" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171286">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171286" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171286">

					<h3 >
						<a href="./viewtopic.php?p=171286#p171286">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171286/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171286" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171286' href="./viewtopic.php?f=10&amp;p=171286&amp;thanks=171286&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171286#p171286" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-10T07:35:53+00:00">Wed Feb 10, 2021 8:35 am</time>
			</p>
			
			
			
			<div class="content">As you suggested, it makes sense to try the tutorial's sample APK first.<br>
<br>
Since the link you provided in the tutorial no longer works, I am using the APK found at <a href="https://www.coolapk.com/game/com.tencent.hlfish" class="postlink">https://www.coolapk.com/game/com.tencent.hlfish</a> (è…¾è®¯æ¬¢ä¹æ•é±¼ Version 2.2.5).<br>
<br>
Speeding through to the end of Step 2, I look at the HLArcade.HLFileCryptNew$$DecryptFileNew function in Ghidra:<br>
<br>
<img src="https://i.imgur.com/akrfPCf.png" class="postimage" alt="Image"><br>
<br>
Okay...so besides the fact that I can't see the pseudo-code of HLArcade.HLFileCryptNew$$DecryptFileNew for some reason (can only see UResource.UFileCrypt$$DecryptFileNew), the address looks to be different from the tutorial as well, being at 00c1eb94 instead of 00683014. Might be because of APK version differences and the <em class="text-italics">libil2cpp.so</em> being different between your writing and mine.<br>
<br>
Going into Step 5, I tested the monitor code on com.tencent.hlfish with the following nativeFuncAddr:
<ul>
<li> 0x00683014 (from your tutorial)</li>
<li> 0x00c1eb94 (HLArcade.HLFileCryptNew$$DecryptFileNew function)</li>
<li> 0x0201c4b8 (UFileCrypt$$DecryptFileNew function)</li>
<li> 0x02026620 (UResource.UResourceManagerBase$$LoadAssetBundleSync function)</li>
<li> 0x00010000 (Random testing start of file)</li>
</ul>

All of those did not return a function hook...so somewhat on a whim, I decided to try 0x00C0EB94 (0x00c1eb94 - 0x00010000), and...<br>
<br>
<img src="https://i.imgur.com/6Gd4D2l.png" class="postimage" alt="Image"><br>
<br>
...Alright then...<br>
<br>
From this point, I will continue using com.tencent.hlfish instead of com.nexon.kart, and only return to my own APK once I fully complete your tutorial just to make sure we're on the same page.<br>
<br>
So as seen from the screenshot above, I have 0x8dcdc840 and 0x9cfe9b5c. Continuing with Step 5, I got results as such:
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[Nexus 5::com.tencent.hlfish]-&gt; Memory.readByteArray(new NativePointer(0x8dcdc840),0x100);
0000  0a 0e 13 04 11 04 05 0a 09 04 02 04 08 0a 05 03   ................
0010  03 07 06 03 05 07 0c 04 05 11 09 0c 0f 11 0d 0d   ................
0020  13 0e 0f 01 01 09 04 0b 03 08 06 0d 09 13 76 01   ..............v.
0030  18 09 07 11 06 08 03 06 03 0e 03 12 03 04 08 0e   ................
0040  07 02 12 0f 08 11 08 0c 09 09 0e 0c 0f 0b 0d 00   ................
0050  00 0b 03 0b 01 05 06 0d 0a 12 79 01 03 04 03 11   ..........y.....
0060  20 1a 00 37 08 01 01 08 01 02 0d 0c 03 01 03 06    ..7............
0070  0f 04 15 00 00 00 16 2a 00 0c 25 6f 0f 02 0e 00   .......*..%o....
0080  0d 03 0f 03 06 0d 01 00 00 0a 06 08 01 02 01 00   ................
0090  09 08 13 01 00 01 18 08 4c 02 03 0a 05 06 0e 05   ........L.......
00a0  00 07 00 04 ff e3 00 f8 00 d2 00 3c 00 55 00 70   ...........&lt;.U.p
00b0  00 74 00 78 00 7c 00 80 00 40 40 3d 36 38 76 38   .t.x.|...@@=68v8
00c0  7a 38 7e 38 32 78 2e 7c 2a 80 15 07 0f 09 0b 09   z8~82x.|*.......
00d0  5b 59 0b 33 35 77 35 2f 31 7b 75 2b 2d 7f 79 27   [Y.35w5/1{u+-.y'
00e0  29 1d 7d 10 14 08 14 0c 0e 73 0e 61 6e 3f 3d 3f   ).}......s.an?=?
00f0  41 43 54 0c 71 73 71 12 00 2b 17 26 27 36 37 36   ACT.qsq..+.&amp;'676
</code></pre></div>
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[Nexus 5::com.tencent.hlfish]-&gt; Memory.readByteArray(new NativePointer(0x9cfe9b5c),0x100);
0000  d5 ff ff ff 80 b5 0c 48 0c 49 0d 4a 78 44 79 44   .......H.I.JxDyD
0010  7a 44 57 f3 df f8 0b 49 00 28 79 44 08 60 0a d0   zDW....I.(yD.`..
0020  01 21 00 22 56 f3 0a f8 01 46 07 48 78 44 bd e8   .!."V....F.HxD..
0030  80 40 56 f3 41 bc 80 bd 25 ec d5 00 b0 c7 d5 00   .@V.A...%.......
0040  b2 f0 d5 00 ce f1 f2 00 c0 f1 f2 00 03 49 00 22   .............I."
0050  03 48 79 44 78 44 0a 60 56 f3 b2 bc 96 f1 f2 00   .HyDxD.`V.......
0060  98 f1 f2 00 80 b5 60 f3 8f f9 05 49 05 4a 06 4b   ......`....I.J.K
0070  79 44 7a 44 7b 44 bd e8 80 40 60 f3 30 b9 00 bf   yDzD{D...@`.0...
0080  f4 28 d6 00 8f ff ff ff d5 ff ff ff 80 b5 0c 48   .(.............H
0090  0c 49 0d 4a 78 44 79 44 7a 44 57 f3 9b f8 0b 49   .I.JxDyDzDW....I
00a0  00 28 79 44 08 60 0a d0 04 21 00 22 55 f3 c6 ff   .(yD.`...!."U...
00b0  01 46 07 48 78 44 bd e8 80 40 56 f3 fd bb 80 bd   .F.HxD...@V.....
00c0  9d eb d5 00 28 c7 d5 00 35 f0 d5 00 72 f1 f2 00   ....(...5...r...
00d0  64 f1 f2 00 03 49 00 22 03 48 79 44 78 44 0a 60   d....I.".HyDxD.`
00e0  56 f3 6e bc 3a f1 f2 00 3c f1 f2 00 80 b5 60 f3   V.n.:...&lt;.....`.
00f0  4b f9 05 49 05 4a 06 4b 79 44 7a 44 7b 44 bd e8   K..I.J.KyDzD{D..
</code></pre></div>

The above two blocks change every time I rerun the application so this doesn't seem right. I also notice the function hook returns "a2": "0x0" so I even though I hooked into a function, it might still be the wrong one. I'll continue messing around a little but that's currently where things stand.<br>
<br>
---<br>
<br>
As an aside, I did try the frida_dump repo you linked, but the first script returns a "TypeError: cannot read property 'getApplicationContext' of null at &lt;anonymous&gt; (/dump_so.js:4)" error and the second script returns a "Failed to spawn: the 'argv' option is not supported when spawning Android apps" error so I probably won't be able to make use of it anyways.</div>

			
			
									
						<div id='list_thanks171286'>
</div>
<div id='div_post_reput171286'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171292" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171292">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171292" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171292">

					<h3 >
						<a href="./viewtopic.php?p=171292#p171292">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171292/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171292" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171292' href="./viewtopic.php?f=10&amp;p=171292&amp;thanks=171292&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171292#p171292" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-10T10:49:24+00:00">Wed Feb 10, 2021 11:49 am</time>
			</p>
			
			
			
			<div class="content">You need to let it finish analyzing the program it takes several hours to do.<br>
Yo need to wait till it says idle on the bottom then run he scripts.<br>
It will run a 2nd time with the scripts.<br>
Then you can start looking at code.<br>
it has to say idle on the bottom between each step.</div>

			
			
									
						<div id='list_thanks171292'>
</div>
<div id='div_post_reput171292'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171315" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171315">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171315" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171315">

					<h3 >
						<a href="./viewtopic.php?p=171315#p171315">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171315/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171315" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171315' href="./viewtopic.php?f=10&amp;p=171315&amp;thanks=171315&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171315#p171315" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-11T06:09:17+00:00">Thu Feb 11, 2021 7:09 am</time>
			</p>
			
			
			
			<div class="content">I have been continuing to work with the com.tencent.hlfish example but haven't seen any signs of a UnityFS header.<br>
<br>
Hooking to the <em class="text-italics">int HLArcade.HLFileCryptNew$$DecryptFileNew(undefined4 param_1,int *param_2)</em> function, I get the following hits:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[-] hook invoked
{
        "a0": "0x8d6ac840",
        "a1": "0x9d12eb5c",
        "a2": "0x0",
}
Return Value: 0x87dd6000
</code></pre></div>

Looking at 0x8d6ac840 (a0):
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[Nexus 5::com.tencent.hlfish]-&gt; Memory.readByteArray(new NativePointer(0x8d6ac840),0x100);
0000  40 22 ff 98 00 00 00 00 55 00 00 00 2f 00 73 00   @"......U.../.s.
0010  74 00 6f 00 72 00 61 00 67 00 65 00 2f 00 65 00   t.o.r.a.g.e./.e.
0020  6d 00 75 00 6c 00 61 00 74 00 65 00 64 00 2f 00   m.u.l.a.t.e.d./.
0030  30 00 2f 00 41 00 6e 00 64 00 72 00 6f 00 69 00   0./.A.n.d.r.o.i.
0040  64 00 2f 00 64 00 61 00 74 00 61 00 2f 00 63 00   d./.d.a.t.a./.c.
0050  6f 00 6d 00 2e 00 74 00 65 00 6e 00 63 00 65 00   o.m...t.e.n.c.e.
0060  6e 00 74 00 2e 00 68 00 6c 00 66 00 69 00 73 00   n.t...h.l.f.i.s.
0070  68 00 2f 00 66 00 69 00 6c 00 65 00 73 00 2f 00   h./.f.i.l.e.s./.
0080  41 00 73 00 73 00 65 00 74 00 42 00 75 00 6e 00   A.s.s.e.t.B.u.n.
0090  64 00 6c 00 65 00 73 00 2f 00 46 00 69 00 73 00   d.l.e.s./.F.i.s.
00a0  68 00 69 00 6e 00 67 00 2f 00 6b 00 65 00 72 00   h.i.n.g./.k.e.r.
00b0  6e 00 65 00 6c 00 00 00 00 00 00 00 00 00 00 00   n.e.l...........
00c0  40 22 ff 98 00 00 00 00 57 00 00 00 53 00 79 00   @"......W...S.y.
00d0  73 00 74 00 65 00 6d 00 2e 00 43 00 6f 00 6e 00   s.t.e.m...C.o.n.
00e0  66 00 69 00 67 00 75 00 72 00 61 00 74 00 69 00   f.i.g.u.r.a.t.i.
00f0  6f 00 6e 00 2c 00 20 00 56 00 65 00 72 00 73 00   o.n.,. .V.e.r.s.
</code></pre></div>

Looking at 0x87dd6000 (the return address):<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[Nexus 5::com.tencent.hlfish]-&gt; Memory.readByteArray(new NativePointer(0x87dd6000),0x100);
0000  d8 74 cb 8f 00 00 00 00 00 00 00 00 97 17 00 00   .t..............
0010  00 00 d9 3e 00 20 38 3f 00 00 d9 3e 00 40 d9 3e   ...&gt;. 8?...&gt;.@.&gt;
0020  00 40 8a 3e 00 40 d9 3e 00 40 8a 3e 00 20 38 3f   .@.&gt;.@.&gt;.@.&gt;. 8?
0030  00 00 d9 3e 00 20 38 3f 00 00 d9 3e 00 40 d9 3e   ...&gt;. 8?...&gt;.@.&gt;
0040  00 40 8a 3e 00 40 d9 3e 00 40 8a 3e 00 20 38 3f   .@.&gt;.@.&gt;.@.&gt;. 8?
0050  00 c0 51 3f 00 c0 8c 3e 00 00 38 3f 00 c0 8c 3e   ..Q?...&gt;..8?...&gt;
0060  00 00 38 3f 00 00 bb 3e 00 c0 51 3f 00 00 bb 3e   ..8?...&gt;..Q?...&gt;
0070  00 c0 51 3f 00 c0 8c 3e 00 00 38 3f 00 c0 8c 3e   ..Q?...&gt;..8?...&gt;
0080  00 00 38 3f 00 00 bb 3e 00 c0 51 3f 00 00 bb 3e   ..8?...&gt;..Q?...&gt;
0090  00 00 0f 3f 00 80 18 3f 00 00 0f 3f 00 00 be 3e   ...?...?...?...&gt;
00a0  00 80 d9 3e 00 00 be 3e 00 80 d9 3e 00 80 18 3f   ...&gt;...&gt;...&gt;...?
00b0  00 00 0f 3f 00 80 18 3f 00 00 0f 3f 00 00 be 3e   ...?...?...?...&gt;
00c0  00 80 d9 3e 00 00 be 3e 00 80 d9 3e 00 80 18 3f   ...&gt;...&gt;...&gt;...?
00d0  00 40 f5 3e 00 00 61 3f 00 80 3c 3e 00 00 61 3f   .@.&gt;..a?..&lt;&gt;..a?
00e0  00 80 3c 3e 00 c0 7f 3f 00 40 f5 3e 00 c0 7f 3f   ..&lt;&gt;...?.@.&gt;...?
00f0  00 00 2a 3f 00 c0 7f 3f 00 00 2a 3f 00 20 79 3f   ..*?...?..*?. y?
</code></pre></div>

Based on the tutorial, I should be expecting to see a UnityFS header there but don't. At this point I've been blindly throwing around <em class="text-italics">Memory.scanSync</em> in hopes to find something familiar, but has largely been futile with all the access violation errors.</div>

			
			
									
						<div id='list_thanks171315'>
</div>
<div id='div_post_reput171315'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171319" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171319">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171319" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171319">

					<h3 >
						<a href="./viewtopic.php?p=171319#p171319">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171319/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171319" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171319' href="./viewtopic.php?f=10&amp;p=171319&amp;thanks=171319&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171319#p171319" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-11T10:53:36+00:00">Thu Feb 11, 2021 11:53 am</time>
			</p>
			
			
			
			<div class="content">you should see it in the return part of it.<br>
I am guessing your device has low ram so its not keeping anything in memory after its read.<br>
so print the memory in this section.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>        onLeave: function (retval) {
        console.log(retval);
        var keyDump2 = Memory.readByteArray(retval, 0x300);
        console.log(hexdump(keyDump2));
        }
</code></pre></div>

Does the file your trying to decrypt exist?</div>

			
			
									
						<div id='list_thanks171319'>
</div>
<div id='div_post_reput171319'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171321" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171321">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/30624.html" class="username">Spiritovod</a>							</dt>

						<dd class="profile-rank">mega-veteran<br /><img src="./images/ranks/vip-1.png" alt="mega-veteran" title="mega-veteran" /></dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=30624&amp;sr=posts">183</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun Oct 10, 2010 9:44 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="30624"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/30624/true">35 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="30624"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/30624/false">163 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact Spiritovod">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact Spiritovod</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171321" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171321">

					<h3 >
						<a href="./viewtopic.php?p=171321#p171321">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171321/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171321" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171321' href="./viewtopic.php?f=10&amp;p=171321&amp;thanks=171321&amp;to_id=30624&amp;from_id=123876" title="Say Thanks to the author of the post: Spiritovod"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171321#p171321" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/30624.html" class="username">Spiritovod</a></strong> &raquo; </span><time datetime="2021-02-11T14:19:59+00:00">Thu Feb 11, 2021 3:19 pm</time>
			</p>
			
			
			
			<div class="content">I just wonder, if Il2CppDumper works fine, it should also create dummy mono libraries (for exploration via dnSpy or something), where you can find decryption scheme in more convenient format - and though tea/xtea key may not be present directly, you can find RVA for the function there and try to trace it at runtime. Decrypting/grabbing assets directly from memory is cumbersome as you could notice.</div>

			
			
									
						<div id='list_thanks171321'>
</div>
<div id='div_post_reput171321'>
</div>

							<div id="sig171321" class="signature"><a href="https://cs.rin.ru/forum/viewtopic.php?f=10&amp;t=100672" class="postlink">AES encryption keys for UE4/5 games</a></div>			
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171325" class="post has-profile bg1">
		<div class="inner">

		<dl class="postprofile" id="profile171325">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/96398.html" class="username">AltiV</a>							</dt>

						<dd class="profile-rank">n00b</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=96398&amp;sr=posts">12</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Mon Feb 08, 2021 10:16 am</dd>		
		
						    <dd class="profile-posts" data-user-give-id="96398"></dd>
    <dd class="profile-posts" data-user-receive-id="96398"></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact AltiV">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact AltiV</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171325" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171325">

					<h3 >
						<a href="./viewtopic.php?p=171325#p171325">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171325/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171325" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171325' href="./viewtopic.php?f=10&amp;p=171325&amp;thanks=171325&amp;to_id=96398&amp;from_id=123876" title="Say Thanks to the author of the post: AltiV"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171325#p171325" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/96398.html" class="username">AltiV</a></strong> &raquo; </span><time datetime="2021-02-11T17:18:56+00:00">Thu Feb 11, 2021 6:18 pm</time>
			</p>
			
			
			
			<div class="content"><blockquote cite="./viewtopic.php?p=171319#p171319"><div><cite><a href="../Users/4722.html">chrrox</a> wrote: <a href="./viewtopic.php?p=171319#p171319" data-post-id="171319" onclick="if(document.getElementById(hash.substr(1)))href=hash">â†‘</a><span class="responsive-hide">Thu Feb 11, 2021 11:53 am</span></cite>
you should see it in the return part of it.<br>
I am guessing your device has low ram so its not keeping anything in memory after its read.<br>
so print the memory in this section.
<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>        onLeave: function (retval) {
        console.log(retval);
        var keyDump2 = Memory.readByteArray(retval, 0x300);
        console.log(hexdump(keyDump2));
        }
</code></pre></div>

Does the file your trying to decrypt exist?
</div></blockquote>

Your assumption seems to be correct. Adding the hexdump portion to the monitor code presents this when running it:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>Return Value: 0x87e96000
           0  1  2  3  4  5  6  7  8  9  A  B  C  D  E  F  0123456789ABCDEF
00000000  98 d3 d3 8e 00 00 00 00 00 00 00 00 b2 22 20 00  ............." .
00000010  55 6e 69 74 79 46 53 00 00 00 00 06 35 2e 78 2e  UnityFS.....5.x.
00000020  78 00 32 30 31 39 2e 34 2e 38 66 31 00 00 00 00  x.2019.4.8f1....
. . .
</code></pre></div>

Trying to access this address via Memory.readByteArray returns this:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>[Nexus 5::com.tencent.hlfish]-&gt; Memory.readByteArray(new NativePointer(0x87e96000),0x100);
0000  40 29 f4 8e 00 00 00 00 00 00 00 00 ad 61 00 00   @)...........a..
0010  01 00 00 00 02 00 00 00 03 00 00 00 01 00 00 00   ................
0020  03 00 00 00 00 00 00 00 05 00 00 00 06 00 00 00   ................
. . .
</code></pre></div>

Now I assume this issue of the memory in RAM being immediately wiped after it's read is going to cause issues for the rest of the tutorial...I tried to continue anyways with the CreateString step. Searching for that function brings up...a few options.<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>System.Net.UnsafeNclNativeMethods.SecureStringHelper$$CreateString	00ce2c18	undefined System.Net.UnsafeNclNativeMethods.SecureStringHelper$$CreateString()	292
System.Globalization.CodePageDataItem$$CreateString	00d7a52c	undefined System.Globalization.CodePageDataItem$$CreateString()	236
System.String$$CreateStringFromEncoding	01558198	undefined System.String$$CreateStringFromEncoding()	232
System.String$$CreateString	0155e9c8	undefined System.String$$CreateString()	164
System.String$$CreateString	0155ea78	undefined System.String$$CreateString(undefined param_1, undefined param_2, undefined param_3, undefined param_4, undefined4 param_5)	608
System.String$$CreateString	0155edcc	undefined System.String$$CreateString()	1
System.String$$CreateString	0155edec	thunk undefined System.String$$CreateString()	4
System.String$$CreateString	0155edf0	undefined System.String$$CreateString()	24
System.String$$CreateString	0155ee08	undefined System.String$$CreateString()	24
System.String$$CreateString	0155ee20	thunk undefined System.String$$CreateString()	4
System.String$$CreateString	0155ee24	undefined System.String$$CreateString()	240
</code></pre></div>

The only function(s) from above that didn't result in an access violation were:<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>System.Globalization.CodePageDataItem$$CreateString	00d7a52c	undefined System.Globalization.CodePageDataItem$$CreateString()	236
System.String$$CreateString	0155edec	thunk undefined System.String$$CreateString()	4
</code></pre></div>

Taking the second option since that matches your tutorial better (actual address is 0154edec because of 0x00010000 offset).<br>
<br>
Beyond that, subbing in the correct addresses for your next script involving the Construction parameter 2 path parameter/Construction parameter 3/decrypt portion, I am getting access violation errors again at the<br>

<div class="codebox"><p>Code: <a href="#" onclick="selectCode(this); return false;">Select all</a></p><pre><code>var file_bgein = retval.add(0x10)</code></pre></div>

line, which I assume is the RAM issue.<br>
<br>
---<br>

<blockquote cite="./viewtopic.php?p=171321#p171321"><div><cite><a href="../Users/30624.html">Spiritovod</a> wrote: <a href="./viewtopic.php?p=171321#p171321" data-post-id="171321" onclick="if(document.getElementById(hash.substr(1)))href=hash">â†‘</a><span class="responsive-hide">Thu Feb 11, 2021 3:19 pm</span></cite>
I just wonder, if Il2CppDumper works fine, it should also create dummy mono libraries (for exploration via dnSpy or something), where you can find decryption scheme in more convenient format - and though tea/xtea key may not be present directly, you can find RVA for the function there and try to trace it at runtime. Decrypting/grabbing assets directly from memory is cumbersome as you could notice.
</div></blockquote>

In case they are of any relevance, here are Google Drive links to <a href="https://drive.google.com/file/d/1A6BXEbeGi6iYHSct5MqjGOFiLTauSLBt/view" class="postlink">DummyDll (com.nexon.kart)</a> and <a href="https://drive.google.com/file/d/1l9ghM9_khEwS3W5QKhNtGGwhi6zLjuQC/view" class="postlink">DummyDll (com.tencent.hlfish)</a><br>
<br>
My initial impression is that these files aren't really any more convenient to sift through than the current usage of Ghidra with the naming script, as I am still seeing the functions along with the RVAs. I could definitely (and maybe hopefully) be wrong and the DummyDlls would be a better option to look through, but very preliminary research suggests otherwise, at least involving my current use case of just wanting to extract assets without doing any modifications.</div>

			
			
									
						<div id='list_thanks171325'>
</div>
<div id='div_post_reput171325'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

				<div id="p171328" class="post has-profile bg2">
		<div class="inner">

		<dl class="postprofile" id="profile171328">
			<dt class="has-profile-rank no-avatar">
				<div class="avatar-container">
																			</div>
								<a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a>							</dt>

						<dd class="profile-rank">Moderator</dd>			
		<dd class="profile-posts"><strong>Posts:</strong> <a href="./search.php?author_id=4722&amp;sr=posts">2602</a></dd>		<dd class="profile-joined"><strong>Joined:</strong> Sun May 18, 2008 3:01 pm</dd>		
		
						    <dd class="profile-posts" data-user-give-id="4722"><strong>Has&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/true">57 times</a></dd>
    <dd class="profile-posts" data-user-receive-id="4722"><strong>Been&nbsp;thanked:</strong> <a href="/app.php/thankslist/givens/4722/false">1422 times</a></dd>

							<dd class="profile-contact">
				<strong>Contact:</strong>
				<div class="dropdown-container dropdown-left">
					<a href="#" class="dropdown-trigger" title="Contact chrrox">
						<i class="icon fa-commenting-o fa-fw icon-lg" aria-hidden="true"></i><span class="sr-only">Contact chrrox</span>
					</a>
					<div class="dropdown">
						<div class="pointer"><div class="pointer-inner"></div></div>
						<div class="dropdown-contents contact-icons">
																																								<div>
																	<a href="./ucp.php?i=pm&amp;mode=compose&amp;action=quotepost&amp;p=171328" title="Send private message" class="last-cell">
										<span class="contact-icon pm-icon">Send private message</span>									</a>
																	</div>
																					</div>
					</div>
				</div>
			</dd>
				
		</dl>

		<div class="postbody">
						<div id="post_content171328">

					<h3 >
						<a href="./viewtopic.php?p=171328#p171328">Re: Question - Extracting .unity3d file with non-&quot;UnityFS&quot; header</a>
		</h3>

													<ul class="post-buttons">
																										<li>
							<a href="/app.php/post/171328/report" title="Report this post" class="button button-icon-only">
								<i class="icon fa-exclamation fa-fw" aria-hidden="true"></i><span class="sr-only">Report</span>
							</a>
						</li>
																										<li>
							<a href="./posting.php?mode=quote&amp;p=171328" title="Reply with quote" class="button button-icon-only">
								<i class="icon fa-quote-left fa-fw" aria-hidden="true"></i><span class="sr-only">Quote</span>
							</a>
						</li>
													<li>
			<a id='lnk_thanks_post171328' href="./viewtopic.php?f=10&amp;p=171328&amp;thanks=171328&amp;to_id=4722&amp;from_id=123876" title="Say Thanks to the author of the post: chrrox"  class="button button-icon-only">
				<i class="icon thanks-icon fa-fw" aria-hidden="true"></i><span class="sr-only">Thanks</span>
			</a>
		</li>
					</ul>
							
						<p class="author">
									<a class="unread" href="./viewtopic.php?p=171328#p171328" title="Post">
						<i class="icon fa-file fa-fw icon-lightgray icon-md" aria-hidden="true"></i><span class="sr-only">Post</span>
					</a>
								<span class="responsive-hide">by <strong><a href="../Users/4722.html" style="color: #00AA00;" class="username-coloured">chrrox</a></strong> &raquo; </span><time datetime="2021-02-11T18:47:19+00:00">Thu Feb 11, 2021 7:47 pm</time>
			</p>
			
			
			
			<div class="content">The hook is hitting the string create as you showed in your example.<br>
So use that function.<br>
You should be able to paste in the hook function then call create string and it should automatically print it for you.</div>

			
			
									
						<div id='list_thanks171328'>
</div>
<div id='div_post_reput171328'>
</div>

										
						</div>

		</div>

				<div class="back2top">
						<a href="#top" class="top" title="Top">
				<i class="icon fa-chevron-circle-up fa-fw icon-gray" aria-hidden="true"></i>
				<span class="sr-only">Top</span>
			</a>
					</div>
		
		</div>
	</div>

	

	<div class="action-bar bar-bottom">
	
			<a href="./posting.php?mode=reply&amp;t=23416" class="button" title="Post a reply">
							<span>Post Reply</span> <i class="icon fa-reply fa-fw" aria-hidden="true"></i>
					</a>
		
		<div class="dropdown-container dropdown-button-control topic-tools">
		<span title="Topic tools" class="button button-secondary dropdown-trigger dropdown-select">
			<i class="icon fa-wrench fa-fw" aria-hidden="true"></i>
			<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
		</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
													<li>
						<a href="./viewtopic.php?uid=123876&amp;f=10&amp;t=23416&amp;watch=topic&amp;start=0&amp;hash=abaa381c" class="watch-topic-link" title="Subscribe topic" data-ajax="toggle_link" data-toggle-class="icon fa-square-o fa-fw" data-toggle-text="Unsubscribe topic" data-toggle-url="./viewtopic.php?uid=123876&amp;f=10&amp;t=23416&amp;unwatch=topic&amp;start=0&amp;hash=abaa381c" data-update-all=".watch-topic-link">
							<i class="icon fa-check-square-o fa-fw" aria-hidden="true"></i><span>Subscribe topic</span>
						</a>
					</li>
													<li>
						<a href="./viewtopic.php?t=23416&amp;bookmark=1&amp;hash=abaa381c" class="bookmark-link" title="Bookmark topic" data-ajax="alt_text" data-alt-text="Remove from bookmarks" data-update-all=".bookmark-link">
							<i class="icon fa-bookmark-o fa-fw" aria-hidden="true"></i><span>Bookmark topic</span>
						</a>
					</li>
																<li>
					<a href="./memberlist.php?mode=email&amp;t=23416" title="Email topic">
						<i class="icon fa-envelope-o fa-fw" aria-hidden="true"></i><span>Email topic</span>
					</a>
				</li>
												<li>
					<a href="./viewtopic.php?t=23416&amp;view=print" title="Print view" accesskey="p">
						<i class="icon fa-print fa-fw" aria-hidden="true"></i><span>Print view</span>
					</a>
				</li>
											</ul>
		</div>
	</div>

			<form method="post" action="./viewtopic.php?t=23416">
		<div class="dropdown-container dropdown-container-left dropdown-button-control sort-tools">
	<span title="Display and sorting options" class="button button-secondary dropdown-trigger dropdown-select">
		<i class="icon fa-sort-amount-asc fa-fw" aria-hidden="true"></i>
		<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
	</span>
	<div class="dropdown hidden">
		<div class="pointer"><div class="pointer-inner"></div></div>
		<div class="dropdown-contents">
			<fieldset class="display-options">
							<label>Display: <select name="st" id="st"><option value="0" selected="selected">All posts</option><option value="1">1 day</option><option value="7">7 days</option><option value="14">2 weeks</option><option value="30">1 month</option><option value="90">3 months</option><option value="180">6 months</option><option value="365">1 year</option></select></label>
								<label>Sort by: <select name="sk" id="sk"><option value="a">Author</option><option value="t" selected="selected">Post time</option><option value="s">Subject</option></select></label>
				<label>Direction: <select name="sd" id="sd"><option value="a" selected="selected">Ascending</option><option value="d">Descending</option></select></label>
								<hr class="dashed" />
				<input type="submit" class="button2" name="sort" value="Go" />
						</fieldset>
		</div>
	</div>
</div>
		</form>
	
	
	
			<div class="pagination">
			32 posts
							<ul>
		<li class="active"><span>1</span></li>
				<li><a class="button" href="./23416 (1).html" role="button">2</a></li>
				<li><a class="button" href="./23416 (2).html" role="button">3</a></li>
				<li class="arrow next"><a class="button button-icon-only" href="./23416 (1).html" rel="next" role="button"><i class="icon fa-chevron-right fa-fw" aria-hidden="true"></i><span class="sr-only">Next</span></a></li>
	</ul>
					</div>
	</div>


<div class="action-bar actions-jump">
		<p class="jumpbox-return">
		<a href="./viewforum.php?f=10" class="left-box arrow-left" accesskey="r">
			<i class="icon fa-angle-left fa-fw icon-black" aria-hidden="true"></i><span>Return to â€œGame Archiveâ€</span>
		</a>
	</p>
	
		<div class="jumpbox dropdown-container dropdown-container-right dropdown-up dropdown-left dropdown-button-control" id="jumpbox">
			<span title="Jump to" class="button button-secondary dropdown-trigger dropdown-select">
				<span>Jump to</span>
				<span class="caret"><i class="icon fa-sort-down fa-fw" aria-hidden="true"></i></span>
			</span>
		<div class="dropdown">
			<div class="pointer"><div class="pointer-inner"></div></div>
			<ul class="dropdown-contents">
																				<li><a href="../Forums/26 - XeNTaX - General Discussion.html" class="jumpbox-cat-link"> <span> General Discussion</span></a></li>
																<li><a href="./viewforum.php?f=22" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Holy Cow!</span></a></li>
																<li><a href="./viewforum.php?f=40" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game news</span></a></li>
																<li><a href="./viewforum.php?f=38" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Tech Tips</span></a></li>
																<li><a href="./viewforum.php?f=41" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Cool mods</span></a></li>
																<li><a href="./viewforum.php?f=28" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Website</span></a></li>
																<li><a href="./viewforum.php?f=24" class="jumpbox-cat-link"> <span> Game Modding</span></a></li>
																<li><a href="./viewforum.php?f=29" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Tutorials</span></a></li>
																<li><a href="./viewforum.php?f=16" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; 3D/2D models</span></a></li>
																<li><a href="./viewforum.php?f=17" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Audio file formats</span></a></li>
																<li><a href="./viewforum.php?f=18" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Graphic file formats</span></a></li>
																<li><a href="./viewforum.php?f=36" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Video file formats</span></a></li>
																<li><a href="./viewforum.php?f=10" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Archive</span></a></li>
																<li><a href="./viewforum.php?f=21" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Compressed files and methods</span></a></li>
																<li><a href="./viewforum.php?f=13" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Code Talk</span></a></li>
																<li><a href="./viewforum.php?f=35" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game Localization</span></a></li>
																<li><a href="./viewforum.php?f=30" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Savegames</span></a></li>
																<li><a href="./viewforum.php?f=15" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Old posts</span></a></li>
																<li><a href="./viewforum.php?f=37" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Retro games</span></a></li>
																<li><a href="./viewforum.php?f=25" class="jumpbox-cat-link"> <span> MultiEx Commander</span></a></li>
																<li><a href="./viewforum.php?f=3" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; News</span></a></li>
																<li><a href="./viewforum.php?f=14" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Plugins</span></a></li>
																<li><a href="./viewforum.php?f=9" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Troubleshooting</span></a></li>
																<li><a href="./viewforum.php?f=11" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Miscellaneous</span></a></li>
																<li><a href="./viewforum.php?f=31" class="jumpbox-cat-link"> <span> Tools &amp; Programs</span></a></li>
																<li><a href="./viewforum.php?f=32" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; Game specific tools</span></a></li>
																<li><a href="./viewforum.php?f=33" class="jumpbox-sub-link"><span class="spacer"></span> <span>&#8627; &nbsp; General game tools</span></a></li>
											</ul>
		</div>
	</div>

	</div>


	<div class="stat-block online-list">
		<h3><a href="./viewonline.php">Who is online</a></h3>
		<p>Users browsing this forum: <a href="../Users/92541.html" class="username">awgs</a>, <a href="../Users/123876.html" class="username">escape209</a>, <span style="color: #9E8DA7;" class="username-coloured">Google [Bot]</span> and 2 guests</p>
	</div>

			</div>


<div id="page-footer" class="page-footer" role="contentinfo">
	<div class="navbar" role="navigation">
	<div class="inner">

	<ul id="nav-footer" class="nav-footer linklist" role="menubar">
		<li class="breadcrumbs">
									<span class="crumb"><a href="../Navigation/index.html" data-navbar-reference="index"><i class="icon fa-home fa-fw" aria-hidden="true"></i><span>Board index</span></a></span>					</li>
		
				<li class="rightside">All times are <span title="UTC+1">UTC+01:00</span></li>
							<li class="rightside">
				<a href="./ucp.php?mode=delete_cookies" data-ajax="true" data-refresh="true" role="menuitem">
					<i class="icon fa-trash fa-fw" aria-hidden="true"></i><span>Delete cookies</span>
				</a>
			</li>
							<li class="rightside" data-last-responsive="true">
					<a href="./memberlist.php" title="View complete list of members" role="menuitem">
						<i class="icon fa-group fa-fw" aria-hidden="true"></i><span>Members</span>
					</a>
				</li>
												<li class="rightside" data-last-responsive="true">
				<a href="./memberlist.php?mode=team" role="menuitem">
					<i class="icon fa-shield fa-fw" aria-hidden="true"></i><span>The team</span>
				</a>
			</li>
							</ul>

	</div>
</div>

	<div class="copyright">
				<p class="footer-row">
			<span class="footer-copyright">Powered by <a href="https://www.phpbb.com/">phpBB</a>&reg; Forum Software &copy; phpBB Limited</span>
		</p>
						<p class="footer-row" role="menu">
			<a class="footer-link" href="./ucp.php?mode=privacy" title="Privacy" role="menuitem">
				<span class="footer-link-text">Privacy</span>
			</a>
			|
			<a class="footer-link" href="./ucp.php?mode=terms" title="Terms" role="menuitem">
				<span class="footer-link-text">Terms</span>
			</a>
		</p>
					</div>

	<div id="darkenwrapper" class="darkenwrapper" data-ajax-error-title="AJAX error" data-ajax-error-text="Something went wrong when processing your request." data-ajax-error-text-abort="User aborted request." data-ajax-error-text-timeout="Your request timed out; please try again." data-ajax-error-text-parsererror="Something went wrong with the request and the server returned an invalid reply.">
		<div id="darken" class="darken">&nbsp;</div>
	</div>

	<div id="phpbb_alert" class="phpbb_alert" data-l-err="Error" data-l-timeout-processing-req="Request timed out.">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<h3 class="alert_title">&nbsp;</h3><p class="alert_text"></p>
	</div>
	<div id="phpbb_confirm" class="phpbb_alert">
		<a href="#" class="alert_close">
			<i class="icon fa-times-circle fa-fw" aria-hidden="true"></i>
		</a>
		<div class="alert_text"></div>
	</div>
</div>

</div>

<div>
	<a id="bottom" class="anchor" accesskey="z"></a>
	</div>

<script src="./assets/javascript/jquery-3.6.0.min.js?assets_version=11"></script>
<script src="./assets/javascript/core.js?assets_version=11"></script>


<script type="text/javascript">
(function($) {  // Avoid conflicts with other libraries

'use strict';
	
	phpbb.addAjaxCallback('reporttosfs', function(data) {
		if (data.postid !== "undefined") {
			$('#sfs' + data.postid).hide();
			phpbb.closeDarkenWrapper(5000);
		}
	});

})(jQuery);
</script>
<script src="./ext/phpbb/boardannouncements/styles/all/template/js/boardannouncements.js?assets_version=11"></script>
<script src="./styles/prosilver/template/forum_fn.js?assets_version=11"></script>
<script src="./styles/prosilver/template/ajax.js?assets_version=11"></script>



</body>
</html>
